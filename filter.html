
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Filter &#8212; Signalverarbeitung 1</title>
    
  <link href="_static/css/theme.css" rel="stylesheet" />
  <link href="_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.1c5a1a01449ed65a7b51.js">

    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
      
      
      <h1 class="site-logo" id="site-title">Signalverarbeitung 1</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="intro.html">
   Zu diesem Jupyter-Buch
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="grundlagen.html">
   1. Einf√ºhrung
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="signale.html">
   2. Signale
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="systeme.html">
   3. Systeme
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ztrafo.html">
   4. z-Transformation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="spektren.html">
   5. Spektren
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="zbibliography.html">
   6. Literaturverzeichnis
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/filter.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/JoergBitzer/Signalverarbeitung_Vorlesungsskript/"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/JoergBitzer/Signalverarbeitung_Vorlesungsskript//issues/new?title=Issue%20on%20page%20%2Ffilter.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/JoergBitzer/Signalverarbeitung_Vorlesungsskript/master?urlpath=tree/filter.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#filtertypen">
   Filtertypen
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#realisierungsformen">
   Realisierungsformen
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#fir-filter">
     FIR-Filter
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#beschreibung-als-blockdiagramm">
       Beschreibung als Blockdiagramm
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#fir-filter-design">
     FIR-Filter Design
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#fenster-methode">
       Fenster-Methode
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#parks-mcclellan">
       Parks-McClellan
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#linearphasige-filter">
       Linearphasige Filter
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#minimalphasige-fir-filter">
       Minimalphasige FIR-Filter
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#iir-filter">
     IIR-Filter
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id10">
       Beschreibung als Blockdiagramm
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#filterstrukturen-fur-sos">
       Filterstrukturen f√ºr SOS
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#vom-blockdiagramm-zur-ubertragungsfunktion">
       Vom Blockdiagramm zur √úbertragungsfunktion
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#iir-filterdesign">
     IIR-Filterdesign
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#notch-filter">
       Notch-Filter
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#allpasse">
       Allp√§sse
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#implementierungsaspekte">
   Implementierungsaspekte
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id11">
     FIR-Filter
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#schnelle-faltung-ola">
       Schnelle Faltung OLA
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#c-c">
       C/C++
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#vektorielle-schreibweise-und-implementierung-matlab">
       Vektorielle Schreibweise und Implementierung (Matlab)
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id13">
     IIR-Filter
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#sec-iir-filterdesign">
       IIR-Filterdesign
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#butterworth-filter">
       Butterworth-Filter
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#tschebyscheff-i-filter">
       Tschebyscheff-I-Filter
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#tschebyscheff-ii-filter">
       Tschebyscheff-II-Filter
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#cauer-filter">
       Cauer-Filter
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#vor-und-nachteile-der-unterschiedlichen-entwurfsverfahren">
       Vor- und Nachteile der unterschiedlichen Entwurfsverfahren
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#entwurf-von-hochpass-bandpass-und-bandsperr-filter">
       Entwurf von Hochpass, Bandpass und Bandsperr-Filter
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="filter">
<h1>Filter<a class="headerlink" href="#filter" title="Permalink to this headline">¬∂</a></h1>
<p>Filter sind spezielle Systeme, die in diesem Abschnitt grunds√§tzlich als
LTI-Systeme angenommen werden (Filter wie z.B. der Median Filter sind aber nicht-linear). Die Aufgabe von Filtern ist bestimmte
Anteile aus dem Signal zu entfernen oder abzuschw√§chen. Dies kann durch
eine Abschw√§chung der ungew√ºnschten Signalanteile oder eine Verst√§rkung
der gew√ºnschten Signalanteile erfolgen.</p>
<p>Alle nicht-trivialen LTI-Systeme erzeugen eine Filterwirkung, trotzdem
werden nicht alle LTI-Systeme als Filter bezeichnet, da das Ziel beim
Entwurf nicht die Filterwirkung sondern irgendeine andere Eigenschaft
ist. Zum Beipiel einen gleitenden Mittelwert zu berechnen. Eine solches
System ist automatisch auch ein Filter, wird aber trotzdem nicht
unbedingt als solches bezeichnet. In vielen F√§llen ist die Filterwirkung
sogar ein ungew√ºnschter Nebeneffekt.</p>
<p>Ziel dieses Abschnittes ist es, die Grundtypen von Filtern kennen zu
lernen. Des weiteren werden wir die beiden Realisierungsformen als
nicht-rekursive und rekursive Implementierung kennen lernen.
Abschlie√üend werden in einer sehr kompakten Form einige bekannte
Entwurfsverfahren f√ºr die beiden Realisierungsformen vorgestellt.</p>
<div class="section" id="filtertypen">
<h2>Filtertypen<a class="headerlink" href="#filtertypen" title="Permalink to this headline">¬∂</a></h2>
<p>Bei der Typisierung von Filtern schauen wir uns zun√§chst die sogenannten
Sperrfilter an. Ihr Entwurfsziel ist, m√∂glichst einen bestimmten
Frequenzbereich vollst√§ndig aus dem Spektrum zu entfernen. Dabei wird
zwischen vier Grundtypen unterschieden:</p>
<div class="cell tag_hide-input tag_remove-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">import</span> <span class="nn">scipy</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">signal</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span>
<span class="kn">from</span> <span class="nn">myst_nb</span> <span class="kn">import</span> <span class="n">glue</span>

<span class="c1"># Script to create an ideal and realistic lowpass</span>

<span class="n">matplotlib</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;sv.mplstyle&#39;</span><span class="p">)</span>
<span class="n">Fs</span> <span class="o">=</span> <span class="mi">8000</span>
<span class="n">fg</span> <span class="o">=</span> <span class="mi">1000</span> <span class="c1"># cutoff frequency</span>
<span class="n">order</span> <span class="o">=</span> <span class="mi">6</span>
<span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">]</span><span class="o">*</span><span class="n">Fs</span>
<span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">b</span><span class="p">,</span> <span class="n">a</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">butter</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="n">order</span><span class="p">,</span> <span class="n">Wn</span><span class="o">=</span><span class="n">fg</span><span class="p">,</span> <span class="n">btype</span><span class="o">=</span><span class="s1">&#39;low&#39;</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="s1">&#39;ba&#39;</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">Fs</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">lfilter</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="n">spectrum</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>

<span class="c1"># dB, max amplitude = 0dB</span>
<span class="n">spectrum_abs</span> <span class="o">=</span> <span class="mi">20</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">spectrum</span><span class="p">)</span><span class="o">/</span><span class="n">numpy</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">spectrum</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">())</span> 
<span class="n">freq_vec</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">Fs</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">spectrum_abs</span><span class="p">))</span> <span class="c1"># freq bins, for plotting</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax_spectrum</span> <span class="o">=</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="c1"># ideal frequency respose of filter</span>
<span class="n">ax_spectrum</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="o">-</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">x</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">fg</span><span class="p">,</span> <span class="n">Fs</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">Fs</span><span class="o">-</span><span class="n">fg</span><span class="p">,</span> <span class="n">Fs</span><span class="p">],</span> 
        <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Optimale Entwurfsvorgabe&quot;</span><span class="p">)</span>
<span class="c1"># actual realization</span>
<span class="n">ax_spectrum</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">freq_vec</span><span class="p">,</span> <span class="n">spectrum_abs</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> 
        <span class="n">label</span><span class="o">=</span><span class="s2">&quot;M√∂gliche Realisierung&quot;</span><span class="p">)</span>

<span class="n">ax_spectrum</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Frequenz in Hz &#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;D√§mpfung in dB&#39;</span><span class="p">,</span> 
        <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">Fs</span><span class="o">/</span><span class="mi">2</span><span class="p">],</span> <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">105</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Tiefpass </span><span class="si">{</span><span class="n">order</span><span class="si">}</span><span class="s1">.Odnung&#39;</span><span class="p">)</span>
<span class="n">pyplot</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;DesignTP&quot;</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input tag_remove-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">import</span> <span class="nn">scipy</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">signal</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span>
<span class="kn">from</span> <span class="nn">myst_nb</span> <span class="kn">import</span> <span class="n">glue</span>

<span class="c1"># Script to create an ideal and realistic highpass</span>


<span class="n">matplotlib</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;sv.mplstyle&#39;</span><span class="p">)</span>
<span class="n">Fs</span> <span class="o">=</span> <span class="mi">8000</span>
<span class="n">fg</span> <span class="o">=</span> <span class="mi">1000</span> <span class="c1"># cutoff frequency</span>
<span class="n">order</span> <span class="o">=</span> <span class="mi">6</span>
<span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">]</span><span class="o">*</span><span class="n">Fs</span>
<span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">b</span><span class="p">,</span> <span class="n">a</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">butter</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="n">order</span><span class="p">,</span> <span class="n">Wn</span><span class="o">=</span><span class="n">fg</span><span class="p">,</span> <span class="n">btype</span><span class="o">=</span><span class="s1">&#39;high&#39;</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="s1">&#39;ba&#39;</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">Fs</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">lfilter</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="n">spectrum</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>

<span class="c1"># dB, max amplitude = 0dB</span>
<span class="n">spectrum_abs</span> <span class="o">=</span> <span class="mi">20</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">spectrum</span><span class="p">)</span><span class="o">/</span><span class="n">numpy</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">spectrum</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">())</span> 
<span class="n">freq_vec</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">Fs</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">spectrum_abs</span><span class="p">))</span> <span class="c1"># freq bins, for plotting</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax_spectrum</span> <span class="o">=</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="c1"># ideal frequency respose of filter</span>
<span class="n">ax_spectrum</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">100</span><span class="p">],</span> <span class="n">x</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">fg</span><span class="p">,</span> <span class="n">Fs</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">Fs</span><span class="o">-</span><span class="n">fg</span><span class="p">,</span> <span class="n">Fs</span><span class="p">],</span> 
        <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Optimale Entwurfsvorgabe&quot;</span><span class="p">)</span>
<span class="c1"># actual realization</span>
<span class="n">ax_spectrum</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">freq_vec</span><span class="p">,</span> <span class="n">spectrum_abs</span><span class="p">,</span> 
        <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;M√∂gliche Realisierung&quot;</span><span class="p">)</span>

<span class="n">ax_spectrum</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Frequenz in Hz &#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;D√§mpfung in dB&#39;</span><span class="p">,</span> 
        <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">Fs</span><span class="o">/</span><span class="mi">2</span><span class="p">],</span> <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">105</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Hochpass </span><span class="si">{</span><span class="n">order</span><span class="si">}</span><span class="s1">.Odnung&#39;</span><span class="p">)</span>
<span class="n">pyplot</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;DesignHP&quot;</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input tag_remove-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">import</span> <span class="nn">scipy</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">signal</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span>
<span class="kn">from</span> <span class="nn">myst_nb</span> <span class="kn">import</span> <span class="n">glue</span>

<span class="c1"># Script to create an ideal and realistic bandpass</span>

<span class="n">matplotlib</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;sv.mplstyle&#39;</span><span class="p">)</span>

<span class="n">Fs</span> <span class="o">=</span> <span class="mi">8000</span>
<span class="n">fg</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">3000</span><span class="p">]</span><span class="c1"># cutoff frequency</span>
<span class="n">order</span> <span class="o">=</span> <span class="mi">6</span>
<span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">]</span><span class="o">*</span><span class="n">Fs</span>
<span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">b</span><span class="p">,</span><span class="n">a</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">butter</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="n">order</span><span class="p">,</span> <span class="n">Wn</span><span class="o">=</span><span class="n">fg</span><span class="p">,</span> <span class="n">btype</span><span class="o">=</span><span class="s1">&#39;bandpass&#39;</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="s1">&#39;ba&#39;</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">Fs</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">lfilter</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="n">spectrum</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="c1"># dB, max amplitude = 0dB</span>
<span class="n">spectrum_abs</span> <span class="o">=</span> <span class="mi">20</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">spectrum</span><span class="p">)</span><span class="o">/</span><span class="n">numpy</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">spectrum</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">())</span> 
<span class="n">freq_vec</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">Fs</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">spectrum_abs</span><span class="p">))</span> <span class="c1"># freq bins, for plotting</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax_spectrum</span> <span class="o">=</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="c1"># ideal frequency respose of filter</span>
<span class="n">ax_spectrum</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">100</span><span class="p">],</span> 
        <span class="n">x</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">fg</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">fg</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">Fs</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">Fs</span><span class="o">-</span><span class="n">fg</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">Fs</span><span class="o">-</span><span class="n">fg</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">Fs</span><span class="p">],</span> 
        <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Optimale Entwurfsvorgabe&quot;</span><span class="p">)</span>
<span class="c1"># actual realization</span>
<span class="n">ax_spectrum</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">freq_vec</span><span class="p">,</span> <span class="n">spectrum_abs</span><span class="p">,</span> 
        <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;M√∂gliche Realisierung&quot;</span><span class="p">)</span>
<span class="n">ax_spectrum</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Frequenz in Hz &#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;D√§mpfung in dB&#39;</span><span class="p">,</span> 
        <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">Fs</span><span class="o">/</span><span class="mi">2</span><span class="p">],</span> <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">105</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Bandpass </span><span class="si">{</span><span class="n">order</span><span class="si">}</span><span class="s1">.Odnung&#39;</span><span class="p">)</span>
<span class="n">pyplot</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>


<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;DesignBP&quot;</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input tag_remove-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">import</span> <span class="nn">scipy</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">signal</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span>
<span class="kn">from</span> <span class="nn">myst_nb</span> <span class="kn">import</span> <span class="n">glue</span>

<span class="c1"># Script to create an ideal and realistic bandstop</span>

<span class="n">matplotlib</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;sv.mplstyle&#39;</span><span class="p">)</span>
<span class="n">Fs</span> <span class="o">=</span> <span class="mi">8000</span>
<span class="n">fg</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">3000</span><span class="p">]</span><span class="c1"># cutoff frequency</span>
<span class="n">order</span> <span class="o">=</span> <span class="mi">6</span>
<span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">]</span><span class="o">*</span><span class="n">Fs</span>
<span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">b</span><span class="p">,</span><span class="n">a</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">butter</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="n">order</span><span class="p">,</span> <span class="n">Wn</span><span class="o">=</span><span class="n">fg</span><span class="p">,</span> <span class="n">btype</span><span class="o">=</span><span class="s1">&#39;bandstop&#39;</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="s1">&#39;ba&#39;</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">Fs</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">lfilter</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="n">spectrum</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="c1"># dB, max amplitude = 0dB</span>
<span class="n">spectrum_abs</span> <span class="o">=</span> <span class="mi">20</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">spectrum</span><span class="p">)</span><span class="o">/</span><span class="n">numpy</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">spectrum</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">())</span> 
<span class="n">freq_vec</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">Fs</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">spectrum_abs</span><span class="p">))</span> <span class="c1"># freq bins, for plotting</span>


<span class="n">fig</span><span class="p">,</span> <span class="n">ax_spectrum</span> <span class="o">=</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="c1"># ideal frequency respose of filter</span>
<span class="n">ax_spectrum</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> 
        <span class="n">x</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">fg</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">fg</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">Fs</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">Fs</span><span class="o">-</span><span class="n">fg</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">Fs</span><span class="o">-</span><span class="n">fg</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">Fs</span><span class="p">],</span> 
        <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Optimale Entwurfsvorgabe&quot;</span><span class="p">)</span>
<span class="c1"># actual realization</span>
<span class="n">ax_spectrum</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">freq_vec</span><span class="p">,</span> <span class="n">spectrum_abs</span><span class="p">,</span> 
        <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;M√∂gliche Realisierung&quot;</span><span class="p">)</span>

<span class="n">ax_spectrum</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Frequenz in Hz &#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;D√§mpfung in dB&#39;</span><span class="p">,</span> 
        <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">Fs</span><span class="o">/</span><span class="mi">2</span><span class="p">],</span> <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">105</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Bandsperre </span><span class="si">{</span><span class="n">order</span><span class="si">}</span><span class="s1">.Odnung&#39;</span><span class="p">)</span>
<span class="n">pyplot</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;DesignBS&quot;</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="tabbed-set docutils">
<input checked="checked" id="47accb91-9286-42d4-b7b1-dd66e80d0628" name="a90422af-f2f1-4fec-990f-918487d95540" type="radio">
</input><label class="tabbed-label" for="47accb91-9286-42d4-b7b1-dd66e80d0628">
Tiefpass</label><div class="tabbed-content docutils">
<ul class="simple">
<li><p><strong>Tiefpass:</strong> Ziel des Tiefpasses ist es alle hohen Frequenzen, ab
einer zu definierenden Grenzfrequenz <span class="math notranslate nohighlight">\(f_g\)</span> aus dem Spektrum zu
entfernen. In der technischen Umsetzung ist es aber nicht m√∂glich,
einen abrupten √úbergang zwischen dem sog. Durchlassbereich (tiefe
Frequenzen beim Tiefpass) und dem Sperrbereich zu realisieren. Eine
praktische Realisierung hat deshalb immer bestimmte Grenz- und
√úbergangsbereiche.</p></li>
</ul>
<div class="figure align-default" id="fig-designtp" style="width: 50%">
<div class="cell_output docutils container">
<img alt="_images/filter_1_0.png" src="_images/filter_1_0.png" />
</div>
<p class="caption"><span class="caption-text">Optimaler
Entwurf eines Tiefpasses (<span class="math notranslate nohighlight">\(f_s\)</span> = 8 kHz und Grenzfrequenz = <span class="math notranslate nohighlight">\(f_g\)</span> =
1 kHz) und Realisierung durch Butterworth-Filter 6. Ordnung (siehe <code class="xref std std-numref docutils literal notranslate"><span class="pre">Abschnitt</span> <span class="pre">%s</span></code>)</span><a class="headerlink" href="#fig-designtp" title="Permalink to this image">¬∂</a></p>
</div>
</div>
<input id="2f35d6b8-f1c6-4faa-9465-1cbfb892c935" name="a90422af-f2f1-4fec-990f-918487d95540" type="radio">
</input><label class="tabbed-label" for="2f35d6b8-f1c6-4faa-9465-1cbfb892c935">
Hochpass</label><div class="tabbed-content docutils">
<ul class="simple">
<li><p><strong>Hochpass:</strong> Das inverse Designziel zum Tiefpass liegt dem
Hochpassentwurf zu Grunde. Es sollen m√∂glichst alle tiefen
Frequenzen aus dem Spektrum entfernt werden. Auch hier gelten die
beim Tiefpass erw√§hnten Einschr√§nkungen.</p></li>
</ul>
<div class="figure align-default" id="fig-designhp" style="width: 50%">
<div class="cell_output docutils container">
<img alt="_images/filter_2_0.png" src="_images/filter_2_0.png" />
</div>
<p class="caption"><span class="caption-text">Optimaler
Entwurf eines Hochpasses (<span class="math notranslate nohighlight">\(f_s\)</span> = 8 kHz und Grenzfrequenz = <span class="math notranslate nohighlight">\(f_g\)</span> =
1 kHz) und Realisierung durch Butterworth-Filter 6. Ordnung (siehe <code class="xref std std-numref docutils literal notranslate"><span class="pre">Abschnitt</span> <span class="pre">%s</span></code>)</span><a class="headerlink" href="#fig-designhp" title="Permalink to this image">¬∂</a></p>
</div>
</div>
<input id="ef58125d-9851-4baf-b8c7-d2a86dbd4837" name="a90422af-f2f1-4fec-990f-918487d95540" type="radio">
</input><label class="tabbed-label" for="ef58125d-9851-4baf-b8c7-d2a86dbd4837">
Bandpass</label><div class="tabbed-content docutils">
<ul class="simple">
<li><p><strong>Bandpass:</strong> Im Gegensatz zu den vorher erw√§hnten Typen, hat das
Bandpassfilter zwei Grenzfrequenzen <span class="math notranslate nohighlight">\(f_1\)</span> und <span class="math notranslate nohighlight">\(f_2\)</span>, da das
Designziel ist, nur die Frequenzen zwischen <span class="math notranslate nohighlight">\(f_1\)</span> und <span class="math notranslate nohighlight">\(f_2\)</span>
durchzulassen und ale Frequenzen unterhalb von <span class="math notranslate nohighlight">\(f_1\)</span> bzw. oberhalb
von <span class="math notranslate nohighlight">\(f_2\)</span> zu entfernen. Die Differenz zwischen <span class="math notranslate nohighlight">\(f1\)</span> und <span class="math notranslate nohighlight">\(f_2\)</span> wird
Bandbreite genannt <span class="math notranslate nohighlight">\(B = f_2 -
    f_1\)</span>.</p></li>
</ul>
<div class="figure align-default" id="fig-designbp" style="width: 50%">
<div class="cell_output docutils container">
<img alt="_images/filter_3_0.png" src="_images/filter_3_0.png" />
</div>
<p class="caption"><span class="caption-text">Optimaler
Entwurf eines Bandpasses (<span class="math notranslate nohighlight">\(f_s\)</span> = 8 kHz und Grenzfrequenz <span class="math notranslate nohighlight">\(f_1\)</span> = 1
kHz und <span class="math notranslate nohighlight">\(f_2 =\)</span> 3 kHz) und Realisierung durch Butterworth-Filter 6.
Ordnung (siehe <code class="xref std std-numref docutils literal notranslate"><span class="pre">Abschnitt</span> <span class="pre">%s</span></code>)</span><a class="headerlink" href="#fig-designbp" title="Permalink to this image">¬∂</a></p>
</div>
</div>
<input id="585535f5-2435-42e1-ab6a-90e3eed07309" name="a90422af-f2f1-4fec-990f-918487d95540" type="radio">
</input><label class="tabbed-label" for="585535f5-2435-42e1-ab6a-90e3eed07309">
Bandsperre</label><div class="tabbed-content docutils">
<ul class="simple">
<li><p><strong>Bandsperre:</strong> Die Bandsperre stellt die inverse Funktion zum
Bandpass dar. Bei diesem Entwurf sollen m√∂glichst alle Frequenzen im
Bereich zwischen <span class="math notranslate nohighlight">\(f_1\)</span> und <span class="math notranslate nohighlight">\(f_2\)</span> aus dem Spektrum entfernt werden.</p></li>
</ul>
<div class="figure align-default" id="fig-designbs" style="width: 50%">
<div class="cell_output docutils container">
<img alt="_images/filter_4_0.png" src="_images/filter_4_0.png" />
</div>
<p class="caption"><span class="caption-text">Optimaler
Entwurf einer Bandsperre (<span class="math notranslate nohighlight">\(f_s\)</span> = 8 kHz und Grenzfrequenz <span class="math notranslate nohighlight">\(f_1\)</span> = 1
kHz und <span class="math notranslate nohighlight">\(f_2 =\)</span> 3 kHz) und Realisierung durch Butterworth-Filter 6.
Ordnung (siehe <code class="xref std std-numref docutils literal notranslate"><span class="pre">Abschnitt</span> <span class="pre">%s</span></code>)</span><a class="headerlink" href="#fig-designbs" title="Permalink to this image">¬∂</a></p>
</div>
</div>
</div>
<p>Eine weitere Gruppe von Filtern hat das Ziel Signale die durch eine
√úbertragung ver√§ndert wurden, wieder in ihre urspr√ºngliche Form zur√ºck
zu bringen. Das Ziel ist also, ein ver√§ndertes Spektrum zu begradigen,
bzw. auszugleichen. Aus dieser Aufgabe folgt auch die verwendete
englische Typbezeichnung Equalizer. In der Tonstudiotechnik werden diese
Filter zwar nicht nur zu diesem Zweck verwendet, aber auch dort werden
die Klangformungsfilter als Equalizer bezeichnet. Equalizer ist ein sehr
allgemeiner Begriff und kann Filter beinhalten, die eine vollst√§ndige
Vorgabe der √úbertragungsfunktion versuchen zu realisieren, zum Beipeil
bei der H√∂rger√§teanpassung, die eine vollst√§ndige Beschreibung des
H√∂rverlustes als Ausgangsbasis verwendet, oder aber es werden nur
bestimmte Bereiche ver√§ndert. Zu dieser letzten Gruppe geh√∂ren die
Equalizer, wie sie in der Tonstudiotechnik verwendet werden. Hierbei
unterscheiden wir zwischen den parametrischen Equalizern und den sog.
Terzband-Equalizer (Eine (gro√üe) Terz beschreibt eine drittel Oktave, die wiederum eine Frequenzverdoppelung beschreibt).</p>
<p>Bei den parametrischen Equalizer k√∂nnen durch die drei Parameter</p>
<ul class="simple">
<li><p>Frequenz,</p></li>
<li><p>Verst√§rkung bzw. Abschw√§chung und</p></li>
<li><p>G√ºte (<span class="math notranslate nohighlight">\(Q\)</span>-Faktor)</p></li>
</ul>
<p>sehr genaue Eingriffe in das Klangspektrum vorgenommen werden. Dabei ist
die G√ºte <span class="math notranslate nohighlight">\(Q\)</span> als Verh√§ltnis von Mittenfrequenz und Bandbreite definiert.</p>
<div class="cell tag_hide-input tag_remove-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">signal</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span>
<span class="kn">from</span> <span class="nn">matplotlib.widgets</span> <span class="kn">import</span> <span class="n">Slider</span>
<span class="kn">from</span> <span class="nn">myst_nb</span> <span class="kn">import</span> <span class="n">glue</span>

<span class="n">matplotlib</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;sv.mplstyle&#39;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">get_peak_EQ</span><span class="p">(</span><span class="n">f_0</span><span class="p">,</span> <span class="n">gain_dB</span><span class="p">,</span> <span class="n">Q</span><span class="p">,</span> <span class="n">f_s</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    calculates filter coefficients of a peak equalizer</span>
<span class="sd">    with the given parameters</span>
<span class="sd">    </span>
<span class="sd">    Parameters:</span>
<span class="sd">    -----------</span>
<span class="sd">    f_0 : int</span>
<span class="sd">        peak frequency in Hz</span>
<span class="sd">    gain_dB : int</span>
<span class="sd">        dB gain at peak</span>
<span class="sd">    Q : float</span>
<span class="sd">        Quality of filter</span>
<span class="sd">    f_s : int</span>
<span class="sd">        sampling frequency</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">K</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">f_0</span><span class="o">/</span><span class="p">(</span><span class="n">f_s</span><span class="o">*</span><span class="mi">2</span><span class="p">))</span>
    <span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">3</span>
    <span class="n">b</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">3</span>
    <span class="n">den</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">gain_dB</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>
        <span class="n">V0</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="n">gain_dB</span><span class="o">/</span><span class="mi">20</span><span class="p">)</span>
        <span class="n">den</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">K</span><span class="o">/</span><span class="n">Q</span> <span class="o">+</span> <span class="n">K</span><span class="o">*</span><span class="n">K</span><span class="p">)</span>
        <span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">V0</span><span class="o">*</span><span class="n">K</span><span class="o">/</span><span class="n">Q</span> <span class="o">+</span> <span class="n">K</span><span class="o">*</span><span class="n">K</span><span class="p">)</span>
        <span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">K</span><span class="o">*</span><span class="n">K</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">b</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">V0</span><span class="o">*</span><span class="n">K</span><span class="o">/</span><span class="n">Q</span> <span class="o">+</span> <span class="n">K</span><span class="o">*</span><span class="n">K</span><span class="p">)</span>
        <span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">K</span><span class="o">*</span><span class="n">K</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">a</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">K</span><span class="o">/</span><span class="n">Q</span> <span class="o">+</span> <span class="n">K</span><span class="o">*</span><span class="n">K</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">V0</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="n">gain_dB</span><span class="o">/</span><span class="mi">20</span><span class="p">)</span>
        <span class="n">den</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">V0</span><span class="o">*</span><span class="n">K</span><span class="o">/</span><span class="n">Q</span> <span class="o">+</span> <span class="n">K</span><span class="o">*</span><span class="n">K</span><span class="p">)</span>
        <span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">K</span><span class="o">/</span><span class="n">Q</span> <span class="o">+</span> <span class="n">K</span><span class="o">*</span><span class="n">K</span><span class="p">)</span>
        <span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">K</span><span class="o">*</span><span class="n">K</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">b</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">K</span><span class="o">/</span><span class="n">Q</span> <span class="o">+</span> <span class="n">K</span><span class="o">*</span><span class="n">K</span><span class="p">)</span>
        <span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">K</span><span class="o">*</span><span class="n">K</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">a</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">V0</span><span class="o">*</span><span class="n">K</span><span class="o">/</span><span class="n">Q</span> <span class="o">+</span> <span class="n">K</span><span class="o">*</span><span class="n">K</span><span class="p">)</span>
    
    <span class="n">b</span> <span class="o">/=</span> <span class="n">den</span>
    <span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">/=</span> <span class="n">den</span>
    
    <span class="k">return</span> <span class="n">b</span><span class="p">,</span> <span class="n">a</span>
    

<span class="n">gains</span> <span class="o">=</span> <span class="p">[</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="o">-</span><span class="mi">12</span><span class="p">]</span>
<span class="n">fs</span> <span class="o">=</span> <span class="mi">48000</span>
<span class="n">freq</span><span class="o">=</span> <span class="mi">8000</span>
<span class="n">Q</span> <span class="o">=</span> <span class="mi">3</span>

<span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax_gain</span><span class="p">,</span> <span class="n">ax_freq</span><span class="p">,</span> <span class="n">ax_Q</span><span class="p">)</span> <span class="o">=</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="k">for</span> <span class="n">gain</span> <span class="ow">in</span> <span class="n">gains</span><span class="p">:</span>
    <span class="n">b</span><span class="p">,</span> <span class="n">a</span> <span class="o">=</span> <span class="n">get_peak_EQ</span><span class="p">(</span><span class="n">freq</span><span class="p">,</span> <span class="n">gain</span><span class="p">,</span> <span class="n">Q</span><span class="p">,</span> <span class="n">fs</span><span class="p">)</span> <span class="c1"># get filter coeefficients        </span>
    <span class="n">w</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">freqz</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">fs</span><span class="p">)</span> <span class="c1"># calculate impulse response</span>
    <span class="n">h_db</span> <span class="o">=</span> <span class="mi">20</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">h</span><span class="p">))</span> <span class="c1"># dB</span>
    <span class="n">ax_gain</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">h_db</span><span class="p">)</span>

<span class="n">ax_gain</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">13</span><span class="p">,</span> <span class="mi">13</span><span class="p">],</span> <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Frequenz in Hz&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Verst√§rkung in dB&#39;</span><span class="p">,</span>     
        <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Peak-EQ mit variablem Gain </span><span class="se">\n\</span>
<span class="s1">        bei Frequenz f = </span><span class="si">{</span><span class="n">freq</span><span class="si">}</span><span class="s1"> Hz mit G√ºte Q = </span><span class="si">{</span><span class="n">Q</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="n">freqs</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">fs</span><span class="o">/</span><span class="mi">10</span><span class="p">,</span> <span class="n">fs</span><span class="o">/</span><span class="mi">5</span><span class="p">,</span> <span class="n">fs</span><span class="o">/</span><span class="mi">3</span><span class="p">]</span>
<span class="n">gain</span> <span class="o">=</span> <span class="mi">12</span>
<span class="k">for</span> <span class="n">freq</span> <span class="ow">in</span> <span class="n">freqs</span><span class="p">:</span>
    <span class="n">b</span><span class="p">,</span> <span class="n">a</span> <span class="o">=</span> <span class="n">get_peak_EQ</span><span class="p">(</span><span class="n">freq</span><span class="p">,</span> <span class="n">gain</span><span class="p">,</span> <span class="n">Q</span><span class="p">,</span> <span class="n">fs</span><span class="p">)</span> <span class="c1"># get filter coeefficients</span>
    <span class="n">w</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">freqz</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">fs</span><span class="p">)</span> <span class="c1"># calculate impulse response</span>
    <span class="n">h_db</span> <span class="o">=</span> <span class="mi">20</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">h</span><span class="p">))</span> <span class="c1"># dB</span>
    <span class="n">ax_freq</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">h_db</span><span class="p">)</span>
<span class="n">ax_freq</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">13</span><span class="p">,</span> <span class="mi">13</span><span class="p">],</span> <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Frequenz in Hz&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Verst√§rkung in dB&#39;</span><span class="p">,</span> 
        <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Peak-EQ mit variabler Frequenz </span><span class="se">\n\</span>
<span class="s1">        bei Gain = </span><span class="si">{</span><span class="n">gain</span><span class="si">}</span><span class="s1"> dB und G√ºte Q = </span><span class="si">{</span><span class="n">Q</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">Qs</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span>
<span class="n">freq</span> <span class="o">=</span> <span class="mi">8000</span>

<span class="k">for</span> <span class="n">Q</span> <span class="ow">in</span> <span class="n">Qs</span><span class="p">:</span>
    <span class="n">b</span><span class="p">,</span> <span class="n">a</span> <span class="o">=</span> <span class="n">get_peak_EQ</span><span class="p">(</span><span class="n">freq</span><span class="p">,</span> <span class="n">gain</span><span class="p">,</span> <span class="n">Q</span><span class="p">,</span> <span class="n">fs</span><span class="p">)</span> <span class="c1"># get filter coeefficients</span>
    <span class="n">w</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">freqz</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">fs</span><span class="p">)</span> <span class="c1"># calculate impulse response</span>
    <span class="n">h_db</span> <span class="o">=</span> <span class="mi">20</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">h</span><span class="p">))</span> <span class="c1"># dB</span>
    <span class="n">ax_Q</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">h_db</span><span class="p">)</span>
<span class="n">ax_Q</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">13</span><span class="p">,</span> <span class="mi">13</span><span class="p">],</span> <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Frequenz in Hz&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Verst√§rkung in dB&#39;</span><span class="p">,</span> 
         <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Peak-EQ mit variabler G√ºte </span><span class="se">\n\</span>
<span class="s1">         bei Frequenz f = </span><span class="si">{</span><span class="n">freq</span><span class="si">}</span><span class="s1"> Hz und Gain = </span><span class="si">{</span><span class="n">gain</span><span class="si">}</span><span class="s1"> dB&#39;</span><span class="p">)</span>

<span class="n">pyplot</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;EQ_GainParam&quot;</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="tabbed-set docutils">
<input checked="checked" id="fd40beb6-39b5-4923-98ad-ab60254ae4af" name="7d443f7f-38cd-4732-a134-94612ac3937d" type="radio">
</input><label class="tabbed-label" for="fd40beb6-39b5-4923-98ad-ab60254ae4af">
Buchabbildung</label><div class="tabbed-content docutils">
<div class="figure align-default" id="fig-eq-gainparam" style="width: 75%">
<div class="cell_output docutils container">
<img alt="_images/filter_10_1.png" src="_images/filter_10_1.png" />
</div>
<p class="caption"><span class="caption-text">Equalizer√ºbertragungskurve bei Ver√§nderung der
G√ºte</span><a class="headerlink" href="#fig-eq-gainparam" title="Permalink to this image">¬∂</a></p>
</div>
</div>
<input id="492222cd-5b3a-4dd6-8bb9-1f671c07787c" name="7d443f7f-38cd-4732-a134-94612ac3937d" type="radio">
</input><label class="tabbed-label" for="492222cd-5b3a-4dd6-8bb9-1f671c07787c">
Interaktiv arbeiten</label><div class="tabbed-content docutils">
<ol class="simple">
<li><p>Starten des interaktiven Programms - ‚ÄúFilter_Peak_EQ.py‚Äù in jupyterbook/interactive_programs</p></li>
<li><p>Mit Slidern Parameter einstellen</p></li>
</ol>
</div>
</div>
<p>Es gibt auch noch spezielle Filter f√ºr den Hoch- und Tiefpassbereich,
die als Kuhschwanzfilter (Shelving-Filter) bezeichnet werden. Hierbei
stehen nur die zwei Parameter Frequenz und Verst√§rkung bzw. Abschw√§chung
zur Verf√ºgung.</p>
<div class="cell tag_hide-input tag_remove-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">signal</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span>
<span class="kn">from</span> <span class="nn">matplotlib.widgets</span> <span class="kn">import</span> <span class="n">RadioButtons</span>
<span class="kn">from</span> <span class="nn">matplotlib.widgets</span> <span class="kn">import</span> <span class="n">Slider</span>
<span class="kn">from</span> <span class="nn">myst_nb</span> <span class="kn">import</span> <span class="n">glue</span>

<span class="n">matplotlib</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;sv.mplstyle&#39;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">getShelvingEQ</span><span class="p">(</span><span class="n">f_0</span><span class="p">,</span> <span class="n">Gain_dB</span><span class="p">,</span> <span class="n">shelf_type</span><span class="p">,</span> <span class="n">fs</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    calculates filter coefficients of a shelving equalizer</span>
<span class="sd">    with the given parameters</span>
<span class="sd">    </span>
<span class="sd">    Parameters:</span>
<span class="sd">    -----------</span>
<span class="sd">    f_0 : int</span>
<span class="sd">        peak frequency in Hz</span>
<span class="sd">    gain_dB : int</span>
<span class="sd">        dB gain at peak</span>
<span class="sd">    shelf_type : str</span>
<span class="sd">        &quot;high&quot; for high-shelf, anything else for low shelf</span>
<span class="sd">    fs : int</span>
<span class="sd">        sampling frequency</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="n">K</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">f_0</span><span class="o">/</span><span class="p">(</span><span class="n">fs</span><span class="o">*</span><span class="mi">2</span><span class="p">))</span>
    <span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">3</span>
    <span class="n">b</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">3</span>
    <span class="n">den</span> <span class="o">=</span> <span class="mi">1</span>
    
    <span class="k">if</span> <span class="p">(</span><span class="n">shelf_type</span> <span class="o">==</span> <span class="s2">&quot;high&quot;</span><span class="p">):</span> <span class="c1"># High-Shelf</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">Gain_dB</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>
            <span class="n">V0</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="n">Gain_dB</span><span class="o">/</span><span class="mi">20</span><span class="p">)</span>
            <span class="n">den</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">K</span> <span class="o">+</span> <span class="n">K</span><span class="o">*</span><span class="n">K</span>
            <span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">V0</span> <span class="o">+</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">V0</span><span class="p">)</span><span class="o">*</span><span class="n">K</span><span class="o">+</span><span class="n">K</span><span class="o">*</span><span class="n">K</span> 
            <span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">K</span><span class="o">*</span><span class="n">K</span> <span class="o">-</span> <span class="n">V0</span><span class="p">)</span> 
            <span class="n">b</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">V0</span> <span class="o">-</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">V0</span><span class="p">)</span><span class="o">*</span><span class="n">K</span> <span class="o">+</span> <span class="n">K</span><span class="o">*</span><span class="n">K</span>  
            <span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">K</span><span class="o">*</span><span class="n">K</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>            
            <span class="n">a</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">K</span> <span class="o">+</span> <span class="n">K</span><span class="o">*</span><span class="n">K</span>  
            <span class="n">b</span> <span class="o">/=</span> <span class="n">den</span>
            <span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">/=</span> <span class="n">den</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">V0</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="n">Gain_dB</span><span class="o">/</span><span class="mi">20</span><span class="p">)</span>
            <span class="n">den</span> <span class="o">=</span> <span class="n">V0</span> <span class="o">+</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">V0</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">K</span> <span class="o">+</span> <span class="n">K</span><span class="o">*</span><span class="n">K</span>
            <span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">K</span> <span class="o">+</span> <span class="n">K</span><span class="o">*</span><span class="n">K</span> 
            <span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">K</span><span class="o">*</span><span class="n">K</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> 
            <span class="n">b</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">K</span> <span class="o">+</span> <span class="n">K</span><span class="o">*</span><span class="n">K</span>  
            <span class="n">b</span> <span class="o">/=</span> <span class="n">den</span>
            <span class="n">den</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="o">/</span><span class="n">V0</span><span class="p">)</span><span class="o">*</span><span class="n">K</span> <span class="o">+</span> <span class="n">K</span><span class="o">*</span><span class="n">K</span><span class="o">/</span><span class="n">V0</span>
            <span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">K</span><span class="o">*</span><span class="n">K</span><span class="o">/</span><span class="n">V0</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> 
            <span class="n">a</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="o">/</span><span class="n">V0</span><span class="p">)</span><span class="o">*</span><span class="n">K</span> <span class="o">+</span> <span class="n">K</span><span class="o">*</span><span class="n">K</span><span class="o">/</span><span class="n">V0</span><span class="p">)</span>  
            <span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">/=</span> <span class="n">den</span>
    <span class="k">else</span><span class="p">:</span> <span class="c1">#Low-Shelf 0 or default for != 1</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">Gain_dB</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>
            <span class="n">V0</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="n">Gain_dB</span><span class="o">/</span><span class="mi">20</span><span class="p">)</span>
            <span class="n">den</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">K</span> <span class="o">+</span> <span class="n">K</span><span class="o">*</span><span class="n">K</span>
            <span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">V0</span><span class="p">)</span><span class="o">*</span><span class="n">K</span> <span class="o">+</span> <span class="n">V0</span><span class="o">*</span><span class="n">K</span><span class="o">*</span><span class="n">K</span> 
            <span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">V0</span><span class="o">*</span><span class="n">K</span><span class="o">*</span><span class="n">K</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> 
            <span class="n">b</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">V0</span><span class="p">)</span><span class="o">*</span><span class="n">K</span> <span class="o">+</span> <span class="n">V0</span><span class="o">*</span><span class="n">K</span><span class="o">*</span><span class="n">K</span>  
            <span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">K</span><span class="o">*</span><span class="n">K</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> 
            <span class="n">a</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">K</span> <span class="o">+</span> <span class="n">K</span><span class="o">*</span><span class="n">K</span>  
        <span class="k">else</span><span class="p">:</span>
            <span class="n">V0</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="n">Gain_dB</span><span class="o">/</span><span class="mi">20</span><span class="p">)</span>
            <span class="n">den</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">V0</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">K</span> <span class="o">+</span> <span class="n">V0</span><span class="o">*</span><span class="n">K</span><span class="o">*</span><span class="n">K</span>
            <span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">K</span> <span class="o">+</span> <span class="n">K</span><span class="o">*</span><span class="n">K</span> 
            <span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">K</span><span class="o">*</span><span class="n">K</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> 
            <span class="n">b</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">K</span> <span class="o">+</span> <span class="n">K</span><span class="o">*</span><span class="n">K</span>  
            <span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">V0</span><span class="o">*</span><span class="n">K</span><span class="o">*</span><span class="n">K</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">a</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">V0</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">K</span> <span class="o">+</span> <span class="n">V0</span><span class="o">*</span><span class="n">K</span><span class="o">*</span><span class="n">K</span>
            
        <span class="n">b</span> <span class="o">/=</span> <span class="n">den</span>
        <span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">/=</span> <span class="n">den</span>

    <span class="k">return</span> <span class="n">b</span><span class="p">,</span> <span class="n">a</span>

<span class="c1">#parameters</span>
<span class="n">gains</span> <span class="o">=</span> <span class="p">[</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="o">-</span><span class="mi">12</span><span class="p">]</span>
<span class="n">fs</span> <span class="o">=</span> <span class="mi">48000</span>
<span class="n">f_c</span> <span class="o">=</span> <span class="mi">8000</span>
<span class="n">shelf_types</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;low&quot;</span><span class="p">,</span> <span class="s2">&quot;high&quot;</span><span class="p">]</span>

<span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax_gain</span><span class="p">,</span> <span class="n">ax_freq</span><span class="p">)</span> <span class="o">=</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="k">for</span> <span class="n">gain</span> <span class="ow">in</span> <span class="n">gains</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">ftype</span> <span class="ow">in</span> <span class="n">shelf_types</span><span class="p">:</span>
        <span class="n">b</span><span class="p">,</span> <span class="n">a</span> <span class="o">=</span> <span class="n">getShelvingEQ</span><span class="p">(</span><span class="n">f_c</span><span class="p">,</span> <span class="n">gain</span><span class="p">,</span> <span class="n">ftype</span><span class="p">,</span> <span class="n">fs</span><span class="p">)</span> <span class="c1"># get filter coefficients</span>
        <span class="n">w</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">freqz</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">fs</span><span class="p">)</span> <span class="c1"># calculate impulse response</span>
        <span class="n">h_db</span> <span class="o">=</span> <span class="mi">20</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">h</span><span class="p">))</span> <span class="c1"># dB</span>
        <span class="n">ax_gain</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">h_db</span><span class="p">)</span>

<span class="n">ax_gain</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">13</span><span class="p">,</span> <span class="mi">13</span><span class="p">],</span> <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Frequenz in Hz&#39;</span><span class="p">,</span><span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Verst√§rkung in dB&#39;</span><span class="p">,</span> 
        <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Shelf-EQs variablem Gain </span><span class="se">\n</span><span class="s1"> bei Grenzfrequenz f = </span><span class="si">{</span><span class="n">f_c</span><span class="si">}</span><span class="s1"> Hz&#39;</span><span class="p">)</span>

        

<span class="n">freqs</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">fs</span><span class="o">/</span><span class="mi">10</span><span class="p">,</span> <span class="n">fs</span><span class="o">/</span><span class="mi">5</span><span class="p">,</span> <span class="n">fs</span><span class="o">/</span><span class="mi">3</span><span class="p">]</span>
<span class="n">gain</span> <span class="o">=</span> <span class="mi">12</span>
<span class="k">for</span> <span class="n">f_c</span> <span class="ow">in</span> <span class="n">freqs</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">ftype</span> <span class="ow">in</span> <span class="n">shelf_types</span><span class="p">:</span>
        <span class="n">b</span><span class="p">,</span> <span class="n">a</span> <span class="o">=</span> <span class="n">getShelvingEQ</span><span class="p">(</span><span class="n">f_c</span><span class="p">,</span> <span class="n">gain</span><span class="p">,</span> <span class="n">ftype</span><span class="p">,</span> <span class="n">fs</span><span class="p">)</span> <span class="c1"># get filter coefficients</span>
        <span class="n">w</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">freqz</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">fs</span><span class="p">)</span> <span class="c1"># calculate impulse response</span>
        <span class="n">h_db</span> <span class="o">=</span> <span class="mi">20</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">h</span><span class="p">))</span> <span class="c1"># dB</span>
        <span class="n">ax_freq</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">h_db</span><span class="p">)</span>
<span class="n">ax_freq</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">13</span><span class="p">,</span> <span class="mi">13</span><span class="p">],</span> <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Frequenz in Hz&#39;</span><span class="p">,</span><span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Verst√§rkung in dB&#39;</span><span class="p">,</span> 
        <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Shelf-EQs mit variabler Grenzfrequenz </span><span class="se">\n</span><span class="s1"> bei Gain = </span><span class="si">{</span><span class="n">gain</span><span class="si">}</span><span class="s1"> dB&#39;</span><span class="p">)</span>

<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;EQ_ShelvParam&quot;</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="tabbed-set docutils">
<input checked="checked" id="f712793f-3d8a-4e4e-bad4-34621866dbac" name="53325a7a-3b0e-40a1-bdf1-bef94920b44e" type="radio">
</input><label class="tabbed-label" for="f712793f-3d8a-4e4e-bad4-34621866dbac">
Buchabbildung</label><div class="tabbed-content docutils">
<div class="figure align-default" id="fig-eq-shelvparam" style="width: 75%">
<div class="cell_output docutils container">
<img alt="_images/filter_13_1.png" src="_images/filter_13_1.png" />
</div>
<p class="caption"><span class="caption-text">Equalizer√ºbertragungskurven eines Hoch bzw. Tiefpasskuhschwanzfilters bei Ver√§nderung der Verst√§rkung und Frequenz</span><a class="headerlink" href="#fig-eq-shelvparam" title="Permalink to this image">¬∂</a></p>
</div>
</div>
<input id="0cba07ee-bf12-4ace-8690-0006b9804dc0" name="53325a7a-3b0e-40a1-bdf1-bef94920b44e" type="radio">
</input><label class="tabbed-label" for="0cba07ee-bf12-4ace-8690-0006b9804dc0">
Interaktiv arbeiten</label><div class="tabbed-content docutils">
<ol class="simple">
<li><p>Starten des interaktiven Programms - ‚ÄúFilter_Shelving_EQ.py‚Äù in jupyterbook/interactive_programs</p></li>
<li><p>Mit Slidern Parameter einstellen</p></li>
</ol>
</div>
</div>
<p>Im Gegensatz zu den vollparametrischen EQs sind bei Terzband-Equalizer
die Frequenzen und G√ºten festgelegt. Der Nutzer hat nur einen Einfluss
auf de Verst√§rkung oder Absenkung. Der Vorteil dieser Equalizer ist ihre
einfache Bedienung und die M√∂glichkeit sofort zu sehen, welche
Frequenzver√§nderungen vorgenommen werden. Die Mittenfrequenzen der
Filter sind standardisiert. Tabelle ‚Ä¶ gibt diese Frequenzen wieder.</p>
<div class="cell tag_hide-input tag_remove-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span>

<span class="n">df_oktav</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;index&#39;</span><span class="p">:[</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> 
    <span class="s1">&#39;Frequenz (Hz)&#39;</span><span class="p">:[</span><span class="mf">31.5</span><span class="p">,</span> <span class="mi">63</span><span class="p">,</span> <span class="mi">125</span><span class="p">,</span> <span class="mi">250</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">2000</span><span class="p">,</span> <span class="mi">4000</span><span class="p">,</span> <span class="mi">8000</span><span class="p">,</span> <span class="mi">16000</span><span class="p">]})</span>
<span class="n">df_terz</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;index&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mi">16</span><span class="p">,</span> <span class="o">-</span><span class="mi">15</span><span class="p">,</span> <span class="o">-</span><span class="mi">14</span><span class="p">,</span> <span class="o">-</span><span class="mi">13</span><span class="p">,</span> <span class="o">-</span><span class="mi">12</span><span class="p">,</span> <span class="o">-</span><span class="mi">11</span><span class="p">,</span> <span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="o">-</span><span class="mi">9</span><span class="p">,</span> <span class="o">-</span><span class="mi">8</span><span class="p">,</span> <span class="o">-</span><span class="mi">7</span><span class="p">,</span> <span class="o">-</span><span class="mi">6</span><span class="p">,</span> 
     <span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">13</span><span class="p">]</span> <span class="p">,</span>
    <span class="s1">&#39;Frequenz (Hz))&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">25</span><span class="p">,</span><span class="mf">31.5</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">63</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">125</span><span class="p">,</span> <span class="mi">160</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">250</span><span class="p">,</span> 
     <span class="mi">315</span><span class="p">,</span> <span class="mi">400</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">630</span><span class="p">,</span> <span class="mi">800</span><span class="p">,</span><span class="mi">1000</span><span class="p">,</span><span class="mi">1250</span><span class="p">,</span><span class="mi">1600</span><span class="p">,</span><span class="mi">2000</span><span class="p">,</span><span class="mi">2500</span><span class="p">,</span>
     <span class="mi">3150</span><span class="p">,</span><span class="mi">4000</span><span class="p">,</span><span class="mi">5000</span><span class="p">,</span><span class="mi">6300</span><span class="p">,</span><span class="mi">8000</span><span class="p">,</span><span class="mi">10000</span><span class="p">,</span><span class="mi">12500</span><span class="p">,</span><span class="mi">16000</span><span class="p">,</span><span class="mi">20000</span><span class="p">]})</span>
<span class="n">df_oktav</span> <span class="o">=</span> <span class="n">df_oktav</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;index&#39;</span><span class="p">)</span>
<span class="n">df_terz</span> <span class="o">=</span> <span class="n">df_terz</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;index&#39;</span><span class="p">)</span>

<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;df_oktav&quot;</span><span class="p">,</span> <span class="n">df_oktav</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;df_terz&quot;</span><span class="p">,</span> <span class="n">df_terz</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="sphinx-bs container pb-4 docutils">
<div class="row docutils">
<div class="d-flex col-4 docutils">
<div class="card w-100 border-2 docutils">
<div class="card-header docutils">
<p class="card-text">Oktav-EQ</p>
</div>
<div class="card-body docutils">
<div class="figure align-default" id="tab-df-oktav" style="width: 300px">
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Frequenz (Hz)</th>
    </tr>
    <tr>
      <th>index</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>-5</th>
      <td>31.5</td>
    </tr>
    <tr>
      <th>-4</th>
      <td>63.0</td>
    </tr>
    <tr>
      <th>-3</th>
      <td>125.0</td>
    </tr>
    <tr>
      <th>-2</th>
      <td>250.0</td>
    </tr>
    <tr>
      <th>-1</th>
      <td>500.0</td>
    </tr>
    <tr>
      <th>0</th>
      <td>1000.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2000.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>4000.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>8000.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>16000.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
</div>
</div>
<div class="d-flex col-4 docutils">
<div class="card w-100 border-2 docutils">
<div class="card-header docutils">
<p class="card-text">Terz-EQ</p>
</div>
<div class="card-body docutils">
<div class="figure align-default" id="tab-df-terz" style="width: 300px">
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Frequenz (Hz))</th>
    </tr>
    <tr>
      <th>index</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>-16</th>
      <td>25.0</td>
    </tr>
    <tr>
      <th>-15</th>
      <td>31.5</td>
    </tr>
    <tr>
      <th>-14</th>
      <td>40.0</td>
    </tr>
    <tr>
      <th>-13</th>
      <td>50.0</td>
    </tr>
    <tr>
      <th>-12</th>
      <td>63.0</td>
    </tr>
    <tr>
      <th>-11</th>
      <td>80.0</td>
    </tr>
    <tr>
      <th>-10</th>
      <td>100.0</td>
    </tr>
    <tr>
      <th>-9</th>
      <td>125.0</td>
    </tr>
    <tr>
      <th>-8</th>
      <td>160.0</td>
    </tr>
    <tr>
      <th>-7</th>
      <td>200.0</td>
    </tr>
    <tr>
      <th>-6</th>
      <td>250.0</td>
    </tr>
    <tr>
      <th>-5</th>
      <td>315.0</td>
    </tr>
    <tr>
      <th>-4</th>
      <td>400.0</td>
    </tr>
    <tr>
      <th>-3</th>
      <td>500.0</td>
    </tr>
    <tr>
      <th>-2</th>
      <td>630.0</td>
    </tr>
    <tr>
      <th>-1</th>
      <td>800.0</td>
    </tr>
    <tr>
      <th>0</th>
      <td>1000.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1250.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1600.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2000.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2500.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>3150.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>4000.0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>5000.0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>6300.0</td>
    </tr>
    <tr>
      <th>9</th>
      <td>8000.0</td>
    </tr>
    <tr>
      <th>10</th>
      <td>10000.0</td>
    </tr>
    <tr>
      <th>11</th>
      <td>12500.0</td>
    </tr>
    <tr>
      <th>12</th>
      <td>16000.0</td>
    </tr>
    <tr>
      <th>13</th>
      <td>20000.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
</div>
</div>
</div>
</div>
<p>F√ºr bestimmte Anwendungen (z.B. Synthesizer) werden auch manchmal Filter
verwendet, die in ihrer Grundcharakteristik den Sperrfiltern
entsprechen, aber zus√§tzlich in der N√§he der Grenzfrequenz eine
Verst√§rkung einbringen. Diese Verst√§rkungsfrequenzen kommen bei
nat√ºrlichen Musikinstrumenten ebenfalls h√§ufig vor. Man spricht in
diesem Fall von sog. Resonanzfrequenzen, da bestimmte Signalanteile im
Filter eine starke Resonanz finden.</p>
</div>
<div class="section" id="realisierungsformen">
<h2>Realisierungsformen<a class="headerlink" href="#realisierungsformen" title="Permalink to this headline">¬∂</a></h2>
<p>Wir haben gesehen, dass es eine Vielzahl von unterschiedlichen
Filtereinsatzm√∂glichkeiten gibt. Bisher wurde aber keinerlei Hinweis auf
die Realsierungsformen gegeben. Aus der Beschreibung von Systemen kennen
wir zwei unterschiedliche Systemarten. Die Systeme mit R√ºckkopplung
(rekursiv) und ohne. Als Bezeichnung hatten wir eingef√ºhrt, Infinite
Impulse Response (IIR) und Finite Impulse Response (FIR) Systeme. Und
genau diese Bezeichnungen kennzeichnen auch die beiden grunds√§tzlichen
Realisierungsformen von Filtern.</p>
<div class="section" id="fir-filter">
<h3>FIR-Filter<a class="headerlink" href="#fir-filter" title="Permalink to this headline">¬∂</a></h3>
<p>Die Anwendung von FIR-Filtern ist ausschlie√ülich durch digitale
Signalverarbeitung m√∂glich, da eine Realisierung in Analogtechnk mit
elektrischen Bauelementen nicht m√∂glich ist. FIR-Filter zeichnen sich
durch einige positive Eigenschaften aus. In erster Linie kann die
Stabilit√§t immer garantiert werden. Alle FIR-Filter sind stabil.
Weiterhin ist es m√∂glich mit FIR-Systeme Filter zu realisieren, die nur
den Betragsfrequenzgang ver√§ndern und sonst nur eine zeitliche
Verz√∂gerung des Signals bewirken. Die zeitliche Verz√∂gerung macht sich
in der √úbertragungsfunktion durch eine lineare Phase deutlich. Diese
Filter werden deshalb linearphasig genannt.</p>
<div class="section" id="beschreibung-als-blockdiagramm">
<h4>Beschreibung als Blockdiagramm<a class="headerlink" href="#beschreibung-als-blockdiagramm" title="Permalink to this headline">¬∂</a></h4>
<p>Bisher haben wir FIR-Systeme nur als Differenzengleichung oder als
z-√úbertragungsfunktion kennen gelernt. Um die noch folgende
Implementierung zu erm√∂glichen ist eine andere Darstellung aber
hilfreicher. Schaut man sich die Differenzengleichung f√ºr ein FIR-Filter
genauer an. So erkennt man, dass man 3 verschiedene Bauteile braucht.</p>
<ul class="simple">
<li><p>Addierer</p></li>
<li><p>Multiplizierer</p></li>
<li><p>Einen Verzogerungseinheit, die das Signal um genau einen Sample <span class="math notranslate nohighlight">\(T\)</span>
verz√∂gert. Dies kann durch ein einfaches Speicherelement geschehen.</p></li>
</ul>
<p>Diese 3 Elemente werden im folgenden durch die in <code class="xref std std-numref docutils literal notranslate"><span class="pre">Abbildung</span> <span class="pre">%s</span></code> gezeigten Symbole beschrieben.</p>
<div class="figure align-default" id="fig-blockdiagrammsymbole">
<a class="reference internal image-reference" href="_images/BlockdiagrammSymbole.png"><img alt="_images/BlockdiagrammSymbole.png" src="_images/BlockdiagrammSymbole.png" style="width: 50%;" /></a>
<p class="caption"><span class="caption-text">Symbole um Zeichnen von Filter
Strukturen als
Blockdiagramm</span><a class="headerlink" href="#fig-blockdiagrammsymbole" title="Permalink to this image">¬∂</a></p>
</div>
<p>Beispielsweise ergibt sich f√ºr ein FIR-System erster Ordnung, dass durch
<span class="math notranslate nohighlight">\(y(k) = b_0 x(k) + b_1 x(k-1)\)</span> beschrieben ist, das folgende
Blockschaltbild.</p>
<div class="figure align-default" id="fig-firersterordnung">
<a class="reference internal image-reference" href="_images/FIRErsterOrdnung.png"><img alt="_images/FIRErsterOrdnung.png" src="_images/FIRErsterOrdnung.png" style="width: 30%;" /></a>
<p class="caption"><span class="caption-text">Blockdiagramm eines FIR-Filters 1.
Ordnung</span><a class="headerlink" href="#fig-firersterordnung" title="Permalink to this image">¬∂</a></p>
</div>
<p>Zur Realisierung eines allgemeinen FIR-Filters muss das allgemeine
Blockschaltbild genauer betrachtet werden (siehe <code class="xref std std-numref docutils literal notranslate"><span class="pre">Abbildung</span> <span class="pre">%s</span></code>).</p>
<div class="figure align-default" id="fig-fir-allgemeinblock">
<a class="reference internal image-reference" href="_images/FIR_allgemeinBlock.png"><img alt="_images/FIR_allgemeinBlock.png" src="_images/FIR_allgemeinBlock.png" style="width: 80%;" /></a>
<p class="caption"><span class="caption-text">Allgemeine FIR-Filter
Struktur.</span><a class="headerlink" href="#fig-fir-allgemeinblock" title="Permalink to this image">¬∂</a></p>
</div>
<p>Es wird deutlich, dass wir bei <span class="math notranslate nohighlight">\(N\)</span>-Koeffizienten <span class="math notranslate nohighlight">\(N-1\)</span> Speicherelemente
ben√∂tigen, die die jeweilige Vergangenheit von <span class="math notranslate nohighlight">\(x(k)\)</span> speichern.</p>
<p>Um einen Ausgangswert <span class="math notranslate nohighlight">\(y(k)\)</span> zu berechnen, muss die Summe</p>
<div class="math notranslate nohighlight" id="equation-eq-fir-filter">
<span class="eqno">()<a class="headerlink" href="#equation-eq-fir-filter" title="Permalink to this equation">¬∂</a></span>\[
    y(k) = \sum_{i = 0}^{N-1} b_i x(k-i)
\]</div>
<p>berechnet werden.
Abschlie√üend wird der Speicher um eine Stelle weiter geschoben.
Gleichung <a class="reference internal" href="#equation-eq-fir-filter">()</a> ist bereits von der Faltung bekannt. Somit
ist ein FIR-Filter also eine andere Bezeichnung f√ºr ein System zur
Faltung.</p>
</div>
</div>
<div class="section" id="fir-filter-design">
<h3>FIR-Filter Design<a class="headerlink" href="#fir-filter-design" title="Permalink to this headline">¬∂</a></h3>
<p>Nachdem die Strukturen zur Realisierung von Filtern bekannt sind, fehlt
noch die Bestimmung der einzelnen Filterkoeffizienten. Es muss also
√ºberlegt werden, wie aus einem bestimmten Entwurf des Filters im
Frequenzbereich, geeignete Koeffizienten im Zeitbereich berechnet werden
k√∂nnen. Dazu betrachten wir zun√§chst nur die FIR-Filter. Es sind
verschiedene Verfahren bekannt. Die beiden am h√§ufigsten Methoden sollen
im weiteren genauer erl√§utert werden.</p>
<div class="section" id="fenster-methode">
<h4>Fenster-Methode<a class="headerlink" href="#fenster-methode" title="Permalink to this headline">¬∂</a></h4>
<p>Aus dem Abschnitt √ºber Spektren ist uns bekannt, dass wir zu einer
Zeitfolge mit Hilfe der DTFT ein Spektrum berechnen k√∂nnen, dass in
<span class="math notranslate nohighlight">\(2\pi\)</span> periodisch ist. Zu dieser Hintransformation gibt es auch die
korrespondierende R√ºcktransformation die als</p>
<div class="math notranslate nohighlight" id="equation-fir-idtft-def">
<span class="eqno">()<a class="headerlink" href="#equation-fir-idtft-def" title="Permalink to this equation">¬∂</a></span>\[
    x(k) = \frac{1}{2\pi}\int_{-\pi}^{\pi} X(e^(j \Omega)) e^{j\Omega k} d\Omega
\]</div>
<p>definiert ist. Somit ist es nat√ºrlich auch m√∂glich zu einem bestimmten
Frequenzentwurf eine zugeh√∂rige Zeitfolge zu berechnen. Nehmen wir
beispielsweise an, wir suchen die Koeffizienten, um ein ideales
Tiefpassfilter mit der Grenzfrequenz <span class="math notranslate nohighlight">\(\Omega_g\)</span> zu realisieren. Die
Definition der √úbertragungsfunktion ist somit</p>
<div class="math notranslate nohighlight" id="equation-fir-bsp-tiefpass">
<span class="eqno">()<a class="headerlink" href="#equation-fir-bsp-tiefpass" title="Permalink to this equation">¬∂</a></span>\[\begin{split}
    H(e^(j \Omega)) = \Bigg\{ \begin{array}{lcc}
1 &amp; f√ºr &amp; -\Omega_g \leq \Omega \leq  \Omega_g\\
0 &amp; &amp; \Omega_g &lt; |\Omega| \leq \pi
\end{array}
\end{split}\]</div>
<p>F√ºr die gesuchten Filterkoeffizienten ergibt sich</p>
<div class="math notranslate nohighlight" id="equation-fir-tp-ideal">
<span class="eqno">()<a class="headerlink" href="#equation-fir-tp-ideal" title="Permalink to this equation">¬∂</a></span>\[\begin{split}
\begin{aligned}
    h(k) &amp; = &amp;\frac{1}{2\pi}\int_{-\pi}^{\pi} H(e^(j \Omega)) e^{j\Omega k} d\Omega\\
         &amp; = &amp;\frac{1}{2\pi}\int_{-\Omega_g}^{\Omega_g}e^{j\Omega k} d\Omega\\
         &amp; = &amp;\frac{\Omega_g}{\pi} \frac{\sin(\Omega_g k)}{\Omega_g k}\end{aligned}
\end{split}\]</div>
<p>Problematisch an diesem Ergebnis ist zum einen, dass sich die gefundene
Koeffizienten unendlich ausdehnen und zum anderen, dass das Filter auch
noch nicht-kausale Anteile enth√§lt. Aus dem ersten Grund muss immer eine
Begrenzung vorgenommen werden. Das hei√üt die gefundenen Koeffizienten
werden nach einer bestimmten L√§nge zu beiden Seiten der Zeitachse
gleichm√§√üig abgeschnitten. Dies f√ºhrt nicht mehr zum idealen Tiefpass,
sondern zu einer Approximation. Der sich ergebende Fehler kann aus der
√úberlegung zur Spektrumsanalyse ersehen werden. Die Begrenzung
entspricht einer Gewichtung der Filterkoeffizienten mit einem
Rechteck-Fenster. Diese Multiplikation f√ºhrt im Frequenzbereich zu einer
Faltung mit der √úbertragungsfunktion des Rechtecks. F√ºr den idealen
Tiefpass hat das zwei Konsequenzen. Erstens ist der √úbergang vom
Durchlass- zum Sperrbereich nicht mehr unendlich steil und zweitens
enstehen an der √úbergangsstelle √úberschwinger. Vergr√∂√üert man nun die
L√§nge des Ausschnitts, so wird der √úbergangsbereich schmaller, und die
√úberschwinger konzentrieren sich an der √úbergangsstelle, aber die H√∂he
der √úberschwinger bleiben gleich (siehe
<code class="xref std std-numref docutils literal notranslate"><span class="pre">Abbildung</span> <span class="pre">%s</span></code> ). Dies wird als Gippsches Ph√§nomen
bezeichnet.</p>
<div class="cell tag_hide-input tag_remove-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span>
<span class="kn">from</span> <span class="nn">myst_nb</span> <span class="kn">import</span> <span class="n">glue</span>

<span class="n">matplotlib</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;sv.mplstyle&#39;</span><span class="p">)</span>

<span class="n">samples</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">201</span><span class="p">)</span>
<span class="n">si</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">samples</span><span class="p">)</span>
<span class="n">mid</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">samples</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span>

<span class="n">fs</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">f0</span> <span class="o">=</span> <span class="mi">100</span>

<span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">samples</span><span class="p">)):</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">samples</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">!=</span><span class="mi">0</span><span class="p">):</span>
        <span class="n">si</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">f0</span> <span class="o">*</span> <span class="n">samples</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">/</span><span class="n">fs</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">samples</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">*</span><span class="n">f0</span><span class="o">/</span><span class="n">fs</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># si(0) = 1 to avoid division by zero</span>
        <span class="n">si</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

<span class="c1"># cut si-function</span>
<span class="n">si_short</span> <span class="o">=</span> <span class="n">si</span><span class="p">[(</span><span class="n">mid</span><span class="o">-</span><span class="mi">25</span><span class="p">):(</span><span class="n">mid</span><span class="o">+</span><span class="mi">25</span><span class="p">)]</span>
<span class="n">samples_short</span> <span class="o">=</span> <span class="n">samples</span><span class="p">[(</span><span class="n">mid</span><span class="o">-</span><span class="mi">25</span><span class="p">):(</span><span class="n">mid</span><span class="o">+</span><span class="mi">25</span><span class="p">)]</span>

<span class="n">ax_si</span> <span class="o">=</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">ax_si</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">samples</span><span class="p">,</span> <span class="n">si</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dotted&#39;</span><span class="p">)</span>
<span class="n">ax_si</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">samples_short</span><span class="p">,</span> <span class="n">si_short</span><span class="p">)</span>
<span class="n">ax_si</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Folgenkindex k -&gt;&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Amplitude x(k)&#39;</span><span class="p">,</span> 
        <span class="n">title</span><span class="o">=</span><span class="s1">&#39;SI-Funktion&#39;</span><span class="p">)</span>
<span class="n">ax_si</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">])</span>

<span class="c1"># zero padding, for display resolution</span>
<span class="n">si_short</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span> <span class="o">+</span> <span class="n">si_short</span> <span class="o">+</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span>
<span class="n">si</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span> <span class="o">+</span> <span class="n">si</span> <span class="o">+</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span>

<span class="n">spectrum_short</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">si_short</span><span class="p">)</span>
<span class="n">spectrum</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">si</span><span class="p">)</span>

<span class="n">w</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">si</span><span class="p">))</span>
<span class="n">w_short</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">si_short</span><span class="p">))</span>

<span class="n">ax_spec</span> <span class="o">=</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">ax_spec</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">w_short</span><span class="p">,</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">numpy</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">spectrum_short</span><span class="p">)),</span> 
        <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dotted&#39;</span><span class="p">)</span>
<span class="n">ax_spec</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">numpy</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">spectrum</span><span class="p">)))</span> <span class="c1"># dB spectrum</span>
<span class="n">ax_spec</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Frequenz normalisiert mit w/pi&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Amplitude in dB&#39;</span><span class="p">,</span> 
        <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Spektrum&#39;</span><span class="p">,</span> <span class="n">xlim</span><span class="o">=</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">]))</span>

<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;GippsPheanomen&quot;</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="figure align-default" id="fig-gippspheanomen" style="width: 75%">
<div class="cell_output docutils container">
<img alt="_images/filter_25_0.png" src="_images/filter_25_0.png" />
</div>
<p class="caption"><span class="caption-text">Beispiel zur Veranschaulichung des
Gipps-Ph√§nomens</span><a class="headerlink" href="#fig-gippspheanomen" title="Permalink to this image">¬∂</a></p>
</div>
<p>Die Ursache hierf√ºr ist in der √úbertragungsfunktion des Rechteckfensters
zu suchen. Betrachtet man diese Funktion f√ºr die beiden betrachteten
L√§ngen, so erkennt man die Konzenzentration der √úberschwinger bei der
Frequenz Null. Die H√∂he der √úberschwinger bleibt aber identisch. Genau
dieses Verhalten wird durch die Faltung im Frequenzbereich auf die
√úbertragungsfunktion des idealen Tiefpasses aufgepr√§gt. Man kann aber
zeigen [KK98], dass die Approximation im Sinne des kleinsten
Fehlerquadrates <em>Minimum Mean Square Error (MMSE)</em> √ºber alle Frequenzen
optimal ist.</p>
<p>Um die nicht-kausalen Anteile zu beseitigen ist zus√§tzlich noch eine
zeitliche Verschiebung der gefundenen Filterkoeffizienten notwendig.
Diese Verschiebung f√ºhrt dann, wie man durch den Verschiebungssatz der
Fourier-Transformation sieht, zu einer linearen Phase des entworfenen
Tiefpasses.</p>
<p>Zur Vermeidung der √úberschwinger <em>Ripple</em> k√∂nnen nun dieselben Techniken
verwendet werden, die auch die Spektralanalyse verbessert haben. Eine
Nutzung der dort vorgestellten Fensterfunktionen f√ºhrt auf eine
geringere Auspr√§gung der Ripple, wobei gleichzeitig der √úbergangsbereich
zwischen Durchgangs- und Sperrbereich zunimmt. Um das zu
veranschaulichen, ist in <code class="xref std std-numref docutils literal notranslate"><span class="pre">Abbildung</span> <span class="pre">%s</span></code>  der Entwurf eines Filters mit
unterschiedlichen Fensterfunktionen gezeigt. Man erkennt deutlich, dass
mit zunehmendem √úbergangsbereich die √úberschwinger abnehmen, wobei diese
bei Nutzung der Fensterfunktionen nur noch im Sperrbereich deutlich zu
erkennen sind.</p>
<div class="cell tag_hide-input tag_remove-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">signal</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span>
<span class="kn">from</span> <span class="nn">myst_nb</span> <span class="kn">import</span> <span class="n">glue</span>

<span class="n">matplotlib</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;sv.mplstyle&#39;</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax_51</span><span class="p">,</span> <span class="n">ax_201</span><span class="p">)</span> <span class="o">=</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

<span class="n">eps</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">finfo</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span><span class="o">.</span><span class="n">eps</span> <span class="c1"># for slight offset to avoid division by 0</span>
<span class="n">f_s</span> <span class="o">=</span> <span class="mi">48000</span> 
<span class="n">f_g</span> <span class="o">=</span> <span class="mi">4800</span> <span class="c1"># Hz, cuttoff frequency</span>

<span class="n">trans_width</span> <span class="o">=</span> <span class="mi">1200</span>  <span class="c1"># Hz, Width of transition from pass band to stop band</span>

<span class="c1"># filter length 51</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">51</span>      <span class="c1"># Size of the FIR filter.</span>
<span class="n">idxs</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="o">-</span><span class="n">N</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">N</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="n">N</span><span class="p">)</span>

<span class="c1"># Remez filter design</span>
<span class="n">taps</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">remez</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">f_g</span><span class="p">,</span> <span class="n">f_g</span> <span class="o">+</span> <span class="n">trans_width</span><span class="p">,</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">f_s</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">Hz</span><span class="o">=</span><span class="n">f_s</span><span class="p">)</span>
<span class="n">w</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">freqz</span><span class="p">(</span><span class="n">taps</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">worN</span><span class="o">=</span><span class="mi">2000</span><span class="p">)</span>
<span class="n">w</span> <span class="o">=</span> <span class="n">w</span><span class="o">/</span><span class="n">numpy</span><span class="o">.</span><span class="n">pi</span>

<span class="c1"># Von Hann filter design</span>
<span class="n">w_rad</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">f_g</span><span class="o">/</span><span class="n">f_s</span> <span class="c1"># cutoff freq in rang od 0 -&gt; 2*pi</span>
<span class="c1"># designing the filter</span>
<span class="n">rect_window_51</span> <span class="o">=</span> <span class="n">w_rad</span><span class="o">/</span><span class="n">numpy</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">w_rad</span><span class="o">*</span><span class="n">idxs</span><span class="o">+</span><span class="n">eps</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">w_rad</span><span class="o">*</span><span class="n">idxs</span><span class="o">+</span><span class="n">eps</span><span class="p">)</span>
<span class="n">von_hann_window</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">N</span>
<span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
    <span class="n">von_hann_window</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">-</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">idx</span><span class="o">/</span><span class="n">N</span><span class="p">)</span>
<span class="n">window_51</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">rect_window_51</span><span class="p">)</span> <span class="o">*</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">von_hann_window</span><span class="p">)</span>
<span class="n">spectrum</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">window_51</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">1000</span><span class="p">)))</span>
<span class="n">mid</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">spectrum</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="c1"># shift area from pi -&gt; 2pi to -pi -&gt; 0</span>
<span class="n">spectrum</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">spectrum</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">mid</span><span class="p">):],</span> <span class="n">spectrum</span><span class="p">[:</span><span class="nb">int</span><span class="p">(</span><span class="n">mid</span><span class="p">)]])</span> 
<span class="c1"># dB maximum = 0dB</span>
<span class="n">spectrum_abs</span> <span class="o">=</span> <span class="mi">20</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">spectrum</span><span class="p">)</span><span class="o">/</span><span class="n">numpy</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">spectrum</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">())</span> 
<span class="n">freqs_fft</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">spectrum_abs</span><span class="p">))</span> <span class="c1"># freq bins, for plotting</span>

<span class="n">ax_51</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="mi">20</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">h</span><span class="p">)))</span>
<span class="n">ax_51</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">freqs_fft</span><span class="p">,</span> <span class="n">spectrum_abs</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">ax_51</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Frequenz in rad/s&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Pegel in dB&#39;</span><span class="p">,</span> <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">],</span> 
        <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Filterl√§nge 51&#39;</span><span class="p">)</span>

<span class="c1"># filter length 201</span>
<span class="c1"># -----------------</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">201</span>     <span class="c1"># Size of the FIR filter.</span>
<span class="n">idxs</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="o">-</span><span class="n">N</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">N</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="n">N</span><span class="p">)</span>

<span class="n">taps</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">remez</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">f_g</span><span class="p">,</span> <span class="n">f_g</span> <span class="o">+</span> <span class="n">trans_width</span><span class="p">,</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">f_s</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">Hz</span><span class="o">=</span><span class="n">f_s</span><span class="p">)</span>
<span class="n">w</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">freqz</span><span class="p">(</span><span class="n">taps</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">worN</span><span class="o">=</span><span class="mi">2000</span><span class="p">)</span>
<span class="n">w</span> <span class="o">=</span> <span class="n">w</span><span class="o">/</span><span class="n">numpy</span><span class="o">.</span><span class="n">pi</span>
<span class="c1"># Von Hann</span>
<span class="n">w_rad</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">f_g</span><span class="o">/</span><span class="n">f_s</span> <span class="c1"># cutoff freq in rang od 0 -&gt; 2*p</span>
<span class="c1"># designing the filter</span>
<span class="n">rect_window_51</span> <span class="o">=</span> <span class="n">w_rad</span><span class="o">/</span><span class="n">numpy</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">w_rad</span><span class="o">*</span><span class="n">idxs</span><span class="o">+</span><span class="n">eps</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">w_rad</span><span class="o">*</span><span class="n">idxs</span><span class="o">+</span><span class="n">eps</span><span class="p">)</span>
<span class="n">von_hann_window</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">N</span>
<span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
    <span class="n">von_hann_window</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">-</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">idx</span><span class="o">/</span><span class="n">N</span><span class="p">)</span>
<span class="n">window_201</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">rect_window_51</span><span class="p">)</span> <span class="o">*</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">von_hann_window</span><span class="p">)</span>
<span class="n">spectrum</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">window_201</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">1000</span><span class="p">)))</span>
<span class="n">mid</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">spectrum</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="c1"># shift area from pi -&gt; 2pi to -pi -&gt; 0</span>
<span class="n">spectrum</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">spectrum</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">mid</span><span class="p">):],</span> <span class="n">spectrum</span><span class="p">[:</span><span class="nb">int</span><span class="p">(</span><span class="n">mid</span><span class="p">)]])</span> 
<span class="c1"># dB maximum = 0dB</span>
<span class="n">spectrum_abs</span> <span class="o">=</span> <span class="mi">20</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">spectrum</span><span class="p">)</span><span class="o">/</span><span class="n">numpy</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">spectrum</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">())</span> 
<span class="n">freqs_fft</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">spectrum_abs</span><span class="p">))</span> <span class="c1"># freq bins, for plotting</span>


<span class="n">ax_201</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="mi">20</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">h</span><span class="p">)))</span>
<span class="n">ax_201</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">freqs_fft</span><span class="p">,</span> <span class="n">spectrum_abs</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">ax_201</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Frequenz in rad/s&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Pegel in dB&#39;</span><span class="p">,</span> <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">],</span> 
        <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Filterl√§nge 201&#39;</span><span class="p">)</span>

<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;BspFensterEntwurf&quot;</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="figure align-default" id="fig-bspfensterentwurf" style="width: 75%">
<div class="cell_output docutils container">
<img alt="_images/filter_28_0.png" src="_images/filter_28_0.png" />
</div>
<p class="caption"><span class="caption-text">Beispiel eines Tiefpass-Entwurfes mit
Rechteck und Hann-Fesnster unterschiedlicher L√§nge. Grenzfrequenz =
<span class="math notranslate nohighlight">\(\Omega_g = 0.2\pi\)</span></span><a class="headerlink" href="#fig-bspfensterentwurf" title="Permalink to this image">¬∂</a></p>
</div>
</div>
<div class="section" id="parks-mcclellan">
<h4>Parks-McClellan<a class="headerlink" href="#parks-mcclellan" title="Permalink to this headline">¬∂</a></h4>
<p>Im letzten Abschnitt wurde eine optimale L√∂sung vorgestellt, die den
mittleren Fehler √ºber das Gesamtspektrum minimiert. Dabei hat sich aber
der Fehler an der √úbergangsstelle konzentriert. Eine weitere optimale
L√∂sung ist, den Fehler √ºber alle Frequenzen gleich zu verteilen. Die
verbleibende Fehlergr√∂√üe ist dabei nur von der gew√§hlten Ordnung des
Filters abh√§ngig. Zur L√∂sung dieses Problems wurde von Parks und
McClellan der sog. Remez-Algorithmus entwickelt, der zur optimalen
L√∂sung konvergiert. Der Restfehler ist dabei minimal f√ºr alle
Frequenzen. Diese Minimierung des maximalen Fehlers wird auch als
Tschebyscheff-L√∂sung bezeichnet.</p>
<p>Um die L√∂sung zu verdeutlichen und die Unterschiede zur Fenster-Methode
heraus zu arbeiten, ist in <code class="xref std std-numref docutils literal notranslate"><span class="pre">Abbildung</span> <span class="pre">%s</span></code>  ein Entwurf eines Tiefpass-Filters
mittels Remez-Entwurfsverfahren und mittels Fenster-Entwurfs mit
Hann-Fenster gegen√ºber gestellt. Wir erkennen, dass bei gleicher Ordnung
das Remez-Verfahren eine insgesamt bessere Sperrd√§mpfung zur Verf√ºgung
stellt. Dies bedeutet im Umkehrschluss, dass bei einer im Entwurf
spezifizierten Sperrd√§mpfung die Ordnung des resultierenden Filters beim
Remez-Verfahren deutlich kleiner ist. F√ºr die konkrete Realisierung
bedeutet dies eine deutliche Aufwandsreduktion.</p>
<div class="cell tag_hide-input tag_remove-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">signal</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span>
<span class="kn">from</span> <span class="nn">myst_nb</span> <span class="kn">import</span> <span class="n">glue</span>

<span class="n">matplotlib</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;sv.mplstyle&#39;</span><span class="p">)</span>


<span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax_51</span><span class="p">,</span> <span class="n">ax_201</span><span class="p">)</span> <span class="o">=</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">eps</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">finfo</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span><span class="o">.</span><span class="n">eps</span> <span class="c1"># for slight offset to avoid division by 0</span>
<span class="n">f_s</span> <span class="o">=</span> <span class="mi">48000</span>
<span class="n">f_g</span> <span class="o">=</span> <span class="mi">4800</span> <span class="c1"># cutoff frequency</span>


<span class="n">trans_width</span> <span class="o">=</span> <span class="mi">1200</span>  <span class="c1"># Hz, Width of transition from pass band to stop band</span>

<span class="c1"># filter length 51</span>
<span class="c1"># ----------------</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">51</span> <span class="c1"># Size of the FIR filter.</span>
<span class="n">idxs</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="o">-</span><span class="n">N</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">N</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="n">N</span><span class="p">)</span>

<span class="c1"># Remez filter design</span>
<span class="n">taps</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">remez</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">f_g</span><span class="p">,</span> <span class="n">f_g</span> <span class="o">+</span> <span class="n">trans_width</span><span class="p">,</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">f_s</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">Hz</span><span class="o">=</span><span class="n">f_s</span><span class="p">)</span>
<span class="n">w</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">freqz</span><span class="p">(</span><span class="n">taps</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">worN</span><span class="o">=</span><span class="mi">2000</span><span class="p">)</span>
<span class="n">w</span> <span class="o">=</span> <span class="n">w</span><span class="o">/</span><span class="n">numpy</span><span class="o">.</span><span class="n">pi</span>

<span class="c1"># boxcar window filter design</span>
<span class="n">w_rad</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">f_g</span><span class="o">/</span><span class="n">f_s</span> <span class="c1"># cutoff freq in rang od 0 -&gt; 2*pi</span>
<span class="c1"># designing the filter</span>
<span class="n">rect_window_51</span> <span class="o">=</span> <span class="n">w_rad</span><span class="o">/</span><span class="n">numpy</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">w_rad</span><span class="o">*</span><span class="n">idxs</span><span class="o">+</span><span class="n">eps</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">w_rad</span><span class="o">*</span><span class="n">idxs</span><span class="o">+</span><span class="n">eps</span><span class="p">)</span>
<span class="n">spectrum</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">rect_window_51</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">2000</span><span class="p">)</span>
<span class="n">mid</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">spectrum</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="c1"># shift area from pi -&gt; 2pi to -pi -&gt; 0</span>
<span class="n">spectrum</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">spectrum</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">mid</span><span class="p">):],</span> <span class="n">spectrum</span><span class="p">[:</span><span class="nb">int</span><span class="p">(</span><span class="n">mid</span><span class="p">)]])</span> 
<span class="c1"># dB maximum = 0dB</span>
<span class="n">spectrum_abs</span> <span class="o">=</span> <span class="mi">20</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">spectrum</span><span class="p">)</span><span class="o">/</span><span class="n">numpy</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">spectrum</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">())</span> 
<span class="n">freqs_fft</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">spectrum_abs</span><span class="p">))</span> <span class="c1"># freq bins, for plotting</span>

<span class="n">ax_51</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="mi">20</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">h</span><span class="p">)))</span>
<span class="n">ax_51</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">freqs_fft</span><span class="p">,</span> <span class="n">spectrum_abs</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">ax_51</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Frequenz in rad/s&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Pegel in dB&#39;</span><span class="p">,</span> <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">],</span> 
        <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Filterl√§nge 51&#39;</span><span class="p">)</span>

<span class="c1"># filter length 201</span>
<span class="c1"># -----------------</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">201</span> <span class="c1"># Size of the FIR filter</span>
<span class="n">idxs</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="o">-</span><span class="n">N</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">N</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="n">N</span><span class="p">)</span>

<span class="c1"># Remez filter design</span>
<span class="n">taps</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">remez</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">f_g</span><span class="p">,</span> <span class="n">f_g</span> <span class="o">+</span> <span class="n">trans_width</span><span class="p">,</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">f_s</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">Hz</span><span class="o">=</span><span class="n">f_s</span><span class="p">)</span>
<span class="n">w</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">freqz</span><span class="p">(</span><span class="n">taps</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">worN</span><span class="o">=</span><span class="mi">2000</span><span class="p">)</span>
<span class="n">w</span> <span class="o">=</span> <span class="n">w</span><span class="o">/</span><span class="n">numpy</span><span class="o">.</span><span class="n">pi</span>

<span class="c1"># boxcar window filter design</span>
<span class="n">w_rad</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">f_g</span><span class="o">/</span><span class="n">f_s</span> <span class="c1"># cutoff freq in rang od 0 -&gt; 2*pi</span>
<span class="c1"># designing the filter</span>
<span class="n">rect_window_201</span> <span class="o">=</span> <span class="n">w_rad</span><span class="o">/</span><span class="n">numpy</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">w_rad</span><span class="o">*</span><span class="n">idxs</span><span class="o">+</span><span class="n">eps</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">w_rad</span><span class="o">*</span><span class="n">idxs</span><span class="o">+</span><span class="n">eps</span><span class="p">)</span>
<span class="n">spectrum</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">rect_window_201</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">1000</span><span class="p">)))</span>
<span class="n">mid</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">spectrum</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="c1"># shift area from pi -&gt; 2pi to -pi -&gt; 0</span>
<span class="n">spectrum</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">spectrum</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">mid</span><span class="p">):],</span> <span class="n">spectrum</span><span class="p">[:</span><span class="nb">int</span><span class="p">(</span><span class="n">mid</span><span class="p">)]])</span> 
<span class="c1"># dB maximum = 0dB</span>
<span class="n">spectrum_abs</span> <span class="o">=</span> <span class="mi">20</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">spectrum</span><span class="p">)</span><span class="o">/</span><span class="n">numpy</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">spectrum</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">())</span> 
<span class="n">freqs_fft</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">spectrum_abs</span><span class="p">))</span> <span class="c1"># freq bins, for plotting</span>


<span class="n">ax_201</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="mi">20</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">h</span><span class="p">)))</span>
<span class="n">ax_201</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">freqs_fft</span><span class="p">,</span> <span class="n">spectrum_abs</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">ax_201</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Frequenz in rad/s&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Pegel in dB&#39;</span><span class="p">,</span> <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">],</span> 
        <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Filterl√§nge 201&#39;</span><span class="p">)</span>

<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;BspFensterRemez&quot;</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="tabbed-set docutils">
<input checked="checked" id="8bc7cd45-c21a-49c5-b2b0-61efeaac0592" name="20c3918d-064e-41cd-bb96-7025062d36d3" type="radio">
</input><label class="tabbed-label" for="8bc7cd45-c21a-49c5-b2b0-61efeaac0592">
Entwurf</label><div class="tabbed-content docutils">
<p>Fenster Entwurf</p>
<div class="figure align-default" id="id1" style="width: 75%">
<div class="cell_output docutils container">
<img alt="_images/filter_28_0.png" src="_images/filter_28_0.png" />
</div>
<p class="caption"><span class="caption-text">Beispiel eines Tiefpass-Entwurfes mit
Rechteck und Hann-Fesnster unterschiedlicher L√§nge. Grenzfrequenz =
<span class="math notranslate nohighlight">\(\Omega_g = 0.2\pi\)</span></span><a class="headerlink" href="#id1" title="Permalink to this image">¬∂</a></p>
</div>
</div>
<input id="c3253064-cd02-4a46-8853-2dcc66d4714c" name="20c3918d-064e-41cd-bb96-7025062d36d3" type="radio">
</input><label class="tabbed-label" for="c3253064-cd02-4a46-8853-2dcc66d4714c">
Remez</label><div class="tabbed-content docutils">
<p>Remez Fenster</p>
<div class="figure align-default" id="fig-bspfensterremez" style="width: 75%">
<div class="cell_output docutils container">
<img alt="_images/filter_31_0.png" src="_images/filter_31_0.png" />
</div>
<p class="caption"><span class="caption-text">Beispiel eines Tiefpass-Entwurfes mit dem
Remez-Algorithmus und der Fenster-Methode unterschiedlicher L√§nge.
Grenzfrequenz =
<span class="math notranslate nohighlight">\(\Omega_g = 0.2\pi\)</span></span><a class="headerlink" href="#fig-bspfensterremez" title="Permalink to this image">¬∂</a></p>
</div>
</div>
</div>
<div class="error admonition">
<p class="admonition-title">To Do</p>
<p>Aufzeigen der Fenstermethode f√ºr allgemeine √úbertragungsfunktionen, Design im Frequenzbereich, IFFT und dann Ausschneiden, je nach Ordnung</p>
</div>
</div>
<div class="section" id="linearphasige-filter">
<h4>Linearphasige Filter<a class="headerlink" href="#linearphasige-filter" title="Permalink to this headline">¬∂</a></h4>
<p>Linearphasigkeit ist eine interessante Eigenschaft in der
Nachrichtentechnik, da mit Ihrer Hilfe ein Signal gefiltert werden kann,
ohne weitere Phasenverzerrungen einzuf√ºhren. Weiterhin f√ºhrt die
Linearphasigkeit dazu, dass alle Frequenzanteile des Signals um einen
konstanten Betrag verz√∂gert werden. Diese Verz√∂gerung wird als
Gruppenlaufzeit bezeichnet und ist als Ableitung der Phase zur Frequenz
definiert</p>
<div class="math notranslate nohighlight" id="equation-eq-def-gruppenlaufzeit">
<span class="eqno">()<a class="headerlink" href="#equation-eq-def-gruppenlaufzeit" title="Permalink to this equation">¬∂</a></span>\[
    \tau_g(e^(j \Omega)) = - \frac{\delta arg\{H(e^(j \Omega))\}}{\delta \Omega}
\]</div>
<p>Wir haben bereits f√ºr das einfache Filter mit der Impulsantwort
<span class="math notranslate nohighlight">\(h(k) = [1\:\: 1]\)</span> festgestellt, dass es sich um einen Tiefpass mit
linearer Phase handelt. Diese Eigenschaft beruht drauf, dass die
Nullstellen dieses FIR-Systems nur auf dem Einheitskreis liegen.
Zus√§tzlich sind aber auch alle Systeme linearphasig die am Einheitskreis
gespiegelte Nullstellen aufweisen. Es muss also gelten, dass zu jeder
Nullstellen die nicht auf dem Einheitskreis liegt <span class="math notranslate nohighlight">\(z_i\)</span> eine weitere
Nullstelle mit <span class="math notranslate nohighlight">\(z_{\ell} = 1/z_i\)</span> existiert.</p>
<p>Diese Symmetrie in der Pol-Nullstellenebene f√ºhrt zu bestimmten
Eigenschaften bei den Koeffizienten. Man kann zeigen, dass 4
verschiedene M√∂glichkeiten existieren, linearphasige FIR-Filter zu
realisieren (KK98). Diese unterscheiden sich darin, ob die Ordnung
gerade oder ungerade ist und ob die Koeffizienten zur Mitte des Filters
achsen- oder punktsymmetrisch sind. Daraus ergeben sich folgende
Abh√§ngigkeiten:</p>
<div class="figure align-default" id="fig-linphasetypen">
<a class="reference internal image-reference" href="../images/psFilt/LinPhaseTypen.png"><img alt="../images/psFilt/LinPhaseTypen.png" src="../images/psFilt/LinPhaseTypen.png" style="width: 80%;" /></a>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.image</span>
<span class="kn">from</span> <span class="nn">myst_nb</span> <span class="kn">import</span> <span class="n">glue</span>

<span class="n">fig1</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="s1">&#39;../images/psFilt/LinPhaseTypI.png&#39;</span><span class="p">)</span>
<span class="n">fig2</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="s1">&#39;../images/psFilt/LinPhaseTypII.png&#39;</span><span class="p">)</span>
<span class="n">fig3</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="s1">&#39;../images/psFilt/LinPhaseTypIII.png&#39;</span><span class="p">)</span>
<span class="n">fig4</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="s1">&#39;../images/psFilt/LinPhaseTypIV.png&#39;</span><span class="p">)</span>

<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;LinPhaseTypI&quot;</span><span class="p">,</span> <span class="n">fig1</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;LinPhaseTypII&quot;</span><span class="p">,</span> <span class="n">fig2</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;LinPhaseTypIII&quot;</span><span class="p">,</span> <span class="n">fig3</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;LinPhaseTypIV&quot;</span><span class="p">,</span> <span class="n">fig4</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="text-align:right head"><p>Symmetrie</p></th>
<th class="text-align:right head"><p>Achsensymmetrisch</p></th>
<th class="text-align:right head"><p>Punktsymmetrisch</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-align:right"><p>Gerade</p></td>
<td class="text-align:right"><p><a href="#id2"><span class="problematic" id="id3">:glue:figure:`LinPhaseTypI`</span></a></p></td>
<td class="text-align:right"><p><a href="#id4"><span class="problematic" id="id5">:glue:figure:`LinPhaseTypII`</span></a></p></td>
</tr>
<tr class="row-odd"><td class="text-align:right"><p>Ungerade</p></td>
<td class="text-align:right"><p><a href="#id6"><span class="problematic" id="id7">:glue:figure:`LinPhaseTypI`</span></a></p></td>
<td class="text-align:right"><p><a href="#id8"><span class="problematic" id="id9">:glue:figure:`LinPhaseTypIV`</span></a></p></td>
</tr>
</tbody>
</table>
<p>+‚Äî‚Äî‚Äî-+‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî-+‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî-+
|          | Achsensymmetrisch          | Punktsymmetrisch           |
+:========:+:==========================:+:==========================:+
| Gerade   |                            |                            |
|          | Typ I\                     | Typ II\                    |
|          | Es gilt <span class="math notranslate nohighlight">\(h(k) = h(M-k)\)</span>\   | Es gilt <span class="math notranslate nohighlight">\(h(k) = -h(M-k)\)</span>   |
|          | mit <span class="math notranslate nohighlight">\(M\)</span> als Filterordnung  | und\                       |
|          | ![image]                   | <span class="math notranslate nohighlight">\(h(M/2) = 0\)</span>               |
|          | (psFilt/LinPhaseTypI.png)  | ![image]                   |
|          | Alle Filtercharakteristika | (psFilt/LinPhaseTypII.pdf) |
|          | m√∂glich                    | Nullstellen bei            |
|          |                            | <span class="math notranslate nohighlight">\(\Omega = 0\)</span> und           |
|          |                            | <span class="math notranslate nohighlight">\(\Omega = \pm \pi\)</span>         |
|          |                            |                            |
+‚Äî‚Äî‚Äî-+‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî-+‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî-+
| Ungerade |                            |                            |
|          | Typ III\                   | Typ IV\                    |
|          | kein Mittenkoeffizient\    | kein Mittenkoeffizient\    |
|          | Es gilt <span class="math notranslate nohighlight">\(h(k) = h(M-k)\)</span>    | Es gilt <span class="math notranslate nohighlight">\(h(k) = -h(M-k)\)</span>   |
|          | ![image](                  | ![image]                   |
|          | psFilt/LinPhaseTypIII.pdf) | (psFilt/LinPhaseTypIV.pdf) |
|          | Nullstelle bei             | Nullstelle bei             |
|          | <span class="math notranslate nohighlight">\(\Omega = \pm \pi\)</span>         | <span class="math notranslate nohighlight">\(\Omega = 0\)</span>               |
|          |                            |                            |
+‚Äî‚Äî‚Äî-+‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî-+‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî-+</p>
<p>Aus diesen vier Symmetrieanordnungen resultieren einige Eigenschaften
f√ºr die √úbertragungsfunktion. Nur mit einem Filter Typ I lassen sich
alle Grundfiltercharakteristika erzeugen. Bei den anderen Typen ergeben
sich feste Werte f√ºr bestimmte Punkte der √úbertragungsfunktion. So ist
f√ºr den Typ II immer eine Nullstelle bei <span class="math notranslate nohighlight">\(\Omega = 0\)</span> und
<span class="math notranslate nohighlight">\(\Omega = \pi\)</span>, w√§hrend der Typ III immer eine Nullstelle bei
<span class="math notranslate nohighlight">\(\Omega = \pm \pi\)</span> besitzt. Typ IV dagegen hat immer eine Nullstelle bei
<span class="math notranslate nohighlight">\(\Omega = 0\)</span></p>
<p>Dies hat nat√ºrlich Konsequenzen f√ºr den Entwurf von linearphasigen
FIR-Filtern. So sollte man nie versuchen einen Hochpass zu entwerfen und
gleichzeitig Typ II oder Typ III verwenden wollen. Das hei√üt, man sollte
darauf achten, ob das gew√ºnschte Filterverhalten, auch mit dem
Entwurfsvorgaben zusammen passen.</p>
</div>
<div class="section" id="minimalphasige-fir-filter">
<h4>Minimalphasige FIR-Filter<a class="headerlink" href="#minimalphasige-fir-filter" title="Permalink to this headline">¬∂</a></h4>
<p>Eine weitere besondere Klasse an FIR-Filtern sind sogenannte
minimalphasige Filter. Das heisst, dieses Filter realisiert eine
bestimmte Betrags√ºbertragungsfunktion mit der minimalen Phase. Es zeigt
sich dass sich dieser Filtertyp genau dann ergibt, wenn alle Nullstellen
innerhalb der Einheitskreises sind. Eine Realisierung ist also entweder
√ºber ein Ausrechnen aller Nullstellen und deren Spiegelung am
Einheitskreis m√∂glich, da sich so nur die Phase aber nicht das
Betragsverhalten √§ndert. Der Aufwand zur Zerlegung der Filter sehr hoher
Ordnung ist numerisch aufw√§ndig und nicht immer stabil durch m√∂gliche
Rundungsfehler. Eine andere Methode nutzt die besondere Eigenschaft
minimalphasiger Filter, dass es eine direkte Verkn√ºpfung zwischen dem
Betrag und der Phase gibt. Hierzu wird die sog. Hilbert-Transformation
verwendet, die aber erst in einem sp√§teren Abschnitt intensiver
eingef√ºhrt wird. An dieser Stelle soll ein Vorstellen des Design
Algorithmus gen√ºgen, um eine beliebige Betrags√ºbertragungsfunktion
(meist linearphasig, siehe Entwurfsmethoden) in einen minimalphasigen
Entwurf zu √ºberf√ºhren. Gehen wir davon aus, dass die
Betrags√ºbertragungsfunktion <span class="math notranslate nohighlight">\(|H(e^(j \Omega))|\)</span> bekannt ist. Eine Logarithmierung
dieses Spektrums ist m√∂glich, so lange keine echte Nullstelle vorhanden
ist, dies kann durch eine untere Schwelle gew√§hrleistet werden. Dieses
neue logarithmierte Spektrum wird in den Zeitbereich mit Hilfe einer
IDFT transformiert. Da es sich um eine reelle gerade Funktion handelt,
ergibt sich auch wieder eine reelle gerade Funktion. Diese
Zeitbereichsl√∂sung wird nun so ver√§ndert, dass alle negativen Zeiten
(oder positive Zeiten oberhalb von N/2, durch die Zirkulareigenschaft
der DFT ist das gleichwertig) zu Null gesetzt werden und alle anderen
Werte werden mit zwei multipliziert. Diese neue Funktion wird nun mit
der FFT erneut in den Frequenzbereich transformiert. Um die
Logarithmierung r√ºckg√§ngig zu machen wird f√ºr jeden Frequenzpunkt die
Exponenten-Funktion angewendet. Eine erneute IFFT der resultierenden
Funktion f√ºhrt auf die Filterkoeffizienten, die das minimalphasige
Filter repr√§sentieren. <code class="xref std std-numref docutils literal notranslate"><span class="pre">Abbildung</span> <span class="pre">%s</span></code>  zeigt die Ergebnisse f√ºr einen
einfaches Filter achter Ordnung bei vorgegebenem
Betrags√ºbertragungsverhalten.</p>
<div class="cell tag_hide-input tag_remove-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">signal</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span>
<span class="kn">from</span> <span class="nn">myst_nb</span> <span class="kn">import</span> <span class="n">glue</span>

<span class="n">matplotlib</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;sv.mplstyle&#39;</span><span class="p">)</span>

<span class="n">eps</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">finfo</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span><span class="o">.</span><span class="n">eps</span> <span class="c1"># for slight offset to avoid division by 0</span>

<span class="c1"># create exemplary non-recursive filter coefficients (mirrored at unit circle)</span>
<span class="n">b1</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.98</span><span class="p">]</span><span class="o">*</span><span class="mi">4</span>
<span class="n">b2</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.0</span><span class="o">/</span><span class="mf">0.98</span><span class="p">]</span><span class="o">*</span><span class="mi">4</span>
<span class="n">h</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">poly</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">b1</span><span class="p">,</span> <span class="n">b2</span><span class="p">)))</span>
<span class="n">h</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">]</span>
<span class="n">h</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">h</span><span class="p">)</span><span class="o">/</span><span class="n">numpy</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
<span class="n">W</span><span class="p">,</span> <span class="n">H</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">freqz</span><span class="p">(</span><span class="n">b</span><span class="o">=</span><span class="n">h</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">worN</span><span class="o">=</span><span class="mi">4</span><span class="o">*</span><span class="mi">1024</span><span class="p">,</span> <span class="n">whole</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="p">((</span><span class="n">ax_H</span><span class="p">,</span> <span class="n">ax_void</span><span class="p">),</span> <span class="p">(</span><span class="n">ax_lin_zeit</span><span class="p">,</span> <span class="n">ax_min_zeit</span><span class="p">),</span> 
        <span class="p">(</span><span class="n">ax_lin_phase</span><span class="p">,</span> <span class="n">ax_min_phase</span><span class="p">))</span> <span class="o">=</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

<span class="c1"># create a linear phase filter from the exististing impulse response</span>
<span class="n">log_H</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">H</span><span class="p">)</span><span class="o">+</span><span class="n">eps</span><span class="p">)</span>
<span class="n">h_c</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">ifft</span><span class="p">(</span><span class="n">log_H</span><span class="p">)</span><span class="o">.</span><span class="n">real</span>
<span class="n">h_c</span><span class="p">[</span><span class="mi">1</span> <span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">h_c</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)]</span> <span class="o">*=</span> <span class="mi">2</span>
<span class="n">h_c</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">h_c</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span> <span class="p">:</span> <span class="p">]</span> <span class="o">=</span> <span class="mi">0</span> 
<span class="n">H_min_log</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">h_c</span><span class="p">)</span>
<span class="n">H_min</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">H_min_log</span><span class="p">)</span>
<span class="n">h_min</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">ifft</span><span class="p">(</span><span class="n">H_min</span><span class="p">)</span>
<span class="n">h_min</span> <span class="o">=</span> <span class="n">h_min</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">8</span><span class="p">]</span>

<span class="n">ax_H</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="mi">20</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">H</span><span class="p">)</span><span class="o">+</span><span class="n">eps</span><span class="p">))</span>
<span class="n">ax_lin_zeit</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">use_line_collection</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ax_min_zeit</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">h_min</span><span class="p">,</span> <span class="n">use_line_collection</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ax_lin_phase</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">unwrap</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">H</span><span class="p">)))</span>
<span class="n">ax_min_phase</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">unwrap</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">H_min</span><span class="p">)))</span>

<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;MinPhasenBsp&quot;</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="figure align-default" id="fig-minphasenbsp" style="width: 75%">
<div class="cell_output docutils container">
<img alt="_images/filter_39_1.png" src="_images/filter_39_1.png" />
</div>
<p class="caption"><span class="caption-text">Entwurf eines Filters mit gegebener
Betrags√ºbertragungsfunktion. a) als linearphasiges Filter und b) als
minimalphasiges
Filter.</span><a class="headerlink" href="#fig-minphasenbsp" title="Permalink to this image">¬∂</a></p>
</div>
<p>Eine Matlab- bzw. Python-Implementierung s√§he folgenderma√üen aus.</p>
<div class="tabbed-set docutils">
<input checked="checked" id="bf203734-f54b-4a93-8c0a-679bc9588d18" name="6e9b246b-4b7a-4086-85c8-0e469157cb18" type="radio">
</input><label class="tabbed-label" for="bf203734-f54b-4a93-8c0a-679bc9588d18">
Matlab</label><div class="tabbed-content docutils">
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="w">    </span><span class="c">%v_H contains the magnitude vector of the desired filter</span><span class="w"></span>
<span class="w">    </span><span class="n">log_H</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">log</span><span class="p">(</span><span class="n">v_H</span><span class="o">+</span><span class="nb">eps</span><span class="p">);</span><span class="w"> </span><span class="c">% eps is the smallest positive number in matlab</span><span class="w"></span>
<span class="w">                          </span><span class="c">% prevents log of zero</span><span class="w"></span>
<span class="w">    </span><span class="n">h_ceps</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">real</span><span class="p">(</span><span class="nb">ifft</span><span class="p">(</span><span class="n">log_H</span><span class="p">));</span><span class="w"> </span><span class="c">% real for removing quantization error</span><span class="w"></span>
<span class="w">    </span><span class="n">h_ceps</span><span class="p">(</span><span class="mi">2</span><span class="p">:</span><span class="nb">length</span><span class="p">(</span><span class="n">h_ceps</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="n">h_ceps</span><span class="p">(</span><span class="mi">2</span><span class="p">:</span><span class="nb">length</span><span class="p">(</span><span class="n">h_ceps</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">h_ceps</span><span class="p">(</span><span class="nb">length</span><span class="p">(</span><span class="n">h_ceps</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span><span class="k">end</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="c">% Setting to zero</span><span class="w"></span>
<span class="w">    </span><span class="n">H_min_log</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">fft</span><span class="p">(</span><span class="n">h_ceps</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">H_min</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">exp</span><span class="p">(</span><span class="n">H_min_log</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="n">v_h</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">real</span><span class="p">(</span><span class="nb">ifft</span><span class="p">(</span><span class="n">H_min</span><span class="p">));</span><span class="w"></span>
</pre></div>
</div>
</div>
<input id="44a8b0db-2c13-410f-95c3-758977ec3c4e" name="6e9b246b-4b7a-4086-85c8-0e469157cb18" type="radio">
</input><label class="tabbed-label" for="44a8b0db-2c13-410f-95c3-758977ec3c4e">
Python</label><div class="tabbed-content docutils">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>    <span class="kn">import</span> <span class="nn">numpy</span>
    <span class="c1">#v_H contains the magnitude vector of the desired filter</span>
    
    <span class="n">eps</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">finfo</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span><span class="o">.</span><span class="n">eps</span> <span class="c1"># eps is the smallest positive in python </span>
    <span class="n">log_H</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">H</span><span class="p">)</span><span class="o">+</span><span class="n">eps</span><span class="p">)</span> <span class="c1"># eps prevents log of zero</span>
    <span class="n">h_c</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">ifft</span><span class="p">(</span><span class="n">log_H</span><span class="p">)</span><span class="o">.</span><span class="n">real</span> <span class="c1"># real for removing quantization error</span>
    <span class="n">h_c</span><span class="p">[</span><span class="mi">1</span> <span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">h_c</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)]</span> <span class="o">*=</span> <span class="mi">2</span>
    <span class="n">h_c</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">h_c</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span> <span class="p">:</span> <span class="p">]</span> <span class="o">=</span> <span class="mi">0</span> <span class="c1"># Setting to zero</span>
    <span class="n">H_min_log</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">h_c</span><span class="p">)</span>
    <span class="n">H_min</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">H_min_log</span><span class="p">)</span>
    <span class="n">h_min</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">ifft</span><span class="p">(</span><span class="n">H_min</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="iir-filter">
<h3>IIR-Filter<a class="headerlink" href="#iir-filter" title="Permalink to this headline">¬∂</a></h3>
<p>Im Gegensatz zu den FIR-Filtern haben IIR-Filter auch rekursive Anteile.
Die Implementierung ist durch das Stabilit√§tsproblem sehr viel
schwieriger. Gleichzeitig k√∂nnen sehr unterschiedliche Strukturen
verwendet werden, die alle unterschiedliche Eigenschaften haben.</p>
<div class="section" id="id10">
<h4>Beschreibung als Blockdiagramm<a class="headerlink" href="#id10" title="Permalink to this headline">¬∂</a></h4>
<p>Die Grundform des Blockdiagramms eines IIR-Filters ist in <code class="xref std std-numref docutils literal notranslate"><span class="pre">Abbildung</span> <span class="pre">%s</span></code>  gezeigt.</p>
<div class="figure align-default" id="fig-iir-allgemeinblock">
<a class="reference internal image-reference" href="_images/IIR_allgemeinBlock.png"><img alt="_images/IIR_allgemeinBlock.png" src="_images/IIR_allgemeinBlock.png" style="width: 80%;" /></a>
<p class="caption"><span class="caption-text">IIR-Filter Struktur in Direkt Form I.</span><a class="headerlink" href="#fig-iir-allgemeinblock" title="Permalink to this image">¬∂</a></p>
</div>
<p>Diese sehr grundlegende Struktur, die die Differenzengleichung
geradlinig umsetzt wird als Direkt Form I bezeichnet. Sie ist einfach in
Matlab oder C++ umzusetzen. Problematisch ist aber, dass bei einer
h√∂heren Ordnung <span class="math notranslate nohighlight">\(N&gt;8\)</span> numerische Probleme auftreten, da bei vielen
Filterentw√ºrfen Filterkoeffizienten herauskommen, die im Zahlenbereich
weit auseinander liegen und schlecht gleichzeitig in einem quantisierten
Datenformat repr√§sentiert werden k√∂nnen.</p>
<p>Um dies zu vermeiden, wird im allgemeinen eine Zerlegung von Filtern
h√∂herer Ordnung in Filter 2. Ordnung vorgenommen. Diese werden dann
<em>Second Order Sections</em> oder <em>Biquads</em> genannt. Eine kaskadierte
Schaltung f√ºhrt dann abschlie√üend wieder zum Originaldesign, ohne die
numerischen Schwierigkeiten zu beinhalten (siehe <code class="xref std std-numref docutils literal notranslate"><span class="pre">Abbildung</span> <span class="pre">%s</span></code> ).</p>
<div class="figure align-default" id="fig-iir-sos-zrlegung">
<a class="reference internal image-reference" href="_images/IIR_SOS_Zrlegung.png"><img alt="_images/IIR_SOS_Zrlegung.png" src="_images/IIR_SOS_Zrlegung.png" style="width: 80%;" /></a>
<p class="caption"><span class="caption-text">Beispiel einer SOS-Zerlegung eines IIR-Filters
6.Ordnung.</span><a class="headerlink" href="#fig-iir-sos-zrlegung" title="Permalink to this image">¬∂</a></p>
</div>
<p>Mathematisch l√§sst sich die Zerlegung folgenderma√üen darstellen.</p>
<div class="math notranslate nohighlight" id="equation-eq-sos-zerlegung">
<span class="eqno">()<a class="headerlink" href="#equation-eq-sos-zerlegung" title="Permalink to this equation">¬∂</a></span>\[\begin{split}
\begin{aligned}
    H(z) &amp;=&amp; \frac{b_0 + b_1 z^{-1} +  b_2 z^{-2} + \cdots +  b_{N-1} z^{-(N-1)}}
                  {1 + a_1 z^{-1} +  a_2 z^{-2} + \cdots +  a_{N-1} z^{-(N-1)}} \\
         &amp; = &amp; \frac{b_{0_1} + b_{1_1} z^{-1} +  b_{2_1} z^{-2} }{1 + a_{1_1} z^{-1} + a_{2_1} z^{-2}}
         \frac{b_{0_2} + b_{1_2} z^{-1} +  b_{2_2} z^{-2} }{1 + a_{1_2} z^{-1} + a_{2_2} z^{-2}}  \cdots
         \frac{b_{0_N} + b_{1_N} z^{-1} +  b_{2_N} z^{-2} }{1 + a_{1_N} z^{-1} + a_{2_N} z^{-2}}\end{aligned}
\end{split}\]</div>
<p>Die Zusammenf√ºhrung zweier Pole und Nullstellen sollte dabei immer so
erfolgen, dass die Pole und Nullstellen m√∂glichst dicht beieinander
liegen (siehe <code class="xref std std-numref docutils literal notranslate"><span class="pre">Abbildung</span> <span class="pre">%s</span></code> ).</p>
<div class="figure align-default" id="fig-zp2sos">
<a class="reference internal image-reference" href="_images/Zp2sos.png"><img alt="_images/Zp2sos.png" src="_images/Zp2sos.png" style="width: 80%;" /></a>
<p class="caption"><span class="caption-text">Pol-Nullstellenzuordnung eines Filters
6.Ordnung zu drei Second Order
Sections.</span><a class="headerlink" href="#fig-zp2sos" title="Permalink to this image">¬∂</a></p>
</div>
</div>
<div class="section" id="filterstrukturen-fur-sos">
<h4>Filterstrukturen f√ºr SOS<a class="headerlink" href="#filterstrukturen-fur-sos" title="Permalink to this headline">¬∂</a></h4>
<p>Die Direkt Form I ist nicht die einzige M√∂glichkeit ein IIR-Filter zu
realisieren. Um die anderen Strukturen zu verdeutlichen, konzentrieren
wir uns auf die wichtigen SOS-Filter. Eine wichtige Anforderung an
Realisierungen spielen die Anzahl der Multiplikationen und die Anzahl
der ben√∂tigten Speicherpl√§tze. Zus√§tzlich muss noch auf das numerische
Verhalten bei einer quantisierten Datendarstellung geachtet werden. Den
letzten Punkt werden wir zun√§chst nicht behandeln.</p>
<p>Eine Analyse der DF1 zeigt, dass wir f√ºnf Multiplikationen und vier
Speicherpl√§tze ben√∂tigen. Durch Umstellen des Blockdiagramms l√§sst sich
erkennen, dass es m√∂glich ist die Speicher f√ºr den Transversal- und f√ºr
den R√ºckf√ºhrungszweig zusammen zu legen (siehe <code class="xref std std-numref docutils literal notranslate"><span class="pre">Abbildung</span> <span class="pre">%s</span></code> ). Diese Umstellung ist erlaubt, da wir
zum einen den Transversal- und den R√ºckf√ºhrungszweig als zwei getrennte
Systeme auffassen k√∂nnen, zum anderen da beide Einzelsysteme LTI-Systeme
sind und somit das Vertauschen keinen Einfluss auf das
√úbertragungsverhalten hat. Die jetzt parallel liegenden Speicherelemente
k√∂nnen in einem abschlie√üenden Schritt zusammen gefasst werden. Es
ergibt sich die sogenannte Direkt-Form II mit einer minimalen Anzahl von
zwei Speicherelementen. Strukturen mit minimaler Anzahl an
Speicherelementen werden kanonisch genannt.</p>
<div class="figure align-default" id="fig-df1-to-df2">
<a class="reference internal image-reference" href="_images/DF1_to_DF2.png"><img alt="_images/DF1_to_DF2.png" src="_images/DF1_to_DF2.png" style="width: 80%;" /></a>
<p class="caption"><span class="caption-text">Umwandlung einer DF1 Struktur in die
kanonische DF2 Struktur. Die grau hinterlegten Verz√∂gerungselemente
k√∂nnen zu einem Element zusammen gefasst werden, da sie jeweils dasselbe
Signal als Eingang haben.</span><a class="headerlink" href="#fig-df1-to-df2" title="Permalink to this image">¬∂</a></p>
</div>
</div>
<div class="section" id="vom-blockdiagramm-zur-ubertragungsfunktion">
<h4>Vom Blockdiagramm zur √úbertragungsfunktion<a class="headerlink" href="#vom-blockdiagramm-zur-ubertragungsfunktion" title="Permalink to this headline">¬∂</a></h4>
<div class="admonition-to-do admonition">
<p class="admonition-title">To Do</p>
<p>Analyse des Block-Diagramms mit z-Trafo daraus folgend die √úbertragungsfunktion , ??Wie geht es anders herum??</p>
</div>
</div>
</div>
<div class="section" id="iir-filterdesign">
<h3>IIR-Filterdesign<a class="headerlink" href="#iir-filterdesign" title="Permalink to this headline">¬∂</a></h3>
<p>Um die Theorie des Entwurfs traditioneller IIR-Filter genauer zu
erl√§utern fehlen an dieser Stelle noch einige theoretische Konzepte. Der
noch folgende
<code class="xref std std-numref docutils literal notranslate"><span class="pre">Abschnitt</span> <span class="pre">%s</span></code> zeigt die notwendigen Entwurfsverfahren. Ein
erster Einblick, um bereits mit IIR-Filtern arbeiten zu k√∂nnen, wird in <code class="xref std std-numref docutils literal notranslate"><span class="pre">Abschnitt</span> <span class="pre">%s</span></code> auf Basis von Matlab gegeben.</p>
<p>Mit den bisherigen Erkenntnissen sind aber schon L√∂sungen f√ºr einige
spezielle Filter m√∂glich.</p>
<div class="section" id="notch-filter">
<h4>Notch-Filter<a class="headerlink" href="#notch-filter" title="Permalink to this headline">¬∂</a></h4>
<div class="error admonition">
<p class="admonition-title">To Do</p>
<p>Entwurf in z-Ebene durch Nullstellen auf dem Einheitskreis und Polstellen mit verringertem Radius und gleichem Winkel, Anwendungen bzw. Design Bsp.: DC Filter, NetzbrummÔ¨Ålter</p>
</div>
</div>
<div class="section" id="allpasse">
<h4>Allp√§sse<a class="headerlink" href="#allpasse" title="Permalink to this headline">¬∂</a></h4>
<div class="error admonition">
<p class="admonition-title">To Do</p>
<p>Wiederholung spezielles Pol-Nullstellendiagramm, √úberlegungen zum Entwurf im z-Bereich, Anwendungen: Spezielle Filter</p>
</div>
</div>
</div>
</div>
<div class="section" id="implementierungsaspekte">
<h2>Implementierungsaspekte<a class="headerlink" href="#implementierungsaspekte" title="Permalink to this headline">¬∂</a></h2>
<div class="section" id="id11">
<h3>FIR-Filter<a class="headerlink" href="#id11" title="Permalink to this headline">¬∂</a></h3>
<div class="section" id="schnelle-faltung-ola">
<h4>Schnelle Faltung OLA<a class="headerlink" href="#schnelle-faltung-ola" title="Permalink to this headline">¬∂</a></h4>
<p>Das Hauptproblem der FIR-Filter ist das beim Entwurf meist sehr hohe
Filterordnungen mit mehr als 100 Koeffizienten herauskommen. Dies f√ºhrt
zu einer sehr hohen Rechenleistung, wenn man versucht solche Filter
direkt durch die Faltungssumme zu realisieren. Statt dessen kann eine
FFT basierte schnelle Faltung aufgebaut werden, die eine sehr viel
recheneffizientere Version erm√∂glicht.</p>
<p>Wir hatten im Abschnitt <a class="reference internal" href="spektren.html#sec-dft-faltung"><span class="std std-numref">Abschnitt 5.3.3.2</span></a> gesehen, dass bei der Faltung mit Hilfe
der FFT unbedingt gen√ºgend Nullen angef√ºgt werden m√ºssen, um die
zirkulare Faltung zu verhindern. F√ºr den Fall, dass die beiden Folgen
eine sehr unterschiedliche L√§nge haben und dies ist der Normalfall
kommen weitere Probleme hinzu. Zum einen m√ºssen riesige Speicherbl√∂cke
angelegt werden, um die Signale zu speichern und zum anderen kann die
Berechnung erst statt finden, wenn alle Werte eingelesen sind. Da die
FFT Gr√∂√üen zus√§tzlich auch noch f√ºr die Multiplikation der beiden
Spektren gleich lang sein m√ºssen, bedeutet dies auch, dass man sehr
viele unn√∂tig angeh√§ngte Nullen des Koeffizientenvektors ebenfalls
transformieren muss.</p>
<p>Zur L√∂sung dieses Problems wird die Linearit√§t der FFT ausgenutzt. Es
ist m√∂glich das Eingangssignal in kleinere Bl√∂cke zu zerlegen, die so
lang gew√§hlt werden, dass sie zu der Anzahl der Filterkoeffizienten
passt. Diese kleineren Bl√∂cke werden mit Nullen so verl√§ngert, dass die
zirkulare Faltung verhindert wird. Nimmt man an, dass das Filter die
Ordnung <span class="math notranslate nohighlight">\(M\)</span> hat und die Zerlegung der Eingangsfolge in Bl√∂cken der L√§nge
<span class="math notranslate nohighlight">\(L\)</span> vorgenommen wird, so ergibt sich die L√§nge der Ausgangsfolge<a class="footnote-reference brackets" href="#id15" id="id12">3</a> als
<span class="math notranslate nohighlight">\(L+M\)</span>. M√∂chte man dieses Ergebnis mit Hilfe der FFT erreichen, muss also
der Eingangsblock um <span class="math notranslate nohighlight">\(M\)</span> Nullen erweitert werden (<em>Zero-Padding</em>). Die
ben√∂tigte FFT-Gr√∂√üe ergibt sich dann aus der folgenden Zweier-Potenz von
<span class="math notranslate nohighlight">\(L+M\)</span>. Das Ergebnis der Multiplikation der Spektren des Filters mit dem
der Eingangsfolge wird anschlie√üend in den Zeitbereich zur√ºck
transformiert. Dabei entsteht eine Zeitfolge der L√§nge <span class="math notranslate nohighlight">\(L+M\)</span>. Um nun f√ºr
eine in Bl√∂cken zerlegte Eingangsfolge genau das Ausgangssignal einer
direkten Faltung zu erhalten, muss nun das Ausgangssignal des n√§chsten
Blockes zu den <span class="math notranslate nohighlight">\(M\)</span> √ºberh√§ngenden Ausgangswerten hinzu addiert werden. Da
es sich hierbei um eine √úberlappung handelt, wird dieses Verfahren als
<em>Overlap-Add</em> (OLA) bezeichnet. Zur Verdeutlichung ist der gesamte
Aufbau auch noch in <code class="xref std std-numref docutils literal notranslate"><span class="pre">Abbildung</span> <span class="pre">%s</span></code> gezeigt.</p>
<div class="figure align-default" id="fig-ola-erklaerung">
<a class="reference internal image-reference" href="_images/OLA_Erklaerung.png"><img alt="_images/OLA_Erklaerung.png" src="_images/OLA_Erklaerung.png" style="width: 50%;" /></a>
<p class="caption"><span class="caption-text">Overlap-Add Verfahren am Beispiel mit <span class="math notranslate nohighlight">\(M = 3\)</span>
und <span class="math notranslate nohighlight">\(L = 13\)</span>.</span><a class="headerlink" href="#fig-ola-erklaerung" title="Permalink to this image">¬∂</a></p>
</div>
<p>Dieses Prinzip kann zus√§tzlich auch f√ºr sehr lange Impulsantworten, wie
sie bei raumakustischen Messungen vorkommen n√ºtzlich sein. In diesem
Fall wird nicht nur das Eingangssignal, sondern auch die Impulsantwort
in kleine Bl√∂cke zerlegt. Durch eine geeignete Struktur mit
Verz√∂gerungen der einzelnen Spektren l√§sst sich so eine schnelle Faltung
mit einer kurzen Latenz (Durchlaufzeit) erzeugen. Dieses Verfahren wird
Block Partitionierte OLA genannt und ist insbesondere zur Realisierung
von Faltungshallalgorithmen in kommerziellen Produkten erh√§ltlich.</p>
</div>
<div class="section" id="c-c">
<h4>C/C++<a class="headerlink" href="#c-c" title="Permalink to this headline">¬∂</a></h4>
<p>Um die Umsetzung auf programmierbaren Systemen zu erl√§utern, werden im
weiteren Verlauf haupts√§chlich Beispiele in C/C++ bzw. Matlab verwendet.</p>
<p>Eine direkte C-Implementierung der Hauptroutine des FIR-Filters ist
durch den folgendes Programm gegeben. Wir gehen davon aus, dass der
Speicher f√ºr die vergangenen Werte und die Koeffizienten ordnungsgem√§√ü
allokiert wurden. Als Eingangssignal wird ein Block von Samples
angenommen, der in In gespeichert ist.</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="n">kk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="n">kk</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">LenOfInput</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="n">kk</span><span class="o">++</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="c1">// Zuweisung des Aktuellen Samples</span>
<span class="w">        </span><span class="n">bStates</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">In</span><span class="p">[</span><span class="n">kk</span><span class="p">];</span><span class="w"></span>

<span class="w">        </span><span class="c1">// Berechnung der Summe (Zum besseren Vergleich</span>
<span class="w">        </span><span class="c1">// mit zweiter Methode, erster Koeffizient separat)</span>
<span class="w">        </span><span class="n">Out</span><span class="p">[</span><span class="n">kk</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bCoeffs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">bStates</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span><span class="w"></span>

<span class="w">        </span><span class="kt">int</span><span class="w"> </span><span class="n">nn</span><span class="p">;</span><span class="w"></span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">nn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="n">nn</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">LenOfFilter</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="n">nn</span><span class="o">++</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="n">Out</span><span class="p">[</span><span class="n">kk</span><span class="p">]</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">bCoeffs</span><span class="p">[</span><span class="n">nn</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">bStates</span><span class="p">[</span><span class="n">nn</span><span class="p">];</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">        </span><span class="c1">// Verschieben der States</span>
<span class="w">        </span><span class="c1">// muss von hinten nach vorne erfolgen, damit der Speicher</span>
<span class="w">        </span><span class="c1">// nicht ueberschrieben wird</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">nn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">LenOfFilter</span><span class="mi">-1</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="n">nn</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="n">nn</span><span class="o">--</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="n">bStates</span><span class="p">[</span><span class="n">nn</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bStates</span><span class="p">[</span><span class="n">nn</span><span class="mi">-1</span><span class="p">];</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
</pre></div>
</div>
<p>Diese Version kann durch eine sehr viel schnellere L√∂sung ersetzt
werden, wenn das Konzept des Ringspeichers eingef√ºhrt wird, den es zwar
bei spezialisierten digitalen Signal Prozessoren (DSP) gibt, der aber in
allgemeineren Rechnerarchitekturen (PC) nicht direkt vorkommt. Es ist
aber m√∂glich eine Simulation dieses Speichers aufzubauen, um so eine
effizientere Implementierung zu erm√∂glichen.</p>
<p>Das Konzept des Ringspeichers geht davon aus, dass Speicher nicht linear
sondern zirkular aufgebaut ist. Dies wird in DSPs durch eine spezielle
Modulo-Adressierung erreicht. <code class="xref std std-numref docutils literal notranslate"><span class="pre">Abbildung</span> <span class="pre">%s</span></code> zeigt, wie man sich diesem Speicher
vorstellen kann. Ein neuer Datenwert wird immer an die Adresse
geschrieben, auf die der rotierende Zeiger zeigt.</p>
<div class="figure align-default" id="fig-ringspeichermemeory">
<a class="reference internal image-reference" href="_images/RingspeicherMemeory.png"><img alt="_images/RingspeicherMemeory.png" src="_images/RingspeicherMemeory.png" style="width: 30%;" /></a>
<p class="caption"><span class="caption-text">Schematische Darstellung eines
Ringspeichers mit rotierndem
Adresszeiger</span><a class="headerlink" href="#fig-ringspeichermemeory" title="Permalink to this image">¬∂</a></p>
</div>
<p>Eine Realiserung in C w√ºrde den Sprung am √úbergang von <span class="math notranslate nohighlight">\(x(N-1)\)</span> auf
<span class="math notranslate nohighlight">\(x(0)\)</span> durch eine if-Abfrage l√∂sen. Diese Art der Implementierung
erm√∂glicht es ein FIR-Filter aufzubauen, dass ohne Speicherverschiebung
auskommt.</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">ActPosStates</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">nn</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="n">kk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="n">kk</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">LenOfInput</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="n">kk</span><span class="o">++</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="c1">// Zuweisung des Aktuellen Samples</span>
<span class="w">        </span><span class="n">bStates</span><span class="p">[</span><span class="n">ActPosStates</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">In</span><span class="p">[</span><span class="n">kk</span><span class="p">];</span><span class="w"></span>

<span class="w">        </span><span class="c1">// Zuweisung des ersten Coeffs</span>
<span class="w">        </span><span class="n">Out</span><span class="p">[</span><span class="n">kk</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bCoeffs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">bStates</span><span class="p">[</span><span class="n">ActPosStates</span><span class="p">];</span><span class="w"></span>

<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">nn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="n">nn</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">LenOfFilter</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="n">nn</span><span class="o">++</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="n">ActPosStates</span><span class="o">--</span><span class="p">;</span><span class="w"> </span><span class="c1">// States zaehlen runter</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ActPosStates</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="c1">// Falls Grenze erreicht</span>
<span class="w">                </span><span class="n">ActPosStates</span><span class="o">+=</span><span class="n">LenOfFilter</span><span class="p">;</span><span class="w">  </span><span class="c1">// Sprung ans Ende</span>
<span class="w">            </span><span class="n">Out</span><span class="p">[</span><span class="n">kk</span><span class="p">]</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">bCoeffs</span><span class="p">[</span><span class="n">nn</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">bStates</span><span class="p">[</span><span class="n">ActPosStates</span><span class="p">];</span><span class="w"> </span><span class="c1">// Summe</span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
</pre></div>
</div>
<p>Diese L√∂sung kann noch weiter optimiert werden, in dem der Sprung des
Filters vorher berechnet wird. Die if-Abfrage kann somit ebenfalls aus
der Schleife entfernt werden. Zus√§tzlich ist es noch n√ºtzlich
pre-increment zu verwenden, da dies schneller abgearbeitet werden kann
(Bartning-Script).</p>
<p>Der optimierte Code eines FIR-Filters lautet also.</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">ActPosStates</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">nn</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">Jump</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="n">kk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="n">kk</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">LenOfInput</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">kk</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="c1">// Zuweisung des Aktuellen Samples</span>
<span class="w">        </span><span class="n">bStates</span><span class="p">[</span><span class="n">ActPosStates</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">In</span><span class="p">[</span><span class="n">kk</span><span class="p">];</span><span class="w"></span>

<span class="w">        </span><span class="c1">// Zuweisung des ersten Coeffs</span>
<span class="w">        </span><span class="n">Out</span><span class="p">[</span><span class="n">kk</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>

<span class="w">        </span><span class="n">Jump</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ActPosStates</span><span class="p">;</span><span class="w"> </span><span class="c1">// Jump Point</span>

<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">nn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="n">nn</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="n">Jump</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">nn</span><span class="p">)</span><span class="w"> </span><span class="c1">//preincrement is faster</span>
<span class="w">        </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="n">Out</span><span class="p">[</span><span class="n">kk</span><span class="p">]</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">bCoeffs</span><span class="p">[</span><span class="n">nn</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">bStates</span><span class="p">[</span><span class="n">ActPosStates</span><span class="p">];</span><span class="w"> </span><span class="c1">// Summe</span>
<span class="w">            </span><span class="o">--</span><span class="n">ActPosStates</span><span class="p">;</span><span class="w"> </span><span class="c1">// States zaehlen runter</span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>

<span class="w">        </span><span class="n">ActPosStates</span><span class="o">+=</span><span class="n">LenOfFilter</span><span class="p">;</span><span class="w">  </span><span class="c1">// Sprung ans Ende</span>

<span class="w">        </span><span class="n">Jump</span><span class="o">++</span><span class="p">;</span><span class="w"></span>

<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">nn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Jump</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="n">nn</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">LenOfFilter</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">nn</span><span class="p">)</span><span class="w"> </span><span class="c1">//preincrement is faster</span>
<span class="w">        </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="n">Out</span><span class="p">[</span><span class="n">kk</span><span class="p">]</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">bCoeffs</span><span class="p">[</span><span class="n">nn</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">bStates</span><span class="p">[</span><span class="n">ActPosStates</span><span class="p">];</span><span class="w"> </span><span class="c1">// Summe</span>
<span class="w">            </span><span class="o">--</span><span class="n">ActPosStates</span><span class="p">;</span><span class="w"> </span><span class="c1">// States zaehlen runter</span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>

<span class="w">        </span><span class="n">ActPosStates</span><span class="o">++</span><span class="p">;</span><span class="w"></span>

<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ActPosStates</span><span class="o">==</span><span class="n">LenOfFilter</span><span class="p">)</span><span class="w"></span>
<span class="w">            </span><span class="n">ActPosStates</span><span class="w"> </span><span class="o">-=</span><span class="w"> </span><span class="n">LenOfFilter</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="p">}</span><span class="w"></span>
</pre></div>
</div>
<p>Welche der beiden letzten Versionen schneller ist, h√§ngt vom
Prozessortyp, von der Filterl√§nge und vom Compiler ab. Es hilft also
beim Entwickeln von zeitkritischen Routinen immer nur der wirkliche
Benchmark-Test unter realistischen Bedingungen.</p>
</div>
<div class="section" id="vektorielle-schreibweise-und-implementierung-matlab">
<h4>Vektorielle Schreibweise und Implementierung (Matlab)<a class="headerlink" href="#vektorielle-schreibweise-und-implementierung-matlab" title="Permalink to this headline">¬∂</a></h4>
<p>H√§ufig ist es n√ºtzlich, Signale als Vektoren aufzufassen, da durch die
Vektor und Matrix-Schreibweise bestimmte Rechenregeln und Eigenschaften
der linearen Algebra direkt f√ºr Signale nutzbar sind. Als Schreibweise
werden meist fettgedruckte Buchstaben verwendet. Typischerweise werden
Zeitsignale als Spaltenvektoren eingef√ºhrt.</p>
<p>Beispiel eines Vektors mit vier vergangenen Zeitwerten</p>
<div class="math notranslate nohighlight" id="equation-eq-defspaltenvektor">
<span class="eqno">()<a class="headerlink" href="#equation-eq-defspaltenvektor" title="Permalink to this equation">¬∂</a></span>\[\begin{split}
    \mathbf{x}(k) = \left(%
\begin{array}{c}
  x(k) \\
  x(k-1) \\
  x(k-2) \\
  x(k-3) \\
\end{array}%
\right)
\end{split}\]</div>
<p>F√ºhren wir nun in der selben Art einen Vektor f√ºr die Koeffizienten ein</p>
<div class="math notranslate nohighlight" id="equation-eq-def-koeffvektor">
<span class="eqno">()<a class="headerlink" href="#equation-eq-def-koeffvektor" title="Permalink to this equation">¬∂</a></span>\[\begin{split}
    \mathbf{b} = \left(%
\begin{array}{c}
  b_0 \\
  b_1 \\
  b_2 \\
  b_3 \\
\end{array}%
\right),
\end{split}\]</div>
<p>so kann der Ausgang <span class="math notranslate nohighlight">\(y(k)\)</span> durch das Skalarprodukt dieser
beiden Vektoren ausgedr√ºckt werden.</p>
<div class="math notranslate nohighlight" id="equation-eq-fir-vek">
<span class="eqno">()<a class="headerlink" href="#equation-eq-fir-vek" title="Permalink to this equation">¬∂</a></span>\[
    y(k) = \mathbf{x}^T(k) \mathbf{(b)},
\]</div>
<p>wobei <span class="math notranslate nohighlight">\(^T\)</span>, die Transponierung
bezeichnet. F√ºr komplexe Signale w√ºrde man statt dessen die konjugiert
komplexe Transponierung verwenden, die als hermitescher Operator <span class="math notranslate nohighlight">\(^H\)</span>
bekannt ist.</p>
<p>Da Matlab vektoriell orientiert ist, l√§sst sich ein FIR-Filter besonders
effizient implementieren, wenn man nicht auf die internen
Filter-Routinen zur√ºckgreifen m√∂chte.</p>
<div class="tabbed-set docutils">
<input checked="checked" id="45f03779-546b-4e50-84b8-11d4d4123517" name="eba358ea-76ee-4977-b29e-b8a42f37da69" type="radio">
</input><label class="tabbed-label" for="45f03779-546b-4e50-84b8-11d4d4123517">
Matlab</label><div class="tabbed-content docutils">
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="w">    </span><span class="n">v_states</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">zeros</span><span class="p">(</span><span class="n">LengthOfFilter</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">kk</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span><span class="nb">length</span><span class="p">(</span><span class="n">InputVektor</span><span class="p">)</span><span class="w">         </span><span class="c">% Annahme Daten stehen in InputVektor</span><span class="w"></span>
<span class="w">      </span><span class="n">v_states</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">InputVektor</span><span class="p">(</span><span class="n">kk</span><span class="p">);</span><span class="w">       </span><span class="c">% Neuen Datenwert in State speichern</span><span class="w"></span>
<span class="w">      </span><span class="n">out</span><span class="p">(</span><span class="n">kk</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">v_Coeffs</span><span class="p">.</span><span class="o">&#39;</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">v_states</span><span class="p">;</span><span class="w">     </span><span class="c">% Skalarprodukt berechnen</span><span class="w"></span>
<span class="w">      </span><span class="n">v_states</span><span class="p">(</span><span class="mi">2</span><span class="p">:</span><span class="k">end</span><span class="p">)</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">v_states</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="k">end</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span><span class="w"> </span><span class="c">% State Vector verschieben</span><span class="w"></span>
<span class="w">    </span><span class="k">end</span><span class="w"></span>
</pre></div>
</div>
</div>
<input id="afaf82cf-dc15-47ee-9e35-1d8f22e11939" name="eba358ea-76ee-4977-b29e-b8a42f37da69" type="radio">
</input><label class="tabbed-label" for="afaf82cf-dc15-47ee-9e35-1d8f22e11939">
Python</label><div class="tabbed-content docutils">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>    <span class="kn">import</span> <span class="nn">numpy</span>
    <span class="c1"># Example values</span>
    <span class="n">InputVektor</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
    <span class="n">v_Coeffs</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
    <span class="n">InputVektor</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">InputVektor</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">v_Coeffs</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)))</span>

    <span class="n">v_states</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">v_Coeffs</span><span class="p">)))</span>

    <span class="n">out</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">InputVektor</span><span class="p">:</span>        <span class="c1"># Annahme Daten stehen in InputVektor</span>
        <span class="n">v_states</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">val</span>       <span class="c1"># Neuen Datenwert in State speichern</span>
        <span class="n">out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">v_Coeffs</span><span class="p">,</span> <span class="n">v_states</span><span class="p">))</span>     <span class="c1"># Skalarprodukt berechnen</span>
        <span class="n">v_states</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">=</span> <span class="n">v_states</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="nb">len</span><span class="p">(</span><span class="n">v_states</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="c1"># State Vector verschieben</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="id13">
<h3>IIR-Filter<a class="headerlink" href="#id13" title="Permalink to this headline">¬∂</a></h3>
<div class="section" id="sec-iir-filterdesign">
<span id="id14"></span><h4>IIR-Filterdesign<a class="headerlink" href="#sec-iir-filterdesign" title="Permalink to this headline">¬∂</a></h4>
<p>Der Entwurf von IIR-Filtern erfolgt historisch bedingt etwas anders.
Rekursive Filter sind sehr viel enger mit analogen Filtern verwandt.
Eine M√∂glichkeit des IIR-Filterentwurfs besteht deshalb darin, einen
analogen Entwurf durchzuf√ºhren und das Resultat in den Digitalbereich zu
transformieren. Da bisher noch keine analogen Filter genauer besprochen
wurden, soll an dieser Stelle nur Beispielhaft typische L√∂sungen und
ihre St√§rken und Schw√§chen gezeigt werden.</p>
</div>
<div class="section" id="butterworth-filter">
<span id="sec-butterworth-filter"></span><h4>Butterworth-Filter<a class="headerlink" href="#butterworth-filter" title="Permalink to this headline">¬∂</a></h4>
<p>Ziel des Butterworth-Entwurfs ist einen m√∂glichst flachen
Durchlassbereich zu erhalten. Dies wird im analogen Entwurf durch
Nutzung einer Potenzfunktion gew√§hrleistet (siehe Abschnitt
Analogentwurf) Aus diesem Grund wird dieser Entwurf auch als <em>Maximum
Flat Design</em> bezeichnet. In Matlab stehen die Befehle <code class="docutils literal notranslate"><span class="pre">butter</span></code> und
<code class="docutils literal notranslate"><span class="pre">buttord</span></code> f√ºr das Design zu Verf√ºgung, wobei mit buttord zu einem
definierten Design die ben√∂tigten Entwurfsparameter bestimmt werden und
butter der eigentliche Entwurf ist. Angegeben werden meist zwei
Arbeitspunkte des Filters, zum einen bis zu welcher Frequenz der
Durchlassbereich definiert ist und welche Abstand von der 0dB Linie noch
als Durchlass gilt. Zum anderen ab welcher Frequenz eine bestimmte
D√§mpfung erreicht werden muss (Sperrbereich). Da die Grenzfrequenz des
Butterworth-Filter durch die <span class="math notranslate nohighlight">\(-3\)</span>dB Grenze definiert, wird in Butterord
eine Anpassung an diese Frequenz vorgenommen.</p>
<p>Beispiel einer Filterspezifikation f√ºr normierte Frequenzen:<br />
Durchlassbereich bis <span class="math notranslate nohighlight">\(0.1\pi\)</span> und maximale D√§mpfung von <span class="math notranslate nohighlight">\(0.2\)</span>dB.<br />
Sperrbereich ab <span class="math notranslate nohighlight">\(02\pi\)</span> und minimale D√§mpfung von <span class="math notranslate nohighlight">\(30dB\)</span>.<br />
Der dazugeh√∂rige Code sieht dann wie folgt aus:</p>
<div class="tabbed-set docutils">
<input checked="checked" id="ed2298c3-ba53-45e1-981e-0696b16d97fd" name="890e20b6-b8b6-484a-93b7-639fe9aa72fe" type="radio">
</input><label class="tabbed-label" for="ed2298c3-ba53-45e1-981e-0696b16d97fd">
Matlab</label><div class="tabbed-content docutils">
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="w">    </span><span class="n">Pass_freq</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">0.1</span><span class="p">;</span><span class="w"> </span><span class="c">% Matlab uses normalized frequencies from 0..2</span><span class="w"></span>
<span class="w">    </span><span class="n">Pass_dB</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">0.2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">Stop_freq</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">0.2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">Stop_dB</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">30</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="p">[</span><span class="n">N</span><span class="p">,</span><span class="n">f_g</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">buttord</span><span class="p">(</span><span class="n">Pass_freq</span><span class="p">,</span><span class="n">Stop_freq</span><span class="p">,</span><span class="n">Pass_dB</span><span class="p">,</span><span class="n">Stop_dB</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="c">% Result is 7th Order and f_g = 0.1247</span><span class="w"></span>
<span class="w">    </span><span class="p">[</span><span class="n">b</span><span class="p">,</span><span class="n">a</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">butter</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">f_g</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
</div>
<input id="20ed9c8f-35b5-4c88-8336-25d74594175d" name="890e20b6-b8b6-484a-93b7-639fe9aa72fe" type="radio">
</input><label class="tabbed-label" for="20ed9c8f-35b5-4c88-8336-25d74594175d">
Python</label><div class="tabbed-content docutils">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>    <span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">signal</span>
    <span class="n">Pass_freq</span> <span class="o">=</span> <span class="mf">0.1</span>
    <span class="n">Pass_dB</span> <span class="o">=</span> <span class="mf">0.2</span>
    <span class="n">Stop_freq</span> <span class="o">=</span> <span class="mf">0.2</span>
    <span class="n">Stop_dB</span> <span class="o">=</span> <span class="mi">30</span>
    
    <span class="n">order</span><span class="p">,</span> <span class="n">wn</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">buttord</span><span class="p">(</span><span class="n">wp</span><span class="o">=</span><span class="n">Pass_freq</span><span class="p">,</span> <span class="n">ws</span><span class="o">=</span><span class="n">Stop_freq</span><span class="p">,</span> <span class="n">gpass</span><span class="o">=</span><span class="n">Pass_dB</span><span class="p">,</span> <span class="n">gstop</span><span class="o">=</span><span class="n">Stop_dB</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">f_s</span><span class="p">)</span>
    <span class="p">[</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">]</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">butter</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="n">order</span><span class="p">,</span> <span class="n">Wn</span><span class="o">=</span><span class="n">Pass_freq</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="s1">&#39;ba&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="tschebyscheff-i-filter">
<h4>Tschebyscheff-I-Filter<a class="headerlink" href="#tschebyscheff-i-filter" title="Permalink to this headline">¬∂</a></h4>
<p>Im Gegensatz zum Butterworth-Filter ist das Ziel des Tschebyscheff-I
Filters im Durchlassbereich die maximal zul√§ssige Durchlassd√§mpfung
nicht zu √ºberschreiten. Gleichzeitig wird aber erlaubt, diesen Bereich
bis zur Grenzfrequenz auszunutzen. Die Tschebyscheff-Optimierung hat
also immer zum Ziel den Maximalen Fehler zu minimieren. Der Entwurf wird
auch als Equiripple-Design bezeichnet. Dies f√ºhrt zu einem Entwurf mit
geringerer Ordnung. Die zugeh√∂rigen Matlab-Befehle lauten <code class="docutils literal notranslate"><span class="pre">cheb1ord</span></code> und
<code class="docutils literal notranslate"><span class="pre">cheby1</span></code>. F√ºr das Design-Beispiel ergibt sich der folgende Code.</p>
<div class="tabbed-set docutils">
<input checked="checked" id="46248698-6518-4c8d-aa43-e5b566ee256b" name="bee5166e-1a33-4750-b9b3-4e30f022bdaa" type="radio">
</input><label class="tabbed-label" for="46248698-6518-4c8d-aa43-e5b566ee256b">
Matlab</label><div class="tabbed-content docutils">
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="w">    </span><span class="n">Pass_freq</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">0.1</span><span class="p">;</span><span class="w"> </span><span class="c">% Matlab uses normalized frequencies from 0..2</span><span class="w"></span>
<span class="w">    </span><span class="n">Pass_dB</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">0.2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">Stop_freq</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">0.2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">Stop_dB</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">30</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="p">[</span><span class="n">N</span><span class="p">,</span><span class="n">f_g</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">cheb1ord</span><span class="p">(</span><span class="n">Pass_freq</span><span class="p">,</span><span class="n">Stop_freq</span><span class="p">,</span><span class="n">Pass_dB</span><span class="p">,</span><span class="n">Stop_dB</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="c">% Results in a 5th Order filter with f_g = 0.1</span><span class="w"></span>
<span class="w">    </span><span class="p">[</span><span class="n">b</span><span class="p">,</span><span class="n">a</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">cheby1</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">Pass_dB</span><span class="p">,</span><span class="n">f_g</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
</div>
<input id="93aadc95-9af5-4787-ac62-a0045d57b1a8" name="bee5166e-1a33-4750-b9b3-4e30f022bdaa" type="radio">
</input><label class="tabbed-label" for="93aadc95-9af5-4787-ac62-a0045d57b1a8">
Python</label><div class="tabbed-content docutils">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>    <span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">signal</span>
    <span class="n">Pass_freq</span> <span class="o">=</span> <span class="mf">0.1</span>
    <span class="n">Pass_dB</span> <span class="o">=</span> <span class="mf">0.2</span>
    <span class="n">Stop_freq</span> <span class="o">=</span> <span class="mf">0.2</span>
    <span class="n">Stop_dB</span> <span class="o">=</span> <span class="mi">30</span>
    <span class="n">order</span><span class="p">,</span> <span class="n">wn</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">cheb1ord</span><span class="p">(</span><span class="n">wp</span><span class="o">=</span><span class="n">Pass_freq</span><span class="p">,</span> <span class="n">ws</span><span class="o">=</span><span class="n">Stop_freq</span><span class="p">,</span> <span class="n">gpass</span><span class="o">=</span><span class="n">Pass_dB</span><span class="p">,</span> <span class="n">gstop</span><span class="o">=</span><span class="n">Stop_dB</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">f_s</span><span class="p">)</span>
    <span class="p">[</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">]</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">cheby1</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="n">order</span><span class="p">,</span> <span class="n">rp</span><span class="o">=</span><span class="n">Pass_dB</span><span class="p">,</span> <span class="n">Wn</span><span class="o">=</span><span class="n">Pass_freq</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="s1">&#39;ba&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="tschebyscheff-ii-filter">
<h4>Tschebyscheff-II-Filter<a class="headerlink" href="#tschebyscheff-ii-filter" title="Permalink to this headline">¬∂</a></h4>
<p>Das Tschebyscheff-II-Filter ist der Inverse Entwurf zum Typ I. Das Ziel
ist also ein flacher Durchlassbereich und ein oszilierender
Sperrbereich. Der dazugeh√∂rige Matlab-Code sieht folgenderma√üen aus.</p>
<div class="tabbed-set docutils">
<input checked="checked" id="913efae9-0adb-4b32-b2a2-c149afc7dc07" name="f9eaf30f-2a35-4586-a1fe-f391936101b4" type="radio">
</input><label class="tabbed-label" for="913efae9-0adb-4b32-b2a2-c149afc7dc07">
Matlab</label><div class="tabbed-content docutils">
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="w">    </span><span class="n">Pass_freq</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">0.1</span><span class="p">;</span><span class="w"> </span><span class="c">% Matlab uses normalized frequencies from 0..2</span><span class="w"></span>
<span class="w">    </span><span class="n">Pass_dB</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">0.2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">Stop_freq</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">0.2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">Stop_dB</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">30</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="p">[</span><span class="n">N</span><span class="p">,</span><span class="n">f_g</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">cheb2ord</span><span class="p">(</span><span class="n">Pass_freq</span><span class="p">,</span><span class="n">Stop_freq</span><span class="p">,</span><span class="n">Pass_dB</span><span class="p">,</span><span class="n">Stop_dB</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="c">% Results in a 5th Order filter with f_g = 0.2</span><span class="w"></span>
<span class="w">    </span><span class="p">[</span><span class="n">b</span><span class="p">,</span><span class="n">a</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">cheby2</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">Stop_dB</span><span class="p">,</span><span class="n">f_g</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
</div>
<input id="f2242325-54b8-4b0c-af70-3396b6c09f12" name="f9eaf30f-2a35-4586-a1fe-f391936101b4" type="radio">
</input><label class="tabbed-label" for="f2242325-54b8-4b0c-af70-3396b6c09f12">
Python</label><div class="tabbed-content docutils">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>    <span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">signal</span>
    <span class="n">Pass_freq</span> <span class="o">=</span> <span class="mf">0.1</span>
    <span class="n">Pass_dB</span> <span class="o">=</span> <span class="mf">0.2</span>
    <span class="n">Stop_freq</span> <span class="o">=</span> <span class="mf">0.2</span>
    <span class="n">Stop_dB</span> <span class="o">=</span> <span class="mi">30</span>
    <span class="n">order</span><span class="p">,</span> <span class="n">wn</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">cheb2ord</span><span class="p">(</span><span class="n">wp</span><span class="o">=</span><span class="n">Pass_freq</span><span class="p">,</span> <span class="n">ws</span><span class="o">=</span><span class="n">Stop_freq</span><span class="p">,</span> <span class="n">gpass</span><span class="o">=</span><span class="n">Pass_dB</span><span class="p">,</span> <span class="n">gstop</span><span class="o">=</span><span class="n">Stop_dB</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">f_s</span><span class="p">)</span>
    <span class="p">[</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">]</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">cheby2</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="n">order</span><span class="p">,</span> <span class="n">rs</span><span class="o">=</span><span class="n">Stop_dB</span><span class="p">,</span> <span class="n">Wn</span><span class="o">=</span><span class="n">Stop_freq</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="s1">&#39;ba&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="cauer-filter">
<h4>Cauer-Filter<a class="headerlink" href="#cauer-filter" title="Permalink to this headline">¬∂</a></h4>
<p>Das Cauer-Filter auch als Ellpitisches-Filter bezeichnet, definiert
einen Equiripple-Entwurf im Durchlass- und Sperrbereich. Dies f√ºhrt zu
einer weiteren Reduzierung der Ordnung. Der Entwurf sieht wie
folgt aus.</p>
<div class="tabbed-set docutils">
<input checked="checked" id="6ca95357-8c3b-42db-86d3-aa77618ad56f" name="246cdef9-fb30-4edd-b381-c63ca347d2f6" type="radio">
</input><label class="tabbed-label" for="6ca95357-8c3b-42db-86d3-aa77618ad56f">
Matlab</label><div class="tabbed-content docutils">
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="w">    </span><span class="n">Pass_freq</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">0.1</span><span class="p">;</span><span class="w"> </span><span class="c">% Matlab uses normalized frequencies from 0..2</span><span class="w"></span>
<span class="w">    </span><span class="n">Pass_dB</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">0.2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">Stop_freq</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">0.2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">Stop_dB</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">30</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="p">[</span><span class="n">N</span><span class="p">,</span><span class="n">f_g</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">ellipord</span><span class="p">(</span><span class="n">Pass_freq</span><span class="p">,</span><span class="n">Stop_freq</span><span class="p">,</span><span class="n">Pass_dB</span><span class="p">,</span><span class="n">Stop_dB</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="c">% Results in a 4th Order filter with f_g = 0.1</span><span class="w"></span>
<span class="w">    </span><span class="p">[</span><span class="n">b</span><span class="p">,</span><span class="n">a</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">ellip</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">Pass_dB</span><span class="p">,</span><span class="n">Stop_dB</span><span class="p">,</span><span class="n">f_g</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
</div>
<input id="cb7aecea-dcea-42c8-886a-bb9a1c79c1be" name="246cdef9-fb30-4edd-b381-c63ca347d2f6" type="radio">
</input><label class="tabbed-label" for="cb7aecea-dcea-42c8-886a-bb9a1c79c1be">
Python</label><div class="tabbed-content docutils">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>    <span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">signal</span>
    <span class="n">Pass_freq</span> <span class="o">=</span> <span class="mf">0.1</span>
    <span class="n">Pass_dB</span> <span class="o">=</span> <span class="mf">0.2</span>
    <span class="n">Stop_freq</span> <span class="o">=</span> <span class="mf">0.2</span>
    <span class="n">Stop_dB</span> <span class="o">=</span> <span class="mi">30</span>
    <span class="n">order</span><span class="p">,</span> <span class="n">wn</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">ellipord</span><span class="p">(</span><span class="n">wp</span><span class="o">=</span><span class="n">Pass_freq</span><span class="p">,</span> <span class="n">ws</span><span class="o">=</span><span class="n">Stop_freq</span><span class="p">,</span> <span class="n">gpass</span><span class="o">=</span><span class="n">Pass_dB</span><span class="p">,</span> <span class="n">gstop</span><span class="o">=</span><span class="n">Stop_dB</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">f_s</span><span class="p">)</span>
    <span class="p">[</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">]</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">ellip</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="n">order</span><span class="p">,</span> <span class="n">rp</span><span class="o">=</span><span class="n">Pass_dB</span><span class="p">,</span> <span class="n">rs</span><span class="o">=</span><span class="n">Stop_dB</span><span class="p">,</span> <span class="n">Wn</span><span class="o">=</span><span class="n">Pass_freq</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="s1">&#39;ba&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="vor-und-nachteile-der-unterschiedlichen-entwurfsverfahren">
<h4>Vor- und Nachteile der unterschiedlichen Entwurfsverfahren<a class="headerlink" href="#vor-und-nachteile-der-unterschiedlichen-entwurfsverfahren" title="Permalink to this headline">¬∂</a></h4>
<p>Die Wahl der Entwurfsmethode beruht im gro√üen Ma√üe auf den gegebenen
Randparamtern. Um eine geeignete Wahl zu treffen ist es aber notwendig
die St√§rken und Schw√§chen der einzelnen Verfahren zu beleuchten. Aus den
vorherigen Abschnitten ist bereits ersichtlich, dass die Ordnung der
Filter und somit die Anzahl der ben√∂tigten Filterkoeffizienten vom
Entwurf abh√§ngt. Der Butterworth-Entwurf ben√∂tigt immer die gr√∂√üte
Ordnung, w√§hrend das Cauer-Filter immer mit der geringsten Ordnung
auskommt. Gleichzeitig sind die resultierenden Koeffizienten auch f√ºr
eine SOS-L√∂sung numerisch am fragilsten und ben√∂tigen eine hohe
Quantisierung.</p>
<p>Um die weiteren Vor- und Nachteile zu verdeutlichen sind in <code class="xref std std-numref docutils literal notranslate"><span class="pre">Abbildung</span> <span class="pre">%s</span></code>  die verschiedenen Entwurfsverfahren am
oben verwendeten Beispiel gezeigt.</p>
<div class="cell tag_hide-input tag_remove-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">signal</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span>
<span class="kn">from</span> <span class="nn">myst_nb</span> <span class="kn">import</span> <span class="n">glue</span>

<span class="n">matplotlib</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;sv.mplstyle&#39;</span><span class="p">)</span>


<span class="n">fig</span><span class="p">,</span> <span class="p">((</span><span class="n">ax_durch_b_c1</span><span class="p">,</span> <span class="n">ax_durch_c2_c</span><span class="p">),</span> <span class="p">(</span><span class="n">ax_sperr_b_c1</span><span class="p">,</span> <span class="n">ax_sperr_c2_c</span><span class="p">),</span> 
        <span class="p">(</span><span class="n">ax_phase_b_c1</span><span class="p">,</span> <span class="n">ax_phase_c2_c</span><span class="p">))</span> <span class="o">=</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

<span class="n">f_s</span> <span class="o">=</span> <span class="mi">48000</span> 

<span class="c1"># filter design parameters</span>
<span class="n">order</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">Pass_freq</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="n">Pass_dB</span> <span class="o">=</span> <span class="mf">0.2</span>
<span class="n">Stop_freq</span> <span class="o">=</span> <span class="mf">0.2</span>
<span class="n">Stop_dB</span> <span class="o">=</span> <span class="mi">30</span>

<span class="c1"># Filter design process: </span>
<span class="c1">#   1. find necessary order for the desired parameters</span>
<span class="c1">#   2. use corresponding filter design function, </span>
<span class="c1">#        giving the necessary parameter (not always all of them)</span>
<span class="c1">#   3. calculate the transfer function using freqz on the filter coefficients</span>
<span class="c1"># displaying:</span>
<span class="c1">#   4. show amplitude of transfer function in Pass stop and transition, </span>
<span class="c1">#       using fitting zooms</span>
<span class="c1">#   5. show phase. numpy.unwrap for smooth display i.e. no jumps from 2*pi to 0</span>

<span class="c1"># Butterworth vs Chebychev-1 filter design</span>
<span class="c1"># ----------------------------------------</span>

<span class="c1"># Butterworth:</span>
<span class="n">order</span><span class="p">,</span> <span class="n">wn</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">buttord</span><span class="p">(</span><span class="n">wp</span><span class="o">=</span><span class="n">Pass_freq</span><span class="p">,</span> <span class="n">ws</span><span class="o">=</span><span class="n">Stop_freq</span><span class="p">,</span> 
        <span class="n">gpass</span><span class="o">=</span><span class="n">Pass_dB</span><span class="p">,</span> <span class="n">gstop</span><span class="o">=</span><span class="n">Stop_dB</span><span class="p">)</span>
<span class="p">[</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">]</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">butter</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="n">order</span><span class="p">,</span> <span class="n">Wn</span><span class="o">=</span><span class="n">Pass_freq</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="s1">&#39;ba&#39;</span><span class="p">)</span>
<span class="p">[</span><span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">]</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">freqz</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>
<span class="n">w</span> <span class="o">=</span> <span class="n">w</span><span class="o">/</span><span class="n">numpy</span><span class="o">.</span><span class="n">pi</span>

<span class="n">ax_durch_b_c1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="mi">20</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">h</span><span class="p">)))</span>
<span class="n">ax_durch_b_c1</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Frequenz in rad/s&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Pegel in dB&#39;</span><span class="p">,</span> 
        <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">],</span> <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;a) Durchlassbereich&#39;</span><span class="p">)</span>

<span class="n">ax_sperr_b_c1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="mi">20</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">h</span><span class="p">)))</span>
<span class="n">ax_sperr_b_c1</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Frequenz in rad/s&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Pegel in dB&#39;</span><span class="p">,</span> 
        <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">80</span><span class="p">,</span> <span class="o">-</span><span class="mi">20</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;b) Sperrbereich&#39;</span><span class="p">)</span>
<span class="n">ax_phase_b_c1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">unwrap</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">h</span><span class="p">)))</span>
<span class="n">ax_phase_b_c1</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Frequenz in rad/s&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Phase in rad&#39;</span><span class="p">,</span> 
        <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;c) Phase&#39;</span><span class="p">)</span>

<span class="c1"># Cheby1</span>
<span class="n">order</span><span class="p">,</span> <span class="n">wn</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">cheb1ord</span><span class="p">(</span><span class="n">wp</span><span class="o">=</span><span class="n">Pass_freq</span><span class="p">,</span> <span class="n">ws</span><span class="o">=</span><span class="n">Stop_freq</span><span class="p">,</span> 
        <span class="n">gpass</span><span class="o">=</span><span class="n">Pass_dB</span><span class="p">,</span> <span class="n">gstop</span><span class="o">=</span><span class="n">Stop_dB</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">f_s</span><span class="p">)</span>
<span class="p">[</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">]</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">cheby1</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="n">order</span><span class="p">,</span> <span class="n">rp</span><span class="o">=</span><span class="n">Pass_dB</span><span class="p">,</span> <span class="n">Wn</span><span class="o">=</span><span class="n">Pass_freq</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="s1">&#39;ba&#39;</span><span class="p">)</span>
<span class="p">[</span><span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">]</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">freqz</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>
<span class="n">w</span> <span class="o">=</span> <span class="n">w</span><span class="o">/</span><span class="n">numpy</span><span class="o">.</span><span class="n">pi</span>

<span class="n">ax_durch_b_c1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="mi">20</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">h</span><span class="p">)),</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">ax_sperr_b_c1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="mi">20</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">h</span><span class="p">)),</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">ax_phase_b_c1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">unwrap</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">h</span><span class="p">)),</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>

<span class="c1"># Chebychev-2 vs Cauer filter design</span>
<span class="c1"># ----------------------------------</span>

<span class="c1"># Cheby2</span>
<span class="n">order</span><span class="p">,</span> <span class="n">wn</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">cheb2ord</span><span class="p">(</span><span class="n">wp</span><span class="o">=</span><span class="n">Pass_freq</span><span class="p">,</span> <span class="n">ws</span><span class="o">=</span><span class="n">Stop_freq</span><span class="p">,</span> 
        <span class="n">gpass</span><span class="o">=</span><span class="n">Pass_dB</span><span class="p">,</span> <span class="n">gstop</span><span class="o">=</span><span class="n">Stop_dB</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">f_s</span><span class="p">)</span>
<span class="p">[</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">]</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">cheby2</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="n">order</span><span class="p">,</span> <span class="n">rs</span><span class="o">=</span><span class="n">Stop_dB</span><span class="p">,</span> <span class="n">Wn</span><span class="o">=</span><span class="n">Stop_freq</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="s1">&#39;ba&#39;</span><span class="p">)</span>
<span class="p">[</span><span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">]</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">freqz</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>
<span class="n">w</span> <span class="o">=</span> <span class="n">w</span><span class="o">/</span><span class="n">numpy</span><span class="o">.</span><span class="n">pi</span>

<span class="n">ax_durch_c2_c</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="mi">20</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">h</span><span class="p">)))</span>
<span class="n">ax_durch_c2_c</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Frequenz in rad/s&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Pegel in dB&#39;</span><span class="p">,</span> 
        <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">],</span> <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;d) Durchlassbereich&#39;</span><span class="p">)</span>
<span class="n">ax_sperr_c2_c</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="mi">20</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">h</span><span class="p">)))</span>
<span class="n">ax_sperr_c2_c</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Frequenz in rad/s&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Pegel in dB&#39;</span><span class="p">,</span> 
        <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">80</span><span class="p">,</span> <span class="o">-</span><span class="mi">20</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;e) Sperrbereich&#39;</span><span class="p">)</span>
<span class="n">ax_phase_c2_c</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">unwrap</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">h</span><span class="p">)))</span>
<span class="n">ax_phase_c2_c</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Frequenz in rad/s&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Phase in rad&#39;</span><span class="p">,</span> 
        <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;f) Phase&#39;</span><span class="p">)</span>

<span class="c1"># Cauer</span>
<span class="n">order</span><span class="p">,</span> <span class="n">wn</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">ellipord</span><span class="p">(</span><span class="n">wp</span><span class="o">=</span><span class="n">Pass_freq</span><span class="p">,</span> <span class="n">ws</span><span class="o">=</span><span class="n">Stop_freq</span><span class="p">,</span> 
        <span class="n">gpass</span><span class="o">=</span><span class="n">Pass_dB</span><span class="p">,</span> <span class="n">gstop</span><span class="o">=</span><span class="n">Stop_dB</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="n">f_s</span><span class="p">)</span>
<span class="p">[</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">]</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">ellip</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="n">order</span><span class="p">,</span> <span class="n">rp</span><span class="o">=</span><span class="n">Pass_dB</span><span class="p">,</span> <span class="n">rs</span><span class="o">=</span><span class="n">Stop_dB</span><span class="p">,</span> 
        <span class="n">Wn</span><span class="o">=</span><span class="n">Pass_freq</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="s1">&#39;ba&#39;</span><span class="p">)</span>
<span class="p">[</span><span class="n">w</span><span class="p">,</span> <span class="n">h</span><span class="p">]</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">freqz</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>
<span class="n">w</span> <span class="o">=</span> <span class="n">w</span><span class="o">/</span><span class="n">numpy</span><span class="o">.</span><span class="n">pi</span>

<span class="n">ax_durch_c2_c</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="mi">20</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">h</span><span class="p">)),</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">ax_sperr_c2_c</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="mi">20</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">h</span><span class="p">)),</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">ax_phase_c2_c</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">unwrap</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">h</span><span class="p">)),</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>

<span class="n">pyplot</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;IIRDesign&quot;</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="figure align-default" id="fig-iirdesign" style="width: 75%">
<div class="cell_output docutils container">
<img alt="_images/filter_54_0.png" src="_images/filter_54_0.png" />
</div>
<p class="caption"><span class="caption-text">Beispiel eines Tiefpass-Entwurfes f√ºr verschiedene Entwurfsverfahren.</span><a class="headerlink" href="#fig-iirdesign" title="Permalink to this image">¬∂</a></p>
</div>
<p>Das Butterworth-Filter hat im Durchlassbereich den erwarteten positiven
flachen Verlauf, der im Sperrbereich zu einer monoton fallenden D√§mpfung
f√ºhrt. Dieses Verhalten im Sperrbereich wird auch vom
Tschebyscheff-I-Filter im Sperrbereich erreicht, wobei trotz der
geringeren Ordnung ein zun√§chst steilerer √úbergang an der Grenzfrequenz
erreicht wird. Beim Tschebyscheff-II-Filter im Durchlassbereich wird
deutlich, dass die Spezifikation √ºbererf√ºllt wird. Die Grenzfrequenz bei
der der √úbergang beginnt, ist verschoben, da beim
Tschebyscheff-II-Design in erster Linie der Sperrbereich erf√ºllt werden
soll.</p>
<p>Ein bisher nicht beachteter Aspekt ist in den Bildern c und f gezeigt.
Hier wird deutlich, dass die Phase im √úbergangsbereich durch das
Cauer-Filter am st√§rksten verzerrt wird, w√§hrend das Butterworth-Filter
am ehesten der meistens gew√ºnschten linearen Phase entspricht.</p>
<div class="error admonition">
<p class="admonition-title">To Do</p>
<p>Impuls bzw. Step-Verhalten zur Gl√§ttung</p>
</div>
</div>
<div class="section" id="entwurf-von-hochpass-bandpass-und-bandsperr-filter">
<h4>Entwurf von Hochpass, Bandpass und Bandsperr-Filter<a class="headerlink" href="#entwurf-von-hochpass-bandpass-und-bandsperr-filter" title="Permalink to this headline">¬∂</a></h4>
<p>Bisher wurden nur Tiefpass-Entw√ºrfe betrachtet. Alle anderen Filter
lassen sich ebenfalls errechnen, wobei die dazu verwendeten
Frequenz-Transformationen (nicht zu verwechseln mit der Fourier-Transformation) erst bei der Betrachtung der analogen
Prototyp-Filter genauer erl√§utert werden soll.</p>
<p>F√ºr den Entwurf mit Matlab ergibt sich f√ºr alle Verfahren das gleiche
Schema. Ein Hochpass-Filter wird durch einen speziellen Schalter (Flag =
‚Äúhigh‚Äù) angezeigt. Der Bandpass-Entwurf ergibt sich automatisch, wenn
mehr als eine Grenzfrequenz angegeben wird, w√§hrend die Bandsperre mit
zwei Grenzfrequenzen und einem Flag = ‚Äústop‚Äù angezeigt wird. Zur
Berechnung der Ordnung reicht es die Grenzfrequenzen zu vertauschen, um
einen Hochpass anzuzeigen.</p>
<p>Beispiel:</p>
<div class="tabbed-set docutils">
<input checked="checked" id="d11c89a3-44ce-4c10-a798-933ed16ee8d1" name="e62831e2-d1c7-499c-8076-fd44997d955a" type="radio">
</input><label class="tabbed-label" for="d11c89a3-44ce-4c10-a798-933ed16ee8d1">
Matlab</label><div class="tabbed-content docutils">
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="w">    </span><span class="c">% Highpass-Design</span><span class="w"></span>
<span class="w">    </span><span class="n">Pass_freq</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">0.2</span><span class="p">;</span><span class="w"> </span><span class="c">% Matlab uses normalized frequencies from 0..2</span><span class="w"></span>
<span class="w">    </span><span class="n">Pass_dB</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">0.2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">Stop_freq</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">0.1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">Stop_dB</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">30</span><span class="p">;</span><span class="w"></span>

<span class="w">    </span><span class="p">[</span><span class="n">N</span><span class="p">,</span><span class="n">f_g</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">buttord</span><span class="p">(</span><span class="n">Pass_freq</span><span class="p">,</span><span class="n">Stop_freq</span><span class="p">,</span><span class="n">Pass_dB</span><span class="p">,</span><span class="n">Stop_dB</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="c">% Result is 7th Order and f_g = 0.1247</span><span class="w"></span>
<span class="w">    </span><span class="p">[</span><span class="n">b</span><span class="p">,</span><span class="n">a</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">butter</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">f_g</span><span class="p">,</span><span class="s">&#39;high&#39;</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="c">%Bandpass Design</span><span class="w"></span>
<span class="w">    </span><span class="n">Pass_freqLow</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">0.2</span><span class="p">;</span><span class="w"> </span><span class="c">% Matlab uses normalized frequencies from 0..2</span><span class="w"></span>
<span class="w">    </span><span class="n">Pass_freqHigh</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">0.3</span><span class="p">;</span><span class="w"> </span><span class="c">% Matlab uses normalized frequencies from 0..2</span><span class="w"></span>
<span class="w">    </span><span class="n">Pass_dB</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">0.2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">Stop_freqLow</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">0.1</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">Stop_freqHigh</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">0.4</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">Stop_dB</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">30</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">[</span><span class="n">N</span><span class="p">,</span><span class="n">f_g</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">buttord</span><span class="p">([</span><span class="n">Pass_freqLow</span><span class="w"> </span><span class="n">Pass_freqHigh</span><span class="p">],[</span><span class="n">Stop_freqLow</span><span class="w"> </span><span class="n">Stop_freqHigh</span><span class="p">],</span><span class="n">Pass_dB</span><span class="p">,</span><span class="n">Stop_dB</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="p">[</span><span class="n">b</span><span class="p">,</span><span class="n">a</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">butter</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">f_g</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="c">% Bandstop Design</span><span class="w"></span>
<span class="w">    </span><span class="n">Pass_freqLow</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">0.1</span><span class="p">;</span><span class="w"> </span><span class="c">% Matlab uses normalized frequencies from 0..2</span><span class="w"></span>
<span class="w">    </span><span class="n">Pass_freqHigh</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">0.4</span><span class="p">;</span><span class="w"> </span><span class="c">% Matlab uses normalized frequencies from 0..2</span><span class="w"></span>
<span class="w">    </span><span class="n">Pass_dB</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">0.2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">Stop_freqLow</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">0.2</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">Stop_freqHigh</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mf">0.3</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="n">Stop_dB</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">30</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="p">[</span><span class="n">N</span><span class="p">,</span><span class="n">f_g</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">buttord</span><span class="p">([</span><span class="n">Pass_freqLow</span><span class="w"> </span><span class="n">Pass_freqHigh</span><span class="p">],[</span><span class="n">Stop_freqLow</span><span class="w"> </span><span class="n">Stop_freqHigh</span><span class="p">],</span><span class="n">Pass_dB</span><span class="p">,</span><span class="n">Stop_dB</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="p">[</span><span class="n">b</span><span class="p">,</span><span class="n">a</span><span class="p">]</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">butter</span><span class="p">(</span><span class="n">N</span><span class="p">,</span><span class="n">f_g</span><span class="p">,</span><span class="s">&#39;stop&#39;</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
</div>
<input id="f2470e32-741e-4e22-b5c9-93295b79e4d2" name="e62831e2-d1c7-499c-8076-fd44997d955a" type="radio">
</input><label class="tabbed-label" for="f2470e32-741e-4e22-b5c9-93295b79e4d2">
Python</label><div class="tabbed-content docutils">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>    <span class="c1"># Highpass Design</span>
    <span class="n">Pass_freq</span> <span class="o">=</span> <span class="mf">0.2</span>
    <span class="n">Pass_dB</span> <span class="o">=</span> <span class="mf">0.2</span>
    <span class="n">Stop_freq</span> <span class="o">=</span> <span class="mf">0.1</span>
    <span class="n">Stop_dB</span> <span class="o">=</span> <span class="mi">30</span>
    <span class="n">order</span><span class="p">,</span> <span class="n">wn</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">buttord</span><span class="p">(</span><span class="n">wp</span><span class="o">=</span><span class="n">Pass_freq</span><span class="p">,</span> <span class="n">ws</span><span class="o">=</span><span class="n">Stop_freq</span><span class="p">,</span> <span class="n">gpass</span><span class="o">=</span><span class="n">Pass_dB</span><span class="p">,</span> <span class="n">gstop</span><span class="o">=</span><span class="n">Stop_dB</span><span class="p">)</span>
    <span class="p">[</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">]</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">butter</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="n">order</span><span class="p">,</span> <span class="n">Wn</span><span class="o">=</span><span class="n">Pass_freq</span><span class="p">,</span> <span class="n">btype</span><span class="o">=</span><span class="s1">&#39;highpass&#39;</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="s1">&#39;ba&#39;</span><span class="p">)</span>

    <span class="c1"># Bandpass Design</span>
    <span class="n">Pass_freqLow</span> <span class="o">=</span> <span class="mf">0.2</span>
    <span class="n">Pass_freqHigh</span> <span class="o">=</span> <span class="mf">0.3</span>
    <span class="n">Pass_dB</span> <span class="o">=</span> <span class="mf">0.2</span>
    <span class="n">Stop_freqLow</span> <span class="o">=</span> <span class="mf">0.1</span>
    <span class="n">Stop_freqHigh</span> <span class="o">=</span> <span class="mf">0.4</span>
    <span class="n">Stop_dB</span> <span class="o">=</span> <span class="mi">30</span>
    <span class="n">order</span><span class="p">,</span> <span class="n">wn</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">buttord</span><span class="p">(</span><span class="n">wp</span><span class="o">=</span><span class="n">Pass_freq</span><span class="p">,</span> <span class="n">ws</span><span class="o">=</span><span class="n">Stop_freq</span><span class="p">,</span> <span class="n">gpass</span><span class="o">=</span><span class="n">Pass_dB</span><span class="p">,</span> <span class="n">gstop</span><span class="o">=</span><span class="n">Stop_dB</span><span class="p">)</span>
    <span class="p">[</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">]</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">butter</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="n">order</span><span class="p">,</span> <span class="n">Wn</span><span class="o">=</span><span class="p">[</span><span class="n">Pass_freqLow</span><span class="p">,</span> <span class="n">Pass_freqHigh</span><span class="p">],</span> <span class="n">btype</span><span class="o">=</span><span class="s1">&#39;bandpass&#39;</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="s1">&#39;ba&#39;</span><span class="p">)</span>

    <span class="c1"># Bandstop Design</span>
    <span class="n">Pass_freqLow</span> <span class="o">=</span> <span class="mf">0.1</span>
    <span class="n">Pass_freqHigh</span> <span class="o">=</span> <span class="mf">0.4</span>
    <span class="n">Pass_dB</span> <span class="o">=</span> <span class="mf">0.2</span>
    <span class="n">Stop_freqLow</span> <span class="o">=</span> <span class="mf">0.2</span>
    <span class="n">Stop_freqHigh</span> <span class="o">=</span> <span class="mf">0.3</span>
    <span class="n">Stop_dB</span> <span class="o">=</span> <span class="mi">30</span> 
    <span class="n">order</span><span class="p">,</span> <span class="n">wn</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">buttord</span><span class="p">(</span><span class="n">wp</span><span class="o">=</span><span class="n">Pass_freq</span><span class="p">,</span> <span class="n">ws</span><span class="o">=</span><span class="n">Stop_freq</span><span class="p">,</span> <span class="n">gpass</span><span class="o">=</span><span class="n">Pass_dB</span><span class="p">,</span> <span class="n">gstop</span><span class="o">=</span><span class="n">Stop_dB</span><span class="p">)</span>
    <span class="p">[</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">]</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">butter</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="n">order</span><span class="p">,</span> <span class="n">Wn</span><span class="o">=</span><span class="p">[</span><span class="n">Pass_freqLow</span><span class="p">,</span> <span class="n">Pass_freqHigh</span><span class="p">],</span> <span class="n">btype</span><span class="o">=</span><span class="s1">&#39;bandstop&#39;</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="s1">&#39;ba&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<hr class="footnotes docutils" />
<dl class="footnote brackets">
<dt class="label" id="id15"><span class="brackets"><a class="fn-backref" href="#id12">3</a></span></dt>
<dd><p>Die Ordnung ist <span class="math notranslate nohighlight">\(M\)</span>, somit hat das Filter <span class="math notranslate nohighlight">\(M+1\)</span> Koeffizienten, die
Faltung ergibt dann <span class="math notranslate nohighlight">\(L+M+1-1\)</span> Ausgangswerte.</p>
</dd>
</dl>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
            



<div class='prev-next-bottom'>
    

</div>
        
        </div>
    </div>
    <footer class="footer">
    <div class="container">
      <p>
        
          By Joerg Bitzer<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>