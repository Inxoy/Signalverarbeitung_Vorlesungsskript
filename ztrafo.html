
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>4. z-Transformation &#8212; Signalverarbeitung 1</title>
    
  <link href="_static/css/theme.css" rel="stylesheet" />
  <link href="_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.1c5a1a01449ed65a7b51.js">

    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="5. Spektren" href="spektren.html" />
    <link rel="prev" title="3. Systeme" href="systeme.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
      
      
      <h1 class="site-logo" id="site-title">Signalverarbeitung 1</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="intro.html">
   Zu diesem Jupyter-Buch
  </a>
 </li>
</ul>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="grundlagen.html">
   1. Einf√ºhrung
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="signale.html">
   2. Signale
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="systeme.html">
   3. Systeme
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   4. z-Transformation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="spektren.html">
   5. Spektren
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="filter.html">
   6. Filter
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="zbibliography.html">
   7. Literaturverzeichnis
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        <a class="dropdown-buttons"
            href="_sources/ztrafo.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download notebook file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/ztrafo.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/JoergBitzer/Signalverarbeitung_Vorlesungsskript/"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/JoergBitzer/Signalverarbeitung_Vorlesungsskript//issues/new?title=Issue%20on%20page%20%2Fztrafo.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/JoergBitzer/Signalverarbeitung_Vorlesungsskript/master?urlpath=tree/ztrafo.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#einfuhrung">
   4.1. Einf√ºhrung
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#definition-z-transformation">
   4.2. Definition z-Transformation
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#rechenregeln">
   4.3. Rechenregeln
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#linearitat">
     4.3.1. Linearit√§t
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#verschiebung">
     4.3.2. Verschiebung
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#ruck-transformation">
   4.4. R√ºck-Transformation
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#korrespondenztabelle">
     4.4.1. Korrespondenztabelle
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#systemfunktion">
   4.5. Systemfunktion
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#pol-nullstellenplan">
   4.6. Pol-Nullstellenplan
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#stabilitat">
   4.7. Stabilit√§t
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#stabilitat-eines-systems-2-ordnung">
     4.7.1. Stabilit√§t eines Systems 2. Ordnung
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#interaktive-visualisierung-der-z-transformation">
   4.8. Interaktive Visualisierung der z-Transformation
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="z-transformation">
<h1><span class="section-number">4. </span>z-Transformation<a class="headerlink" href="#z-transformation" title="Permalink to this headline">¬∂</a></h1>
<p>Die z-Transformation stellt ein wichtiges
Werkzeug zur Analyse und zum Verst√§ndnis von LTI-Systemen dar.  Es werden durch die z-Systemfunktion und
dem Pol-Nullstellenplot neue Beschreibungsformen f√ºr LTI-Systeme
aufgezeigt. Insbesondere wird eine M√∂glichkeit angegeben, um die
Stabilit√§t rekursiver LTI-Systeme zu testen.</p>
<div class="section" id="einfuhrung">
<h2><span class="section-number">4.1. </span>Einf√ºhrung<a class="headerlink" href="#einfuhrung" title="Permalink to this headline">¬∂</a></h2>
<p>Zun√§chst ein einfache Beipiel, um die N√ºtzlichlkeit dieses Werkzeuges zu unterstreichen.</p>
<p>Angenommen auf ein Sparbuch wird ein bestimmter Geldbetrag <span class="math notranslate nohighlight">\(S\)</span>
eingezahlt und dieser Betrag wird j√§hrlich mit einem Zins <span class="math notranslate nohighlight">\(p\)</span> verzinst.
Eine mathematische Darstellung dieses Sachverhalts ergibt sich durch
Nutzung des Delta-Impulses gewichtet mit dem Geldbetrag und einer
einfachen Rekursion, wobei ein leeres Konto als Startwert vorliegt. Es
gilt also <span class="math notranslate nohighlight">\(y(k-1) = 0\)</span>.</p>
<div class="math notranslate nohighlight" id="equation-eq-zinsrekursion">
<span class="eqno">(4.1)<a class="headerlink" href="#equation-eq-zinsrekursion" title="Permalink to this equation">¬∂</a></span>\[
y(k) = (1+p) y(k-1) + S \delta(k)
\]</div>
<p>Dies ist eine andere Darstellung der Zinseszinsrechenregel. Diese lautet</p>
<div class="math notranslate nohighlight">
\[
\mbox{Geld} = S (1+p)^{\mbox{Jahre}}
\]</div>
<p>Die Anzahl der Jahre ist in Formel
<a class="reference internal" href="#equation-eq-zinsrekursion">(4.1)</a> in der Anzahl der Rekursionen versteckt.
Die zweite Form ist eine direkte Berechnung.</p>
<p>Nun lassen sich aber nicht f√ºr alle Rekursionssysteme solche einfachen
direkten Rechenvorschriften angeben. Aber wie ist der mathematische
Zusammenhang zwischen den beiden m√∂glichen L√∂sungen?</p>
<p>In der Rekursionsformel:</p>
<div class="math notranslate nohighlight" id="equation-eq-zinsrekursionwiederholung">
<span class="eqno">(4.2)<a class="headerlink" href="#equation-eq-zinsrekursionwiederholung" title="Permalink to this equation">¬∂</a></span>\[
    y(k) = (1+p) y(k-1) + S \delta(k)
\]</div>
<p>ergibt sich durch Variablensubstitution <span class="math notranslate nohighlight">\(c = 1+p\)</span>.</p>
<div class="math notranslate nohighlight" id="equation-eq-zinsrekursionmitc">
<span class="eqno">(4.3)<a class="headerlink" href="#equation-eq-zinsrekursionmitc" title="Permalink to this equation">¬∂</a></span>\[
y(k) = c y(k-1) + S \delta(k)
\]</div>
<p>Diese Form wird jetzt auf beiden
Seiten mit der Summe <span class="math notranslate nohighlight">\(\sum_{k =
-\infty}^{\infty}z^{-k}\)</span> multipliziert. Ein Schritt der mathematisch
erlaubt ist, da er auf beiden Seiten des Gleichungssystems durchgef√ºhrt
wird.</p>
<div class="math notranslate nohighlight" id="equation-eq-zinsrekursionz">
<span class="eqno">(4.4)<a class="headerlink" href="#equation-eq-zinsrekursionz" title="Permalink to this equation">¬∂</a></span>\[
\sum_{k = -\infty}^{\infty} y(k) z^{-k} = \underbrace{c \sum_{k =
-\infty}^{\infty} y(k-1) z^{-k}}_{\mbox{1. Summand}} +
\underbrace{S \sum_{k = -\infty}^{\infty} \delta(k)
z^{-k}}_{\mbox{2. Summand}}
\]</div>
<p>Mit Hilfe der abk√ºrzenden Schreibweise</p>
<div class="math notranslate nohighlight" id="equation-eq-def-ztrafo">
<span class="eqno">(4.12)<a class="headerlink" href="#equation-eq-def-ztrafo" title="Permalink to this equation">¬∂</a></span>\[
Y(z) = \sum_{k = -\infty}^{\infty} y(k) z^{-k} .
\]</div>
<p>ergibt sich bei dem 2. Summanden nur ein Element der Summe den Wert <span class="math notranslate nohighlight">\(S\)</span>, da die <span class="math notranslate nohighlight">\(\delta\)</span>-Folge nur bei <span class="math notranslate nohighlight">\(k = 0\)</span> einen Wert ungleich Null hat.</p>
<p>Zus√§tzlich kann der 1. Summand durch eine Variablensubstitution
<span class="math notranslate nohighlight">\(k' = k-1\)</span> umgeformt werden.</p>
<div class="math notranslate nohighlight" id="equation-eq-ztrafo-example1subst">
<span class="eqno">(4.6)<a class="headerlink" href="#equation-eq-ztrafo-example1subst" title="Permalink to this equation">¬∂</a></span>\[
    c \sum_{k =
-\infty}^{\infty} y(k-1) z^{-k} = c \sum_{k' = -\infty}^{\infty}
y(k') z^{-k'-1} =c z^{-1}\sum_{k' = -\infty}^{\infty} y(k')
z^{-k'}=c z^{-1} Y(z)
\]</div>
<p>Somit ergibt sich</p>
<div class="math notranslate nohighlight" id="equation-eq-ztrafo-example1">
<span class="eqno">(4.7)<a class="headerlink" href="#equation-eq-ztrafo-example1" title="Permalink to this equation">¬∂</a></span>\[
    Y(z) = c z^{-1} Y(z) + S .
\]</div>
<p>Umgestellt folgt</p>
<div class="math notranslate nohighlight" id="equation-eq-ztrafo-example1-zloesung">
<span class="eqno">(4.8)<a class="headerlink" href="#equation-eq-ztrafo-example1-zloesung" title="Permalink to this equation">¬∂</a></span>\[
    Y(z) = \frac{S}{1-c z^{-1}} .
\]</div>
<p>Um zur L√∂sung f√ºr das Ausgangssignal zu kommen, wird die Summenformel
f√ºr eine geometrische Reihe eingef√ºhrt.</p>
<div class="math notranslate nohighlight" id="equation-eq-def-geometrischereihe">
<span class="eqno">(4.9)<a class="headerlink" href="#equation-eq-def-geometrischereihe" title="Permalink to this equation">¬∂</a></span>\[
\sum_{k = 0}^{\infty} q^k = \frac{1}{1-q}  \quad \mbox{wenn} \quad |q|&lt;1
\]</div>
<p>F√ºr Gleichung
<a class="reference internal" href="#equation-eq-ztrafo-example1-zloesung">(4.8)</a> ergibt sich also</p>
<div class="math notranslate nohighlight" id="equation-eq-ztrafo-example1-kloesung1">
<span class="eqno">(4.10)<a class="headerlink" href="#equation-eq-ztrafo-example1-kloesung1" title="Permalink to this equation">¬∂</a></span>\[
\frac{S}{1-c z^{-1}} = S \sum_{k = 0}^{\infty} (c z^{-1})^k = S \sum_{k = 0}^{\infty} c^k z^{-k}
\]</div>
<p>Vergleicht man diese L√∂sung mit
<a class="reference internal" href="#equation-eq-def-ztrafo">(4.12)</a> ergibt sich</p>
<div class="math notranslate nohighlight" id="equation-eq-ztrafo-example1-kloesung2">
<span class="eqno">(4.11)<a class="headerlink" href="#equation-eq-ztrafo-example1-kloesung2" title="Permalink to this equation">¬∂</a></span>\[\begin{split}
    y(k) = \bigg\{ \begin{array}{lcc}
      S c^k &amp; &amp; k \geq 0\\
        0  &amp; &amp; k&lt;0
    \end{array} = S(1+p)^k \gamma(k)
\end{split}\]</div>
<p>mit <span class="math notranslate nohighlight">\(\gamma(k)\)</span> als Sprungfolge (siehe Gleichung
<a class="reference internal" href="signale.html#equation-eq-def-sprungfolge">(2.11)</a>).</p>
<p>Dies entspricht der vorher bekannten L√∂sung f√ºr die Zinseszinsformel.</p>
</div>
<div class="section" id="definition-z-transformation">
<h2><span class="section-number">4.2. </span>Definition z-Transformation<a class="headerlink" href="#definition-z-transformation" title="Permalink to this headline">¬∂</a></h2>
<p>F√ºr eine verk√ºrzte Schreibweise wird f√ºr die z-Transformation folgendes
Symbol eingef√ºhrt</p>
<div class="math notranslate nohighlight" id="equation-eq-def-ztrafo">
<span class="eqno">(4.12)<a class="headerlink" href="#equation-eq-def-ztrafo" title="Permalink to this equation">¬∂</a></span>\[
\mathcal{Z}\{ \cdot \}= \sum_{k = -\infty}^{\infty} (\cdot) z^{-k} mit~z \in \mathbb{C}
\]</div>
<p>Es gilt also</p>
<div class="math notranslate nohighlight" id="equation-eq-yexample">
<span class="eqno">(4.13)<a class="headerlink" href="#equation-eq-yexample" title="Permalink to this equation">¬∂</a></span>\[
    Y(z) =\mathcal{Z}\{y(k)\}
\]</div>
<p>Die Rechenvorschrift f√ºhrt dazu, dass die diskrete
Eingangsfolge <span class="math notranslate nohighlight">\(y(k)\)</span> abgebildet wird auf eine komplexe Ebene. Man
spricht deshalb auch von Zeitbereichsdarstellung und
Bildbereichdarstellung. Um die Korrespondenz zu symbolisieren wird
h√§ufig der sog. ‚ÄúTransformationsknochen‚Äù verwendet.</p>
<ul class="simple">
<li><p>Hintransformation: <span class="math notranslate nohighlight">\(y(k) \circ \hskip-1ex -\hskip-1.2ex -\hskip-1.2ex- \hskip-1ex \bullet\; Y(z)\)</span> oder bei Gleichungsabfolgen vertikal</p></li>
<li><p>R√ºcktransformation: <span class="math notranslate nohighlight">\(Y(z) \bullet \hskip-1ex -\hskip-1.2ex -\hskip-1.2ex- \hskip-1ex \circ\; y(k)\)</span></p></li>
</ul>
<p>Damit eine z-Transformation g√ºltig ist, muss zus√§tzlich gelten, dass die
Summe in Gl. <a class="reference internal" href="#equation-eq-def-ztrafo">(4.12)</a> kleiner unendlich ist. Dies ist f√ºr alle
endlichen Folgen gegeben, wenn keiner der Folgenwerte unendlich ist. Bei
unendlichen Folgen ist dies nicht immer gew√§hrleistet.und h√§ngt auch
direkt von <span class="math notranslate nohighlight">\(z\)</span> ab. Deshalb geh√∂rt zu einer vollst√§ndigen
Beschreibung der z-Transformation auch immer die Bereichsangabe von <span class="math notranslate nohighlight">\(z\)</span>
in der die Summe konvergiert. Man spricht deshalb vom sogenannten
Konvergenzgebiet <em>Region of Convergence</em>. Zur Beschreibung des
Konvergenzgebietes reichen die Angaben der Radien <span class="math notranslate nohighlight">\(r = |z|\)</span> der
komplexen Zahlen aus. F√ºr das Konvergenzgebiet ergibt sich entweder das
Gebiet inner- oder au√üerhalb einer Kreisfl√§che oder das Gebiet hat die
Form eines Kreisringes in der z-Ebene.</p>
<div class="figure align-default" id="fig-roc-kausal">
<a class="reference internal image-reference" href="_images/ROC_Kausal.png"><img alt="_images/ROC_Kausal.png" src="_images/ROC_Kausal.png" style="width: 50%;" /></a>
<p class="caption"><span class="caption-number">Fig. 4.1 </span><span class="caption-text">Veranschaulichung des Konvergenzgebietes bei der z-Transformation. In
diesem Beispiel f√ºr eine kausale Folge (ROC
au√üerhalb).</span><a class="headerlink" href="#fig-roc-kausal" title="Permalink to this image">¬∂</a></p>
</div>
<div class="cell tag_hide-input tag_remove-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="c1">#-------------------------------------------------------------------------------</span>
<span class="c1"># Demoscript for &quot;Signalverarbeitung 1&quot;</span>
<span class="c1">#</span>
<span class="c1"># Version: 1.0   17.02.2022</span>
<span class="c1"># </span>
<span class="c1"># This software is released as public domain under CC0 1.0</span>
<span class="c1"># https://creativecommons.org/publicdomain/zero/1.0/</span>
<span class="c1">#-------------------------------------------------------------------------------</span>

<span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span>

<span class="c1"># determine where we&#39;re running from and set paths accordingly</span>
<span class="k">try</span><span class="p">:</span> 
    <span class="k">if</span> <span class="n">get_ipython</span><span class="p">()</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;ZMQInteractiveShell&#39;</span><span class="p">:</span>
        <span class="n">prefix</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<span class="k">except</span><span class="p">:</span>
    <span class="n">prefix</span> <span class="o">=</span> <span class="s1">&#39;../../&#39;</span>

<span class="n">matplotlib</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">prefix</span><span class="si">}</span><span class="s1">sv.mplstyle&#39;</span><span class="p">)</span>

<span class="n">index_kausal</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">21</span><span class="p">)</span>
<span class="n">amplitude_kausal</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">index_kausal</span><span class="p">)</span>
<span class="n">mid_kausal</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">index_kausal</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span>
<span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">index_kausal</span><span class="p">)</span><span class="o">-</span><span class="n">mid_kausal</span><span class="p">):</span>
    <span class="n">amplitude_kausal</span><span class="p">[</span><span class="n">idx</span><span class="o">+</span><span class="n">mid_kausal</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">**</span><span class="n">idx</span>

<span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax_kausal</span><span class="p">,</span> <span class="n">ax_nkausal</span><span class="p">)</span> <span class="o">=</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">ax_kausal</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">index_kausal</span><span class="p">,</span> <span class="n">amplitude_kausal</span><span class="p">,</span> <span class="n">use_line_collection</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ax_kausal</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Folgenkindex k -&gt;&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Amplitude x(k)&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;kausale Folge 0.5**(k)*gamma(k)&#39;</span><span class="p">,</span> <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">])</span>

<span class="n">index_nkausal</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">21</span><span class="p">)</span>
<span class="n">amplitude_nkausal</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">index_nkausal</span><span class="p">)</span>
<span class="n">mid_nkausal</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">index_nkausal</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span>
<span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">index_nkausal</span><span class="p">)</span><span class="o">-</span><span class="n">mid_nkausal</span><span class="p">):</span>
    <span class="n">amplitude_nkausal</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="mf">0.5</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="o">+</span><span class="n">idx</span><span class="p">)</span>

<span class="n">ax_nkausal</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">index_nkausal</span><span class="p">,</span> <span class="n">amplitude_nkausal</span><span class="p">,</span> <span class="n">use_line_collection</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ax_nkausal</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Folgenkindex k -&gt;&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Amplitude x(k)&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;nicht kausale Folge -0.5**(-k)*gamma(-k)&#39;</span><span class="p">,</span> <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span> <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">50</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>

<span class="n">pyplot</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># glue this figure to paste it later (no effect outside of MyST NB)</span>
<span class="kn">from</span> <span class="nn">myst_nb</span> <span class="kn">import</span> <span class="n">glue</span>
<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;zFolgenPic&quot;</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="note admonition">
<p class="admonition-title">Beispiel</p>
<p>Betrachtet man die kausale Folge (siehe <a class="reference internal" href="#fig-zfolgenpic"><span class="std std-numref">Abbildung 4.2</span></a>
a) (Sie entspricht dem Sparbuchbeispiel mit einem Startkapital von 0.5 und
50% Kontokosten (Also einer ziemlich schlechten Geldanlage).)</p>
<div class="math notranslate nohighlight" id="equation-eq-bspkausalefolge">
<span class="eqno">(4.14)<a class="headerlink" href="#equation-eq-bspkausalefolge" title="Permalink to this equation">¬∂</a></span>\[\begin{split}
\begin{aligned}
    x(k) &amp;=&amp; [0.5 \:\: 0.5^2 \:\: 0.5^3 \:\: \cdots \:\: 0.5^k]\\
         &amp; = &amp; 0.5^k \gamma(k) \qquad~f√ºr~k \geq 0 ,\end{aligned}
\end{split}\]</div>
<p>soergibt sich die z-Transformierte als</p>
<div class="math notranslate nohighlight">
\[
X(z) = \sum_{k = -\infty}^{\infty} 0.5^k \gamma(k)z^{-k}
    = \sum_{k = 0}^{\infty} 0.5^k z^{-k} =
    \sum_{k = 0}^{\infty} (0.5z^{-1})^{k}
\]</div>
<p>bzw. mit der Umformung durch die geometrische Reihe</p>
<div class="math notranslate nohighlight">
\[
X(z) = \frac{1}{1-0.5z^{-1}} = \frac{z}{z-0.5},
\]</div>
<p>wobei das Konvergenzkriterium der geometrischen Reihe zus√§tzlich</p>
<div class="math notranslate nohighlight">
\[
\nonumber
    |0.5z^{-1}| = \frac{0.5}{z} &lt; 1 \qquad \Rightarrow \qquad |z| &gt; 0.5
\]</div>
<p>fordert.</p>
<p>Definition:</p>
<div class="figure align-default" id="fig-zfolgenpic" style="width: 75%">
<div class="cell_output docutils container">
<img alt="_images/ztrafo_2_1.png" src="_images/ztrafo_2_1.png" />
</div>
<p class="caption"><span class="caption-number">Fig. 4.2 </span><span class="caption-text">a) kausale
Folge <span class="math notranslate nohighlight">\(0.5^k \gamma(k)\)</span> f√ºr <span class="math notranslate nohighlight">\(k \geq 0\)</span> und b) nicht-kausale Folge
<span class="math notranslate nohighlight">\(-0.5^k \gamma(-k-1)\)</span> f√ºr <span class="math notranslate nohighlight">\(k &lt; 0\)</span>.</span><a class="headerlink" href="#fig-zfolgenpic" title="Permalink to this image">¬∂</a></p>
</div>
</div>
<p>Im folgenden soll nun eine sehr √§hnlichen Folge, n√§mlich dem
nicht-kausalen, negativen √§quivalent zu
<a class="reference internal" href="#equation-eq-bspkausalefolge">(4.14)</a></p>
<div class="math notranslate nohighlight">
\[
\nonumber
    x(k) = -0.5^k \gamma(-k-1) \qquad f√ºr k &lt; 0
\]</div>
<p>betrachtet werden (siehe <a class="reference internal" href="#fig-zfolgenpic"><span class="std std-numref">Abbildung 4.2</span></a> b). Berechnet man die z-Transformierte ergibt sich mit einer Variablensubstitution <span class="math notranslate nohighlight">\(k = -m\)</span></p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{aligned}
\nonumber
    X(z) &amp;=&amp; - \sum_{k = -\infty}^{-1} 0.5^k z^{-k} \\
    &amp; = &amp;- \sum_{k = -\infty}^{-1} (0.5^{-1}z)^{-k} \\
    &amp; = &amp;- \sum_{m = 1}^{\infty} (0.5^{-1}z)^{m}\end{aligned}
\end{split}\]</div>
<p>Nutzt man jetzt eine alternative Formulierung der unendlichen geometrischen
Reihe</p>
<div class="math notranslate nohighlight">
\[\nonumber
    \sum_{m = 1}^{\infty} x^m = \frac{x}{1-x}
\]</div>
<p>so ergibt sich</p>
<div class="math notranslate nohighlight">
\[
\nonumber
    X(z) = - \frac{0.5^{-1}z}{1-0.5^{-1}z} = \frac{z}{z-0.5}
\]</div>
<p>Wir erhalten also die gleiche z-Transformation f√ºr unterschiedliche Folgen,
wobei aber die Konvergenz der geometrischen Reihe f√ºr die anti-kausale
Folge ein Konverzgebiet</p>
<div class="math notranslate nohighlight">
\[\nonumber
    |z| &lt; 0.5
\]</div>
<p>fordert. <a class="reference internal" href="#fig-roc-antikausal"><span class="std std-numref">Abbildung 4.3</span></a>  zeigt das dazugeh√∂rige Konvergenzgebiet in der z-Ebene. Man erkennt somit, warum eine Angabe des ROC bei der z-Transformation notwendig ist, um eine eindeutige Berechnung und Zuordnung zu gew√§hrleisten.</p>
<div class="figure align-default" id="fig-roc-antikausal">
<a class="reference internal image-reference" href="_images/ROC_AntiKausal.png"><img alt="_images/ROC_AntiKausal.png" src="_images/ROC_AntiKausal.png" style="width: 50%;" /></a>
<p class="caption"><span class="caption-number">Fig. 4.3 </span><span class="caption-text">Veranschaulichung des Konvergenzgebietes bei
der z-Transformation. In diesem Beispiel f√ºr eine anti-kausale Folge
(ROC innerhalb) mit
<span class="math notranslate nohighlight">\(|z| &lt; 0.5\)</span>.</span><a class="headerlink" href="#fig-roc-antikausal" title="Permalink to this image">¬∂</a></p>
</div>
</div>
<div class="section" id="rechenregeln">
<h2><span class="section-number">4.3. </span>Rechenregeln<a class="headerlink" href="#rechenregeln" title="Permalink to this headline">¬∂</a></h2>
<p>Die z-Transformation erleichtert das Rechnen von Differenzengleichungen.
Einige h√§ufig verwendete Rechenregeln und
Korrespondenzen sind im Folgenden aufgef√ºhrt.</p>
<div class="section" id="linearitat">
<h3><span class="section-number">4.3.1. </span>Linearit√§t<a class="headerlink" href="#linearitat" title="Permalink to this headline">¬∂</a></h3>
<p>Die z-Transformation ist eine lineare Transformation. Es gilt:</p>
<div class="math notranslate nohighlight" id="equation-eq-ztrafo-linearitaet">
<span class="eqno">(4.15)<a class="headerlink" href="#equation-eq-ztrafo-linearitaet" title="Permalink to this equation">¬∂</a></span>\[
  a_1 x_1(k) + a_2 x_2(k) ;\circ \hskip-1ex -\hskip-1.2ex -\hskip-1.2ex- \hskip-1ex \bullet\; a_1 X_1(z) + a_2 X_2(z)
\]</div>
</div>
<div class="section" id="verschiebung">
<h3><span class="section-number">4.3.2. </span>Verschiebung<a class="headerlink" href="#verschiebung" title="Permalink to this headline">¬∂</a></h3>
<p>Die zeitliche Verschiebung der diskreten Folge wurde bereits in den
Beispielen ausgiebig verwendet. Es gilt:</p>
<div class="math notranslate nohighlight" id="equation-eq-ztrafo-verschiebungssatz">
<span class="eqno">(4.16)<a class="headerlink" href="#equation-eq-ztrafo-verschiebungssatz" title="Permalink to this equation">¬∂</a></span>\[
    \mathcal{Z}\{y(k-k_0)\} = z^{-k_0} Y(z)
\]</div>
</div>
</div>
<div class="section" id="ruck-transformation">
<h2><span class="section-number">4.4. </span>R√ºck-Transformation<a class="headerlink" href="#ruck-transformation" title="Permalink to this headline">¬∂</a></h2>
<p>Die z-Transformation transformiert eine diskrete Folge in eine
kontinuierliche komplexe Ebene. In den Beispielen wurde f√ºr die R√ºcktransformation in den Zeitbereich stets mit einfachen gebrochen rationalen Funktionen gearbeitet, die direkt auf eine bestimmte
Folge f√ºhrten. Dies ist nicht immer m√∂glich. Die allgemeinste Version
der z-R√ºcktransformation ist durch das Umlaufintegral</p>
<div class="math notranslate nohighlight" id="equation-eq-zruek-def">
<span class="eqno">(4.17)<a class="headerlink" href="#equation-eq-zruek-def" title="Permalink to this equation">¬∂</a></span>\[
    x(k) = \oint_C X(z) z^{k-1} dz
\]</div>
<p>gegeben. Dies bedeutet wir umlaufen
die komplexe Ebene auf dem Kreis C im mathematisch positiven Sinn
(Gegenuhrzeigersinn) und integrieren die eingeschlossene Fl√§che. Dies
ist nicht immer m√∂glich. Ob die M√∂glichkeit besteht h√§ngt direkt davon
ab, wie das Konvergenzgebiet definiert ist. Auf die explizite Behandlung
der Thematik wird hier nicht eingegangen, statt dessen wird auf <span id="id1">[<a class="reference internal" href="zbibliography.html#id186">OS99</a>]</span>
verwiesen.</p>
<p>In vielen F√§llen kann auf die L√∂sung des Integrals verzichtet werden.
Statt dessen sind h√§ufig L√∂sungen √ºber Partialbruchzerlegung (siehe
Beispiele) und/oder Korrespondenztabellen m√∂glich</p>
<div class="section" id="korrespondenztabelle">
<h3><span class="section-number">4.4.1. </span>Korrespondenztabelle<a class="headerlink" href="#korrespondenztabelle" title="Permalink to this headline">¬∂</a></h3>
<p>Viele Systeme und Signale lassen sich auf einfache Grundformen
zur√ºckf√ºhren. F√ºr diese Grundformen kann f√ºr die Hin- und
R√ºcktransformation folgende Tabelle verwendet werden.</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>Zeitbereich <span class="math notranslate nohighlight">\(y(k)\)</span></p></th>
<th class="head"><p>Bildbereich <span class="math notranslate nohighlight">\(Y(z) = \mathcal{Z}\{y(k)\}\)</span></p></th>
<th class="head"><p>Konvergenzgebiet</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\delta(k)\)</span></p></td>
<td><p>1</p></td>
<td><p><span class="math notranslate nohighlight">\(\forall z\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\gamma{k}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\frac{z}{z-1} = \frac{1}{1-z^{-1}}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\text{abs(z)}&gt;1\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(k \gamma(k)\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\frac{z}{(z-1)^2}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\text{abs(z)}&gt;1\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(e^{-\alpha k}\gamma (k)\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\frac{z}{z-e^{-\alpha}}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\text{abs(z)}&gt;e^{-\alpha}\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\alpha^k \gamma (k)\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\frac{z}{z-\alpha}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\text{abs(z)} &gt; \alpha\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\cos(\omega_0 k)\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\frac{1-z^{-1} \cos(\omega_0)}{1-z^{-1} 2\cos(\omega_0)+z^{-2}}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\text{abs(z)}&gt;1\)</span></p></td>
</tr>
</tbody>
</table>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Zeitbereich ùë¶(ùëò)&#39;</span><span class="p">:[</span><span class="s2">&quot;Œ¥(k)&quot;</span><span class="p">,</span> <span class="s2">&quot;Œ≥k&quot;</span><span class="p">,</span> <span class="s2">&quot;kŒ≥(k)&quot;</span><span class="p">,</span> <span class="s2">&quot;e‚àíŒ±kŒ≥(k)&quot;</span><span class="p">,</span> <span class="s2">&quot;Œ±kŒ≥(k)&quot;</span><span class="p">,</span> <span class="s2">&quot;cos(œâ0k)&quot;</span><span class="p">],</span> 
                              <span class="s1">&#39;x(k)&#39;</span><span class="p">:[</span><span class="s2">&quot;1&quot;</span><span class="p">,</span> <span class="s2">&quot;(z/z-1) = 1/1-z‚àí1 &quot;</span><span class="p">,</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span> <span class="s2">&quot;1&quot;</span><span class="p">],</span>
                              <span class="s1">&#39;x(k-1)&#39;</span><span class="p">:[</span><span class="s2">&quot;‚àÄz)&quot;</span><span class="p">,</span> <span class="s2">&quot; |z| &gt; 1&quot;</span><span class="p">,</span> <span class="s2">&quot; |z| &gt; 1&quot;</span><span class="p">,</span> <span class="s2">&quot; |z| &gt; e‚àíŒ±&quot;</span><span class="p">,</span> <span class="s2">&quot;|z| &gt; Œ±&quot;</span><span class="p">,</span> <span class="s2">&quot;|z| &gt; 1&quot;</span><span class="p">]})</span>
<span class="c1">#df = df.set_index(&#39;k&#39;)</span>
</pre></div>
</div>
</div>
</div>
<p>Eine Beschreibung von LTI-Systemen kann wie im letzten Abschnitt gezeigt
√ºber Differenzengleichungen erfolgen. Die z-Transformation und
R√ºcktransformation solcher Systeme sind besonders gut √ºber die
Korrespondenztabellen zu l√∂sen:</p>
<div class="note admonition">
<p class="admonition-title">Beispiel</p>
<p>LTI-Systeme<br />
Wie lautet die z-Transformierte f√ºr die folgende Differenzengleichung</p>
<div class="math notranslate nohighlight">
\[
y(k) = 0.2y(k-1) - y(k-3) + x(k) + 1.2x(k-1) - 3.2 x(k-2)
\]</div>
<p>Entscheidend ist, dass nur einfache Verz√∂gerungen <span class="math notranslate nohighlight">\(k_0\)</span> auftreten, die
in der z-Ebene durch <span class="math notranslate nohighlight">\(z^{-k_0}\)</span> dargestellt werden. Es ergibt sich mit
der Eigenschaft der Linearit√§t:</p>
<div class="math notranslate nohighlight">
\[
Y(z) = 0.2Y(z) z^{-1} - Y(z) z^{-3} + X(z) + 1.2X(z) z^{-1} - 3.2X(z) z^{-2}
\]</div>
</div>
</div>
</div>
<div class="section" id="systemfunktion">
<span id="sec-systemfunktion"></span><h2><span class="section-number">4.5. </span>Systemfunktion<a class="headerlink" href="#systemfunktion" title="Permalink to this headline">¬∂</a></h2>
<p>Bei den zur Einf√ºhrung verwendeten Beispielen wurden sehr einfache
Eingangsfolgen f√ºr <span class="math notranslate nohighlight">\(x(k)\)</span> verwendet. Man k√∂nnte das Sparbuch-Beispiel
aber auch erweitern und annehmen, dass pro Jahr eine nicht n√§her
definierte Summe zus√§tzlich aufs Konto eingezahlt wird. Die rekursive
Formulierung f√ºr den Ausgang sehe dann wie folgt aus</p>
<div class="math notranslate nohighlight" id="equation-eq-example3-eingang">
<span class="eqno">(4.18)<a class="headerlink" href="#equation-eq-example3-eingang" title="Permalink to this equation">¬∂</a></span>\[
    y(k) = (1+p) y(k-1) + x(k)
\]</div>
<p>Eine Transformation mit der
Definition <a class="reference internal" href="#equation-eq-def-ztrafo">(4.12)</a> in den z-Bereich f√ºhrt zu</p>
<div class="math notranslate nohighlight" id="equation-eq-eaxample3-zloesung">
<span class="eqno">(4.19)<a class="headerlink" href="#equation-eq-eaxample3-zloesung" title="Permalink to this equation">¬∂</a></span>\[
    Y(z) = (1+p)z^{-1} Y(z) + X(z)
\]</div>
<p>Dies ergibt umgeformt</p>
<div class="math notranslate nohighlight" id="equation-eq-eaxample3-zloesung2">
<span class="eqno">(4.20)<a class="headerlink" href="#equation-eq-eaxample3-zloesung2" title="Permalink to this equation">¬∂</a></span>\[
    Y(z) = \frac{X(z)}{1-(1+p)z^{-1}}
\]</div>
<p>Teilt man diese L√∂sung durch <span class="math notranslate nohighlight">\(X(z)\)</span> ergibt sich auf der rechten Seite
der Gleichung den Anteil, der unabh√§ngig vom Eingangssignal ist und nur
das System repr√§sentiert. Der Bruch <span class="math notranslate nohighlight">\(Y(z)/X(z)\)</span> wird zus√§tzlich durch
mit <span class="math notranslate nohighlight">\(H(z)\)</span> abgek√ºrzt.</p>
<div class="math notranslate nohighlight" id="equation-eq-example3-systemfunktion">
<span class="eqno">(4.21)<a class="headerlink" href="#equation-eq-example3-systemfunktion" title="Permalink to this equation">¬∂</a></span>\[
    H(z) = \frac{Y(z)}{X(z)} = \frac{1}{1-(1+p)z^{-1}}
\]</div>
<p>Die Funktion <span class="math notranslate nohighlight">\(H(z)\)</span> wird z-Systemfunktion genannt und beschreibt ein LTI-System vollst√§ndig. Eine andere vollst√§ndige Beschreibung eines LTI-Systems unabh√§ngig vom Eingangssignal war die Impulsantwort <span class="math notranslate nohighlight">\(h(k)\)</span> eines
Systems. Beide Darstellungsarten sind durch die z-Transformation
miteinander verbunden. Es gilt:</p>
<div class="math notranslate nohighlight" id="equation-eq-def-ubertragfunktion">
<span class="eqno">(4.22)<a class="headerlink" href="#equation-eq-def-ubertragfunktion" title="Permalink to this equation">¬∂</a></span>\[
    \mathcal{Z}\{h(k)\} = H(z)
\]</div>
<p><strong>Die z-Transformation der Impulsantwort h(k) ist die Systemfunktion H(z)</strong></p>
<div class="note admonition">
<p class="admonition-title">Beispiel</p>
<p>z-√úbertragungsfunktion<br />
Die z-Transformierte aus dem vorherigen Beispiel war gegeben durch</p>
<div class="math notranslate nohighlight">
\[
Y(z) = 0.2Y(z) z^{-1} - Y(z) z^{-3} + X(z) + 1.2X(z) z^{-1} - 3.2X(z) z^{-2}
\]</div>
<p>die z-Systemfunktion ergibt sich durch wenige Umformungsschritte</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{aligned}
\nonumber
    Y(z)- 0.2Y(z) z^{-1} + Y(z) z^{-3} &amp; = &amp;  X(z) + 1.2X(z) z^{-1} - 3.2X(z) z^{-2}\\\nonumber
    Y(z) \left(1-0.2z^{-1} + z^{-3} \right) &amp;=&amp; X(z) \left(1 +1.2z^{-1} - 3.2 z^{-2} \right)\\
    H(z) = \frac{Y(z)}{X(z)} &amp;= &amp; \frac{1 +1.2z^{-1} - 3.2 z^{-2}}{1-0.2z^{-1} + z^{-3}}\end{aligned}
\end{split}\]</div>
</div>
<p>Die Verkn√ºpfung von <span class="math notranslate nohighlight">\(h(k)\)</span> und dem Eingangssignal <span class="math notranslate nohighlight">\(x(k)\)</span> zum
Ausgangssignal <span class="math notranslate nohighlight">\(y(k)\)</span> erfolgte im Zeitbereich √ºber die Faltung. Bei der
z-Systemfunktion ist die Verkn√ºpfung von Eingang und Ausgang durch
die Multiplikation gegeben. Es gilt also</p>
<div class="math notranslate nohighlight" id="equation-eq-ztrafo-faltungmulti">
<span class="eqno">(4.23)<a class="headerlink" href="#equation-eq-ztrafo-faltungmulti" title="Permalink to this equation">¬∂</a></span>\[
    \mathcal{Z}\{a(k)\ast b(k)\} = A(z) B(z)
\]</div>
<p>Damit haben wir eine M√∂glichkeit
gefunden die eher aufwendige Faltungsumme mit Hilfe der z-Transformation
in eine einfache Multiplikation im z-Bereich zu √ºberf√ºhren. Das
Ausgangssignal erh√§lt man abschlie√üend durch die inverse
z-Transformation des Ausgangssignals <span class="math notranslate nohighlight">\(Y(z)\)</span>. Dieser L√∂sungsweg ist in
<a class="reference internal" href="#fig-schematischezloesungfaltung"><span class="std std-numref">Abbildung 4.4</span></a>  zur Verdeutlichung schematisch
gezeigt.</p>
<div class="figure align-default" id="fig-schematischezloesungfaltung">
<a class="reference internal image-reference" href="_images/SchematischezLoesungFaltung.png"><img alt="_images/SchematischezLoesungFaltung.png" src="_images/SchematischezLoesungFaltung.png" style="width: 50%;" /></a>
<p class="caption"><span class="caption-number">Fig. 4.4 </span><span class="caption-text">Schematische Darstellung zur
Berechnung der Faltungssumme mit Hilfe der
z-Transformation.</span><a class="headerlink" href="#fig-schematischezloesungfaltung" title="Permalink to this image">¬∂</a></p>
</div>
<div class="note admonition">
<p class="admonition-title">Beispiel</p>
<p>Das System ist durch</p>
<div class="math notranslate nohighlight">
\[
y(k) = x(k) -2x(k-1) + x(k-2)
\]</div>
<p>gegeben. Die
z-Transformation f√ºhrt auf eine z-Systemfunktion</p>
<div class="math notranslate nohighlight">
\[
H(z) = 1-2z^{-1} + z^{-2}
\]</div>
<p>F√ºr die Eingangsfolge:</p>
<div class="math notranslate nohighlight">
\[
x(k) = \delta(k) + 2\delta(k-1)  + 3\delta(k-2)  + 4\delta(k-3)  + 5\delta(k-4)
\]</div>
<p>ergibt sich die z-Transformierte zu</p>
<div class="math notranslate nohighlight">
\[
X(z) = 1 + 2z^{-1} + 3z^{-2}+ 4z^{-3}+ 5z^{-4}
\]</div>
<p>Eine Polynommultiplikation f√ºhrt zu der Ausgangs-z-Funktion</p>
<div class="math notranslate nohighlight">
\[
Y(z) = X(z)H(z) = 1 -6 z^{-5} + 5 z^{-6}
\]</div>
<p>Damit ergibt sich f√ºr die
Ausgangsfolge</p>
<div class="math notranslate nohighlight">
\[
y(k) = [1 \:\: 0 \:\: 0 \:\: 0 \:\: 0 \:\: -6 \:\: 5]
\]</div>
<p>bzw.
$<span class="math notranslate nohighlight">\(
y(k) = \delta(k) - 6 \delta(k-5) + 5 \delta(k-6)
\)</span>$</p>
</div>
<p><strong>Die Faltung wird in der z-Ebene zu einer Multiplikation</strong></p>
</div>
<div class="section" id="pol-nullstellenplan">
<h2><span class="section-number">4.6. </span>Pol-Nullstellenplan<a class="headerlink" href="#pol-nullstellenplan" title="Permalink to this headline">¬∂</a></h2>
<p>Nachdem die √Ñquivalenz der Impulsantwort mit der z-Systemfunktion
<span class="math notranslate nohighlight">\(H(z)\)</span> bekannt ist, ist es m√∂glich, Systeme besser zu analysieren. Dazu
schauen wir uns zun√§chst die typische Systemfunktion an.</p>
<div class="math notranslate nohighlight" id="equation-eq-uebertragungsfunktion">
<span class="eqno">(4.24)<a class="headerlink" href="#equation-eq-uebertragungsfunktion" title="Permalink to this equation">¬∂</a></span>\[
 H(z) = \frac{b_0 + b_1z^{-1} + b_2z^{-2}+ \cdots b_M z^{-M}
    }{1 + a_1z^{-1} + a_2z^{-2}+ \cdots a_N z^{-N}}
    = \frac{\displaystyle \sum_{i=0}^M b_iz^{-i}}
    {\displaystyle \sum_{i=0}^N a_i z^{-i}}~mit~a_0 = 1
\]</div>
<p>Unter der Annahme das der Z√§hlergrad <span class="math notranslate nohighlight">\(M\)</span> kleiner oder gleich dem Nennergrad <span class="math notranslate nohighlight">\(N\)</span> ist, handelt es sich um ein kausales System <a class="footnote-reference brackets" href="#id4" id="id2">1</a>. Die Ordnung des Systems wird unter dieser Annahme durch <span class="math notranslate nohighlight">\(N\)</span> angegeben. Im allgemeinen Fall definiert das Maximum von <span class="math notranslate nohighlight">\(N\)</span> und <span class="math notranslate nohighlight">\(M\)</span> die Ordnung des Systems.</p>
<p>Die gebrochen rationale Funktion k√∂nnen auch in der √§quivalenten
Produktform geschrieben werden, wenn alle Nullstellen, des Z√§hler- und
Nennerpolynoms bekannt sind. Die Nullstellen des Nenners bezeichnet man als Polstellen bzw. Pol, da an diesen
Punkten, die √úbertragungsfunktion unendlich wird.</p>
<div class="math notranslate nohighlight" id="equation-eq-uebertragungsfunktion-produktdarstellung">
<span class="eqno">(4.25)<a class="headerlink" href="#equation-eq-uebertragungsfunktion-produktdarstellung" title="Permalink to this equation">¬∂</a></span>\[\begin{split}
\begin{aligned}
 H(z)
 &amp; = &amp; b_0 \frac{(z-n_0)(z-n_1)\cdots(z-n_{M-1})}{(z-p_0)(z-p_1)\cdots(z-p_{N-1})}\\
 &amp; = &amp; b_0 \frac{\displaystyle \prod_{i = 0}^{M-1}(z-n_i)}
 {\displaystyle \prod_{i = 0}^{N-1}(z-p_i)}
 \end{aligned}
\end{split}\]</div>
<p>F√ºr reelle Koeffizienten <span class="math notranslate nohighlight">\(b_i\)</span> und <span class="math notranslate nohighlight">\(a_i\)</span> ergeben sich dabei immer nur
reelle Nullstellen oder konjugiert komplexe Paare.</p>
<div class="note admonition">
<p class="admonition-title">Beispiel</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{aligned}
\nonumber
    H(z) &amp; = &amp; \frac{3+6z^{-1}+3z^{-2}}{1.0000   -1.7119 z^{-1} +   0.8100
    z^{-2}}\\\nonumber
    &amp;=&amp; 3\frac{(z+1)(z+1)}{(z-0.8560 - 0.2781j)(z-0.8560 +
    0.2781j)}\\\nonumber
    &amp;=&amp; 3\frac{(z+1)^2}{(z-0.9e^{j\frac{\pi}{10}})(z-0.9e^{-j\frac{\pi}{10}})}\end{aligned}
\end{split}\]</div>
</div>
<p>Um bestimmte Eigenschaften zu verdeutlichen ist es oft sinnvoll, die
Pole und Nullstellen in der komplexen Ebene einzuzeichnen. Dabei werden
Nullstellen durch ein o und Pole durch ein x markiert. F√ºr das Beispiel
ergibt sich der folgende Pol-Nullstellenplan, wobei ein eventuell
vorhandener Skalierungsfaktor <span class="math notranslate nohighlight">\(b_0\)</span> nicht ber√ºcksichtige wird. Der Pol-
Nullstellenplan ohne die Angabe von <span class="math notranslate nohighlight">\(b_0\)</span> ist deshalb keine vollst√§ndige Beschreibung eines
LTI-Systems.</p>
<div class="cell tag_hide-input tag_remove-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="c1">#-------------------------------------------------------------------------------</span>
<span class="c1"># Demoscript for &quot;Signalverarbeitung 1&quot;</span>
<span class="c1">#</span>
<span class="c1"># Version: 1.0   17.02.2022</span>
<span class="c1"># </span>
<span class="c1"># This software is released as public domain under CC0 1.0</span>
<span class="c1"># https://creativecommons.org/publicdomain/zero/1.0/</span>
<span class="c1">#-------------------------------------------------------------------------------</span>

<span class="c1"># based on https://matplotlib.org/3.1.0/gallery/mplot3d/surface3d_radial.html </span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Dem Polnullstellenplan kann per Rechtsklick eine Nullstelle, und per Linksklick eine Pollstelle hinzugef√ºgt werden. Um eine Pol- / Nullstelle zu l√∂schen muss man w√§hrend man auf sie klickt &#39;Strg&#39; halten. Es werden automatisch die konjugierten Pol- / Nullstellen hinzugef√ºgt und gel√∂scht</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d</span> <span class="kn">import</span> <span class="n">Axes3D</span>
<span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">cm</span>

<span class="c1"># determine where we&#39;re running from and set paths accordingly</span>
<span class="k">try</span><span class="p">:</span> 
    <span class="k">if</span> <span class="n">get_ipython</span><span class="p">()</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;ZMQInteractiveShell&#39;</span><span class="p">:</span>
        <span class="n">prefix</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<span class="k">except</span><span class="p">:</span>
    <span class="n">prefix</span> <span class="o">=</span> <span class="s1">&#39;../../&#39;</span>

<span class="n">matplotlib</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">prefix</span><span class="si">}</span><span class="s1">sv.mplstyle&#39;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">H_from_pole_zero</span><span class="p">(</span><span class="n">C</span><span class="p">):</span>
    <span class="n">zaehler</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">C</span><span class="p">)</span>
    <span class="n">nenner</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">C</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">zeros</span><span class="p">)):</span>
        <span class="n">null</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">C</span> <span class="o">-</span> <span class="n">zeros</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span> <span class="n">C</span> <span class="o">-</span> <span class="n">numpy</span><span class="o">.</span><span class="n">conjugate</span><span class="p">(</span><span class="n">zeros</span><span class="p">[</span><span class="n">idx</span><span class="p">]))</span>
        <span class="n">zaehler</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">zaehler</span><span class="p">,</span> <span class="n">null</span><span class="p">)</span>
        
    <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">poles</span><span class="p">)):</span>
        <span class="n">pole</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">C</span> <span class="o">-</span> <span class="n">poles</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span> <span class="n">C</span> <span class="o">-</span> <span class="n">numpy</span><span class="o">.</span><span class="n">conjugate</span><span class="p">(</span><span class="n">poles</span><span class="p">[</span><span class="n">idx</span><span class="p">]))</span>
        <span class="n">nenner</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">nenner</span><span class="p">,</span> <span class="n">pole</span><span class="p">)</span>

    <span class="n">H</span> <span class="o">=</span> <span class="n">zaehler</span><span class="o">/</span><span class="p">(</span><span class="n">nenner</span><span class="o">+</span><span class="mf">0.0000001</span><span class="p">)</span>
    <span class="n">Z</span> <span class="o">=</span> <span class="mi">20</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">H</span><span class="p">))</span>
    <span class="n">max_val</span> <span class="o">=</span> <span class="mi">60</span>
    <span class="n">Z</span><span class="p">[</span><span class="n">Z</span><span class="o">&gt;</span><span class="n">max_val</span><span class="p">]</span><span class="o">=</span><span class="n">max_val</span>
    <span class="n">Z</span><span class="p">[</span><span class="n">Z</span><span class="o">&lt;-</span><span class="n">max_val</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">max_val</span>
    <span class="k">return</span> <span class="n">Z</span>

<span class="c1"># Create the mesh in polar coordinates and compute corresponding Z.</span>
<span class="n">theta</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">circle</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">theta</span><span class="p">)</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">1.5</span><span class="n">j</span><span class="p">,</span> <span class="mf">1.5</span><span class="n">j</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

<span class="n">poles</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.8560</span> <span class="o">+</span> <span class="mf">0.2781</span><span class="n">j</span><span class="p">]</span>
<span class="n">zeros</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="mi">0</span><span class="n">j</span><span class="p">]</span>
<span class="c1">#poles_conj = [0]*2</span>
<span class="c1">#zeros_conj = [0]*2</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">ax_pz</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">121</span><span class="p">)</span>

<span class="n">ax_pz</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">circle</span><span class="o">.</span><span class="n">real</span><span class="p">,</span> <span class="n">circle</span><span class="o">.</span><span class="n">imag</span><span class="p">)</span>
<span class="n">ax_pz</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;Realteil&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;Imagin√§rteil&#39;</span><span class="p">,</span> 
          <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Pol-Nullstellen-Plan&#39;</span><span class="p">,</span> <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">],</span> <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">])</span>
<span class="n">ax_pz</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">poles</span><span class="p">)):</span>
    <span class="n">ax_pz</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">poles</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">real</span><span class="p">,</span> <span class="n">poles</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">real</span><span class="p">],</span> <span class="p">[</span><span class="n">poles</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">imag</span><span class="p">,</span> <span class="o">-</span><span class="n">poles</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">imag</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
    <span class="n">ax_pz</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">zeros</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">real</span><span class="p">,</span> <span class="n">zeros</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">real</span><span class="p">],</span> <span class="p">[</span><span class="n">zeros</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">imag</span><span class="p">,</span> <span class="o">-</span><span class="n">zeros</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">imag</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>

<span class="n">ax_pz</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="o">-</span><span class="mf">0.95</span><span class="p">,</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span><span class="s2">&quot;2&quot;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">7</span><span class="p">)</span>


<span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">C</span> <span class="o">=</span> <span class="n">X</span> <span class="o">+</span> <span class="n">Y</span>

<span class="n">Z</span> <span class="o">=</span> <span class="n">H_from_pole_zero</span><span class="p">(</span><span class="n">C</span><span class="p">)</span>

<span class="n">Y</span> <span class="o">=</span> <span class="n">Y</span><span class="o">.</span><span class="n">imag</span>

<span class="n">ax_3d</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">122</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
<span class="n">ax_3d</span><span class="o">.</span><span class="n">plot_surface</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">Z</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cm</span><span class="o">.</span><span class="n">coolwarm</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
<span class="n">X_c</span> <span class="o">=</span> <span class="n">circle</span><span class="o">.</span><span class="n">real</span>
<span class="n">Y_c</span> <span class="o">=</span> <span class="n">circle</span><span class="o">.</span><span class="n">imag</span>
<span class="n">Z_c</span> <span class="o">=</span> <span class="n">H_from_pole_zero</span><span class="p">(</span><span class="n">circle</span><span class="p">)</span>

<span class="n">ax_3d</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X_c</span><span class="p">,</span> <span class="n">Y_c</span><span class="p">,</span> <span class="n">Z_c</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>

<span class="n">ax_3d</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">],</span> <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">],</span> <span class="n">zlim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">60</span><span class="p">,</span> <span class="mi">60</span><span class="p">])</span>
<span class="n">ax_3d</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Realteil&#39;</span><span class="p">)</span>
<span class="n">ax_3d</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Imagin√§rteil&#39;</span><span class="p">)</span>
<span class="n">ax_3d</span><span class="o">.</span><span class="n">set_zlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$H$ in dB&#39;</span><span class="p">)</span>

<span class="n">pyplot</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># glue this figure to paste it later (no effect outside of MyST NB)</span>
<span class="kn">from</span> <span class="nn">myst_nb</span> <span class="kn">import</span> <span class="n">glue</span>
<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;PolNullstellenplan&quot;</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="tabbed-set docutils">
<input checked="checked" id="3b45ab54-4988-4c77-b8fd-08312a43e4a1" name="7c355026-aa92-416d-af5e-06cd7313bf2b" type="radio">
</input><label class="tabbed-label" for="3b45ab54-4988-4c77-b8fd-08312a43e4a1">
Buchabbildung</label><div class="tabbed-content docutils">
<div class="figure align-default" id="fig-polnullstellenplan" style="width: 75%">
<div class="cell_output docutils container">
<img alt="_images/ztrafo_10_1.png" src="_images/ztrafo_10_1.png" />
</div>
<p class="caption"><span class="caption-number">Fig. 4.5 </span><span class="caption-text">Pole und Nullstellen in der komplexen
Ebene.</span><a class="headerlink" href="#fig-polnullstellenplan" title="Permalink to this image">¬∂</a></p>
</div>
</div>
<input id="e354efa3-ac04-4928-ba1c-cf0d95625257" name="7c355026-aa92-416d-af5e-06cd7313bf2b" type="radio">
</input><label class="tabbed-label" for="e354efa3-ac04-4928-ba1c-cf0d95625257">
Interaktiv arbeiten</label><div class="tabbed-content docutils">
<ol class="simple">
<li><p>Starten des interaktiven Programms - ‚ÄúZTrafo_Pol_Null_3D.py‚Äù in jupyterbook/code/interactive_programs</p></li>
<li><p>Eigene Pole und Nullstellen per Klick definieren bzw. l√∂schen (zus√§tzlich STRG halten):</p>
<ul class="simple">
<li><p>Rechtsklick: Nullstelle</p></li>
<li><p>Linksklick: Polstelle</p></li>
</ul>
</li>
</ol>
</div>
</div>
<p>Mehrfachnullstellen (oder auch Pole) werden durch eine zus√§tzliche Zahl
gekennzeichnet, hier die zwei f√ºr die doppelte Nullstelle bei <span class="math notranslate nohighlight">\(z = -1\)</span>.
Weiterhin ist der sog. Einheitskreis zu sehen, der den Radius eins
markiert und eine besondere Bedeutung hat.</p>
<p>Zur Verdeutlichung der Auswirkungen von Polen und Nullstellen in der
komplexen Ebene ist auf der rechten Seite in <a class="reference internal" href="#fig-polnullstellenplan"><span class="std std-numref">Abbildung 4.5</span></a> der Betrag der √úbertragungsfunktion in Abh√§ngigkeit vom Real und Imagin√§rteil f√ºr das eben verwendete Beispiel gezeigt (Die Darstellung erfolgt logarithmisch.). Zur Orientierung ist zus√§tzlich der Einheitskreis
eingezeichnet.</p>
<p>Der Einfluss der beide Extremstellen auf den Betrag der
√úbertragungsfunktion ist auf der ganzen z-Ebene sichtbar. Man erkennt
sehr deutlich, wie die Pole zu einem unendlichen Betrag f√ºhren, w√§hrend
die doppelte Nullstelle den Betrag zu Null (<span class="math notranslate nohighlight">\(-\infty in dB\)</span>) werden l√§sst.</p>
<p>Welche Auswirkungen haben nun Polstellen auf die Systemeigenschaften und
insbesondere auf das Verhalten im Zeitbereich. Grunds√§tzlich lassen sich
die komplexen Pole immer auch in der Polarschreibweise (Radius und
Phase) angeben.</p>
<p>Ausgehend von einem System mit nur einem Pol (komplexwertiges
System)</p>
<div class="math notranslate nohighlight" id="equation-eq-ztrafo-erklaerungpollage">
<span class="eqno">(4.26)<a class="headerlink" href="#equation-eq-ztrafo-erklaerungpollage" title="Permalink to this equation">¬∂</a></span>\[
    H(z) = \frac{1}{1-re^{j\varphi}z^{-1}}
\]</div>
<p>ergibt sich bei der R√ºcktransformation (Nutzung der Korrespondenztabelle) in den
Zeitbereich</p>
<div class="math notranslate nohighlight" id="equation-eq-ztrafo-erklaerungpollagezeitbereich">
<span class="eqno">(4.27)<a class="headerlink" href="#equation-eq-ztrafo-erklaerungpollagezeitbereich" title="Permalink to this equation">¬∂</a></span>\[
    h(k) = \gamma(k) r^k e^{j\varphi k}
\]</div>
<p>Interpretiert man Gleichung <a class="reference internal" href="#equation-eq-ztrafo-erklaerungpollagezeitbereich">(4.27)</a> so ist zu erkennen, dass die Impulsantwort aus einer komplexen Schwingung (<span class="math notranslate nohighlight">\(e^{j\varphi k}\)</span>) und einem Faktor besteht, der die Amplitude √§ndert. Dieser Amplitudenfaktor wird als Einh√ºllende der komplexen Schwingung
bezeichnet. Die Frequenz der Schwingung ist durch den Polwinkel
<span class="math notranslate nohighlight">\(\varphi\)</span> definiert und die Form der Einh√ºllenden durch den Radius <span class="math notranslate nohighlight">\(r\)</span>.
F√ºr <span class="math notranslate nohighlight">\(r&lt;1\)</span> ergibt sich eine ged√§mpfte Exponentialfunktion. Bei <span class="math notranslate nohighlight">\(r=1\)</span> ist
die komplexe Schwingung unged√§mpft und bei <span class="math notranslate nohighlight">\(r&gt;1\)</span> handelt es sich um eine
aufklingende, also mit der Zeit st√§rker werdende Schwingung.</p>
<p>Dies ist in der <a class="reference internal" href="#fig-pollagen"><span class="std std-numref">Abbildung 4.6</span></a> nochmals verdeutlicht. Die Pollage a) ist
ein Pol auf der reellen Ache mit einem Radius von <span class="math notranslate nohighlight">\(r = 0.96\)</span> (Die eingezeichneten Pollagen sind zur Verdeutlichung skaliert). Die
dazugeh√∂rige Schwingung ist eine abklingende Exponentialfunktion ohne
Schwingungsanteil. Ist der Radius gr√∂√üer eins (b) <span class="math notranslate nohighlight">\(r= 1.01\)</span>) ergibt sich
eine aufklingende Exponentialfunktion. Verschiebt man den Pol auf dem
Radius <span class="math notranslate nohighlight">\(r=
0.96\)</span> auf einen Polwinkel <span class="math notranslate nohighlight">\(\varphi = \pi/10\)</span>, so ergibt sich eine
exponentiell abklingende Schwingung (siehe c)). Bei einem Radius gr√∂√üer
eins, eine aufklingende Schwingung (d). Die Drehung ist bei
<span class="math notranslate nohighlight">\(\varphi = 3\pi / 4\)</span> kaum noch zu erkennen (e), w√§hrend die Frequenz
<span class="math notranslate nohighlight">\(\varphi = \pi\)</span> erneut zu einer reellen Folge f√ºhrt mit wechselndem
Vorzeichen. Der Radius entscheidet √ºber das Abklingverhalten (g,f). Die
Drehrichtung wird durch die Pollage in der oberen oder unteren Halbebene
angegeben.</p>
<div class="figure align-default" id="fig-pollagen">
<a class="reference internal image-reference" href="_images/PolLagen.png"><img alt="_images/PolLagen.png" src="_images/PolLagen.png" style="width: 80%;" /></a>
<p class="caption"><span class="caption-number">Fig. 4.6 </span><span class="caption-text">M√∂gliche Pollagen und die dazugeh√∂rigen komplexen Schwingungen im Zeitbereich (angelehnt an <span id="id3">[<a class="reference internal" href="zbibliography.html#id190">GRS13</a>]</span>).</span><a class="headerlink" href="#fig-pollagen" title="Permalink to this image">¬∂</a></p>
</div>
<p>Bei konjugiert komplexen Polpaaren heben sich durch die gegensinnigen
Drehrichtungen die Imagin√§ranteile auf und die Impulsantwort <span class="math notranslate nohighlight">\(h(k)\)</span> ist
rein reellwertig. Die ausgebildeten Schwingungen entsprechen ged√§mpften
oder aufklingenden Cosinusfunktionen der Frequenz <span class="math notranslate nohighlight">\(\varphi\)</span>.</p>
<p>Es gilt f√ºr konjugiert (<span class="math notranslate nohighlight">\(^{\ast}\)</span>) komplexe Polpaare:</p>
<div class="math notranslate nohighlight">
\[
\frac{Az}{z-a} + \frac{A^{\ast}z}{z-a^{\ast}} ;\bullet \hskip-1ex -\hskip-1.2ex -\hskip-1.2ex- \hskip-1ex \circ\; 2|A||a|^k\cos(arg\{a\}k + arg\{A\})\gamma(k)
\]</div>
<p><span class="math notranslate nohighlight">\(arg\{x\}\)</span> ist das Argument (Winkel) von der komplexen Zahl <span class="math notranslate nohighlight">\(x\)</span>.</p>
<div class="note admonition">
<p class="admonition-title">Beispiel</p>
<p>Ausgehend von dem System</p>
<div class="math notranslate nohighlight">
\[
H(z) = \frac{z^2}{(z-0.9e^{j\frac{\pi}{10}})(z-0.9e^{-j\frac{\pi}{10}})}
\]</div>
<p>ergibt sich f√ºr die Aufspaltung</p>
<div class="math notranslate nohighlight">
\[
H(z) = \frac{Az}{z-0.9e^{j\frac{\pi}{10}}} + \frac{A^{\ast}z}{z-0.9e^{-j\frac{\pi}{10}}}
\]</div>
<p>mit</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{aligned}
A &amp;=&amp; (z-0.9e^{j\frac{\pi}{10}})\widetilde{H}(z)\Bigg|_{z = 0.9e^{j\frac{\pi}{10}}}\\
    &amp; = &amp; \frac{z}{z-0.9e^{-j\frac{\pi}{10}}}\Bigg|_{z = 0.9e^{j\frac{\pi}{10}}}\\
    &amp; = &amp; \frac{0.9e^{j\frac{\pi}{10}}}{0.9e^{j\frac{\pi}{10}}-0.9e^{-j\frac{\pi}{10}}}\\
    &amp; = &amp; -j\frac{e^{j\frac{\pi}{10}}}{2\sin \frac{\pi}{10}}\end{aligned}
\end{split}\]</div>
<p>Die Impulsantwort ist also durch</p>
<div class="math notranslate nohighlight">
\[
h(k) = 2\cdot 1.618 \cdot 0.9^k \cos\left(\frac{\pi}{10}k +\left(-\frac{\pi}{2} + \frac{\pi}{10}\right)\right)\gamma(k)
\]</div>
<p>gegeben und wird in <a class="reference internal" href="#fig-bspkonjkomplexpole"><span class="std std-numref">Abbildung 4.7</span></a> bis <span class="math notranslate nohighlight">\(k = 49\)</span> gezeigt.</p>
</div>
<div class="cell tag_hide-input tag_remove-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="c1">#-------------------------------------------------------------------------------</span>
<span class="c1"># Demoscript for &quot;Signalverarbeitung 1&quot;</span>
<span class="c1">#</span>
<span class="c1"># Version: 1.0   17.02.2022</span>
<span class="c1"># </span>
<span class="c1"># This software is released as public domain under CC0 1.0</span>
<span class="c1"># https://creativecommons.org/publicdomain/zero/1.0/</span>
<span class="c1">#-------------------------------------------------------------------------------</span>

<span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span>

<span class="c1"># determine where we&#39;re running from and set paths accordingly</span>
<span class="k">try</span><span class="p">:</span> 
    <span class="k">if</span> <span class="n">get_ipython</span><span class="p">()</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;ZMQInteractiveShell&#39;</span><span class="p">:</span>
        <span class="n">prefix</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<span class="k">except</span><span class="p">:</span>
    <span class="n">prefix</span> <span class="o">=</span> <span class="s1">&#39;../../&#39;</span>

<span class="n">matplotlib</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">prefix</span><span class="si">}</span><span class="s1">sv.mplstyle&#39;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">impulse</span><span class="p">(</span><span class="n">num_samples</span><span class="p">,</span> <span class="n">pole</span><span class="p">):</span>
    <span class="n">r_pole</span> <span class="o">=</span> <span class="p">(</span><span class="n">pole</span><span class="o">.</span><span class="n">real</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">pole</span><span class="o">.</span><span class="n">imag</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5</span> 
    <span class="n">phi_pole</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">pole</span><span class="p">)</span> <span class="c1"># in rad/s</span>
    <span class="n">A</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">phi_pole</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">phi_pole</span><span class="p">))</span>
    <span class="n">r_A</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
    <span class="n">phi_A</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">num_samples</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_samples</span><span class="p">):</span>
        <span class="n">y</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">r_A</span> <span class="o">*</span> <span class="n">r_pole</span><span class="o">**</span><span class="n">idx</span> <span class="o">*</span> <span class="n">numpy</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">phi_pole</span><span class="o">*</span><span class="n">idx</span> <span class="o">+</span> <span class="n">phi_A</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">y</span>

<span class="k">def</span> <span class="nf">onclick</span><span class="p">(</span><span class="n">event</span><span class="p">):</span>
    <span class="n">ax_pz</span><span class="o">.</span><span class="n">lines</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span>
    <span class="n">ax_imp</span><span class="o">.</span><span class="n">cla</span><span class="p">()</span>

    <span class="n">pole</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">xdata</span> <span class="o">+</span> <span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">event</span><span class="o">.</span><span class="n">ydata</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">impulse</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="n">pole</span><span class="p">)</span>
    
    <span class="n">ax_pz</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">pole</span><span class="o">.</span><span class="n">real</span><span class="p">,</span> <span class="n">pole</span><span class="o">.</span><span class="n">real</span><span class="p">],</span> <span class="p">[</span><span class="n">pole</span><span class="o">.</span><span class="n">imag</span><span class="p">,</span> <span class="o">-</span><span class="n">pole</span><span class="o">.</span><span class="n">imag</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
    <span class="n">ax_imp</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">use_line_collection</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">ax_imp</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Folgenkindex k -&gt;&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Amplitude&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Impulsantwort des Systems&#39;</span><span class="p">,</span> <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_samples</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="n">y</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">y</span><span class="o">.</span><span class="n">max</span><span class="p">()])</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw_idle</span><span class="p">()</span>



<span class="n">theta</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">circle</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">theta</span><span class="p">)</span>
<span class="n">pole</span> <span class="o">=</span> <span class="mf">0.8560</span> <span class="o">+</span> <span class="mf">0.2781</span><span class="n">j</span>

<span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax_pz</span><span class="p">,</span> <span class="n">ax_imp</span><span class="p">)</span><span class="o">=</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

<span class="c1"># Pole-Zero Plot</span>
<span class="n">ax_pz</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>
<span class="n">ax_pz</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;Realteil&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;Imagin√§rteil&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Pol-Nullstellen-Plan&#39;</span><span class="p">,</span> <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">],</span> <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">])</span>
<span class="n">ax_pz</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">circle</span><span class="o">.</span><span class="n">real</span><span class="p">,</span> <span class="n">circle</span><span class="o">.</span><span class="n">imag</span><span class="p">)</span>
<span class="n">ax_pz</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">pole</span><span class="o">.</span><span class="n">real</span><span class="p">,</span> <span class="n">pole</span><span class="o">.</span><span class="n">real</span><span class="p">],</span> <span class="p">[</span><span class="n">pole</span><span class="o">.</span><span class="n">imag</span><span class="p">,</span> <span class="o">-</span><span class="n">pole</span><span class="o">.</span><span class="n">imag</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>

<span class="n">num_samples</span> <span class="o">=</span> <span class="mi">50</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">impulse</span><span class="p">(</span><span class="n">num_samples</span><span class="p">,</span> <span class="n">pole</span><span class="p">)</span>


<span class="c1"># Impulse Plot</span>
<span class="n">ax_imp</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">use_line_collection</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ax_imp</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;Folgenkindex $k \rightarrow$ &#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Amplitude&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Impulsantwort des Systems&#39;</span><span class="p">,</span> <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_samples</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>

<span class="n">cid</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">mpl_connect</span><span class="p">(</span><span class="s1">&#39;button_press_event&#39;</span><span class="p">,</span> <span class="n">onclick</span><span class="p">)</span>

<span class="n">pyplot</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># glue this figure to paste it later (no effect outside of MyST NB)</span>
<span class="kn">from</span> <span class="nn">myst_nb</span> <span class="kn">import</span> <span class="n">glue</span>
<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;BspKonjKomplexPole&quot;</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="tabbed-set docutils">
<input checked="checked" id="893c7d32-2c20-417f-925a-10a1a978ec93" name="e3c67170-7e2e-4874-8aa4-67d54a979a42" type="radio">
</input><label class="tabbed-label" for="893c7d32-2c20-417f-925a-10a1a978ec93">
Buchabbildung</label><div class="tabbed-content docutils">
<div class="figure align-default" id="fig-bspkonjkomplexpole" style="width: 75%">
<div class="cell_output docutils container">
<img alt="_images/ztrafo_17_1.png" src="_images/ztrafo_17_1.png" />
</div>
<p class="caption"><span class="caption-number">Fig. 4.7 </span><span class="caption-text">Beispiel der Impulsantwort eines Systems mit konjugiert komplexen Polpaar.</span><a class="headerlink" href="#fig-bspkonjkomplexpole" title="Permalink to this image">¬∂</a></p>
</div>
</div>
<input id="b89d4ef5-d930-4ea3-823f-d674654e792d" name="e3c67170-7e2e-4874-8aa4-67d54a979a42" type="radio">
</input><label class="tabbed-label" for="b89d4ef5-d930-4ea3-823f-d674654e792d">
Interaktiv arbeiten</label><div class="tabbed-content docutils">
<ol class="simple">
<li><p>Starten des interaktiven Programms - ‚ÄúZTrafo_Pol_Null_Impulsantwort.py‚Äù in jupyterbook/code/interactive_programs</p></li>
<li><p>Per Linksklick neue Polstelle definieren</p></li>
</ol>
</div>
</div>
</div>
<div class="section" id="stabilitat">
<h2><span class="section-number">4.7. </span>Stabilit√§t<a class="headerlink" href="#stabilitat" title="Permalink to this headline">¬∂</a></h2>
<p>Mit den Erkl√§rungen f√ºr <a class="reference internal" href="#fig-pollagen"><span class="std std-numref">Abbildung 4.6</span></a> ist die Frage nach einem Stabilit√§tstest f√ºr kausale LTI-Systeme recht einfach zu beantworten. Da alle Systeme mit Polradien gr√∂√üer eins aufklingende Schwingungen erzeugen sind die dazugeh√∂rigen Impulsantworten nicht endlich. Auf einen endlichen Impuls reagiert das System mit einer unendlichen Ausgangsgr√∂√üe. Damit ist die BIBO-Bedingung nicht mehr erf√ºllt.</p>
<p><strong>Stabile, kausale Systeme haben nur Pole innerhalb des
Einheitkreises.</strong></p>
<p><strong>Quasistabil sind Systeme mit einfachen Polen auf dem Einheitskreis</strong></p>
<p>Allgemein l√§sst sich sagen, dass Systeme deren z-Konvergenzgebiet den
Einheitskreis mit einschlie√üen stabil sind. Betrachtet man noch einmal
die Beispiele f√ºr z-Transformation und des dazugeh√∂rigen
Konvergenzgebietes auf Seite , so wird deutlich, dass die kausale Folge
ein stabiles System darstellt, w√§hrend die nicht-kausale Folge instabil
ist. Man kann dies auch daran erkennen, dass die Folge mit wachsendem
<span class="math notranslate nohighlight">\(k\)</span> gr√∂√üer wird.</p>
<p>F√ºr LTI-Systeme ergibt sich als Kriterium f√ºr die BIBO-Stabilit√§t.</p>
<div class="math notranslate nohighlight" id="equation-eq-bibo-integral">
<span class="eqno">(4.28)<a class="headerlink" href="#equation-eq-bibo-integral" title="Permalink to this equation">¬∂</a></span>\[
    \int_{-\infty}^{\infty} |h(t)|^2 dt &lt; \infty
\]</div>
<p>bzw. f√ºr diskrete Systeme gilt</p>
<div class="math notranslate nohighlight" id="equation-eq-bibo-diskret">
<span class="eqno">(4.29)<a class="headerlink" href="#equation-eq-bibo-diskret" title="Permalink to this equation">¬∂</a></span>\[
    \sum_{k = -\infty}^{\infty}|h(k)|^2 &lt; \infty
\]</div>
<div class="section" id="stabilitat-eines-systems-2-ordnung">
<h3><span class="section-number">4.7.1. </span>Stabilit√§t eines Systems 2. Ordnung<a class="headerlink" href="#stabilitat-eines-systems-2-ordnung" title="Permalink to this headline">¬∂</a></h3>
<p>Systeme zweiter Ordnung sind in der digitalen Signalverarbeitung ein
wichtiger Grundbaustein. Es ist deshalb interessant allgemein die
Stabilit√§tsbedingungen zu berechnen. Das System ist durch</p>
<div class="math notranslate nohighlight">
\[
H(z)=\frac{1}{1+a_{1}z^{-1}+a_{2}z^{-2}}
\]</div>
<p>gegeben. Um die Polstellen
des Polynoms zu berechnen, muss</p>
<div class="math notranslate nohighlight">
\[
z^{2}+a_{1}z+a_{2}=0
\]</div>
<p>mit der
bekannten pq-Formel</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{aligned}
    z_{1}&amp; = &amp;-\frac{a_{1}}{2}+\sqrt{\frac{a_{1}^{2}}{4}-a_{2}}\\
    z_{2}&amp; = &amp;-\frac{a_{1}}{2}-\sqrt{\frac{a_{1}^{2}}{4}-a_{2}}\end{aligned}
    \end{split}\]</div>
<p>berechnet werden.</p>
<p>Die Stabilit√§t ist immer f√ºr einen Betrag von <span class="math notranslate nohighlight">\(\left|z\right|&lt;1\)</span>
gesichert. Welche Bedingungen m√ºssen f√ºr die Koeffizienten <span class="math notranslate nohighlight">\(a_1\)</span> und
<span class="math notranslate nohighlight">\(a_2\)</span> gelten?</p>
<p>Zur L√∂sung nehmen wir zun√§chst eine Fallunterscheidung vor:</p>
<ol class="simple">
<li><p>F√ºr die komplexwertige L√∂sung <span class="math notranslate nohighlight">\(a_{2}&gt;\frac{a_{1}^{2}}{4}\)</span> ergibt
sich durch die Nebenbedingung, dass man <span class="math notranslate nohighlight">\(\sqrt{-1} = j\)</span> vor die
Wurzel ziehen kann und sich somit die Vorzeichen umdrehen.
<span class="math notranslate nohighlight">\(z=-\frac{a_{1}}{2} \pm j \sqrt{a_{2}-\frac{a_{1}^{2}}{4}}\)</span></p></li>
</ol>
<p>Berechnet man den Betrag ergibt sich</p>
<div class="math notranslate nohighlight">
\[\begin{split}
    \begin{aligned}
        \left|z\right| &amp; = &amp; \sqrt{\frac{a_{1}^{2}}{4}+a_{2}-\frac{a_{1}^{2}}{4}}\\
        &amp; = &amp; \sqrt{a_{2}}
        \end{aligned}
\end{split}\]</div>
<p>Da f√ºr ein stabiles System <span class="math notranslate nohighlight">\(\left|z\right|&lt;1\)</span>
gelten muss, gilt als erste Bedingung, dass auch <span class="math notranslate nohighlight">\(a^2_{2}&lt;1\)</span> sein
muss</p>
<ol>
<li><p>F√ºr die reelwertige L√∂sung gilt <span class="math notranslate nohighlight">\(a_{2}&lt;\frac{a_{1}^{2}}{4}\)</span>:<br />
Es ergibt sich damit die folgende Ungleichung.</p>
<div class="math notranslate nohighlight">
\[
    -1 &lt; -\frac{a_{1}}{2} \pm \underbrace{\sqrt{\frac{a_{1}^{2}}{4}-a_{2}}}_{&gt;0} &lt; 1
    \]</div>
<p>L√∂st man diese Ungleichung zun√§chst f√ºr das erste
Ungleichheitszeichen und nutzt die negative L√∂sung, da diese ja
immer kleiner ist als die positive L√∂sung</p>
<div class="math notranslate nohighlight">
\[
    -1&lt;-\frac{a_{1}}{2} - \sqrt{\frac{a_{1}^{2}}{4}-a_{2}}
    \]</div>
<p>ergibt
sich (zun√§chst Multiplikation mit -1, danach quadrieren und
ausrechnen)
$<span class="math notranslate nohighlight">\(
\begin{aligned}
        -1+\frac{a_{1}}{2} &amp; &lt; &amp; - \sqrt{\frac{a_{1}^{2}}{4}-a_{2}}\\
        \left(1-\frac{a_{1}}{2}\right)^{2}&amp; &gt; &amp; \frac{a_{1}^{2}}{4}-a_{2}\\
        1-2\frac{a_{1}}{2}+\frac{a_{1}^{2}}{4}&amp; &gt; &amp; \frac{a_{1}^{2}}{4}-a_{2}\\
        1-a_1 &amp;  &gt;  &amp; -a_2 \\
        a_{1} &amp; &lt;  &amp; a_{2}+1
    \end{aligned}
\)</span>$
F√ºr das zweite Ungleichheitszeichen gilt
entsprechendes. Die zweite Bedingung lautet</p>
<div class="math notranslate nohighlight" id="equation-eq-sos-ungleichung2">
<span class="eqno">(4.30)<a class="headerlink" href="#equation-eq-sos-ungleichung2" title="Permalink to this equation">¬∂</a></span>\[
        a_1 &gt; -a_2 -1
    \]</div>
</li>
</ol>
<p>Fasst man diese Bedingungen zusammen, ergibt sich f√ºr <span class="math notranslate nohighlight">\(a_2\)</span> eine untere
Grenze von <span class="math notranslate nohighlight">\(a_2&gt;-1\)</span>. Alles zusammen beschreibt ein Dreieck, dass als
Stabilit√§tsdreieck f√ºr kausales System 2. Ordnung bezeichnet wird (siehe
<a class="reference internal" href="#fig-stabildreieck"><span class="std std-numref">Abbildung 4.8</span></a>).</p>
<div class="cell tag_hide-input tag_remove-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="c1">#-------------------------------------------------------------------------------</span>
<span class="c1"># Demoscript for &quot;Signalverarbeitung 1&quot;</span>
<span class="c1">#</span>
<span class="c1"># Version: 1.0   17.02.2022</span>
<span class="c1"># </span>
<span class="c1"># This software is released as public domain under CC0 1.0</span>
<span class="c1"># https://creativecommons.org/publicdomain/zero/1.0/</span>
<span class="c1">#-------------------------------------------------------------------------------</span>

<span class="c1"># This script creates an interactive graphic, where the user can set a1 and a2 coeffitients by clicking a point in left graph. The right graph will show the corresponding impulse response of the defined system</span>

<span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="kn">import</span> <span class="nn">numpy</span> 
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span>

<span class="c1"># determine where we&#39;re running from and set paths accordingly</span>
<span class="k">try</span><span class="p">:</span> 
    <span class="k">if</span> <span class="n">get_ipython</span><span class="p">()</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;ZMQInteractiveShell&#39;</span><span class="p">:</span>
        <span class="n">prefix</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<span class="k">except</span><span class="p">:</span>
    <span class="n">prefix</span> <span class="o">=</span> <span class="s1">&#39;../../&#39;</span>

<span class="n">matplotlib</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">prefix</span><span class="si">}</span><span class="s1">sv.mplstyle&#39;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">impulse</span><span class="p">(</span><span class="n">num_samples</span><span class="p">,</span> <span class="n">a2</span><span class="p">,</span> <span class="n">a1</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;calculates the impulse response of length num_samles for the two recursive factors a1, and a2&#39;&#39;&#39;</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">num_samples</span><span class="p">)</span>
    <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">num_samples</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_samples</span><span class="p">):</span>
        <span class="n">y</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">-</span> <span class="n">a1</span><span class="o">*</span><span class="n">y</span><span class="p">[</span><span class="n">idx</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">a2</span><span class="o">*</span><span class="n">y</span><span class="p">[</span><span class="n">idx</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">y</span>
    
<span class="k">def</span> <span class="nf">onclick</span><span class="p">(</span><span class="n">event</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;on click the mark is set in the stability triangle and the resulting impulse response is calculated and displayed&#39;&#39;&#39;</span>
    <span class="n">a1</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">ydata</span>
    <span class="n">a2</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">xdata</span>
    <span class="n">ax_stab</span><span class="o">.</span><span class="n">lines</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">a2</span><span class="p">,</span> <span class="n">a1</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">impulse</span><span class="p">(</span><span class="n">num_samples</span><span class="p">,</span> <span class="n">a2</span><span class="p">,</span> <span class="n">a1</span><span class="p">)</span>
    <span class="n">ax_impuls</span><span class="o">.</span><span class="n">cla</span><span class="p">()</span>
    <span class="n">ax_impuls</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">use_line_collection</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">ax_impuls</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Folgenkindex k -&gt;&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Amplitude&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Impulsantwort des Systems y[k] = x[k] - </span><span class="si">{</span><span class="n">a1</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">*y[k-1] - </span><span class="si">{</span><span class="n">a2</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">*y[k-2]&#39;</span><span class="p">,</span> <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_samples</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="n">y</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">y</span><span class="o">.</span><span class="n">max</span><span class="p">()])</span>
    <span class="n">pyplot</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw_idle</span><span class="p">()</span>

<span class="c1"># creates triangle</span>
<span class="n">edges</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]])</span>
<span class="n">triangle</span> <span class="o">=</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">Polygon</span><span class="p">(</span><span class="n">edges</span><span class="p">[:],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">)</span>

<span class="c1"># coefficient values</span>
<span class="n">a1</span> <span class="o">=</span> <span class="mf">0.6</span>
<span class="n">a2</span> <span class="o">=</span> <span class="mf">0.9</span>

<span class="c1"># subplot figure</span>
<span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax_stab</span><span class="p">,</span> <span class="n">ax_impuls</span><span class="p">)</span> <span class="o">=</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

<span class="c1"># Stability Plot</span>
<span class="n">ax_stab</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">triangle</span><span class="p">)</span>
<span class="n">ax_stab</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$a_2$&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$a_1$&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Stabilit√§tsdreieck&#39;</span><span class="p">,</span> <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="n">ax_stab</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">a2</span><span class="p">,</span> <span class="n">a1</span><span class="p">,</span> <span class="s1">&#39;X&#39;</span><span class="p">)</span>

<span class="c1"># Impulse Plot</span>
<span class="n">num_samples</span> <span class="o">=</span> <span class="mi">50</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">impulse</span><span class="p">(</span><span class="n">num_samples</span><span class="p">,</span> <span class="n">a1</span><span class="p">,</span> <span class="n">a2</span><span class="p">)</span>
<span class="n">ax_impuls</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">use_line_collection</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ax_impuls</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;Folgenkindex k $\rightarrow$&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Amplitude&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Impulsantwort des Systems </span><span class="se">\n</span><span class="s1"> y[k] = x[k] - </span><span class="si">{</span><span class="n">a1</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">*y[k-1] - </span><span class="si">{</span><span class="n">a2</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">*y[k-2]&#39;</span><span class="p">,</span> <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">num_samples</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>

<span class="c1"># Execute onclick when button is pressed</span>
<span class="n">cid</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">mpl_connect</span><span class="p">(</span><span class="s1">&#39;button_press_event&#39;</span><span class="p">,</span> <span class="n">onclick</span><span class="p">)</span>
<span class="n">pyplot</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

<span class="n">pyplot</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># glue this figure to paste it later (no effect outside of MyST NB)</span>
<span class="kn">from</span> <span class="nn">myst_nb</span> <span class="kn">import</span> <span class="n">glue</span>
<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;Stabildreieck&quot;</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="tabbed-set docutils">
<input checked="checked" id="6f928252-87fc-4809-bf85-2f46bbb35203" name="d88b5dbc-b9bc-4ea1-865d-4ba545d41fb3" type="radio">
</input><label class="tabbed-label" for="6f928252-87fc-4809-bf85-2f46bbb35203">
Buchabbildung</label><div class="tabbed-content docutils">
<div class="figure align-default" id="fig-stabildreieck" style="width: 75%">
<div class="cell_output docutils container">
<img alt="_images/ztrafo_20_1.png" src="_images/ztrafo_20_1.png" />
</div>
<p class="caption"><span class="caption-number">Fig. 4.8 </span><span class="caption-text">Stabilit√§tsdreieck f√ºr Systeme zweiter
Ordnung mit den Koeffizienten <span class="math notranslate nohighlight">\(a_1\)</span> und <span class="math notranslate nohighlight">\(a_2\)</span>.</span><a class="headerlink" href="#fig-stabildreieck" title="Permalink to this image">¬∂</a></p>
</div>
</div>
<input id="6d50cbc8-89bf-4f67-bd21-ce9e455d0581" name="d88b5dbc-b9bc-4ea1-865d-4ba545d41fb3" type="radio">
</input><label class="tabbed-label" for="6d50cbc8-89bf-4f67-bd21-ce9e455d0581">
Interaktiv arbeiten</label><div class="tabbed-content docutils">
<ol class="simple">
<li><p>Starten des interaktiven Programms - ‚ÄúSignale_Stabilit√§tsdreieck.py‚Äù in jupyterbook/code/interactive_programs</p></li>
<li><p>Per Linsklick Punkt im Dreieck ausw√§hlen</p></li>
</ol>
</div>
</div>
</div>
</div>
<div class="section" id="interaktive-visualisierung-der-z-transformation">
<h2><span class="section-number">4.8. </span>Interaktive Visualisierung der z-Transformation<a class="headerlink" href="#interaktive-visualisierung-der-z-transformation" title="Permalink to this headline">¬∂</a></h2>
<p>F√ºr die Visualisierung der Interaktion von z-Transformation, dem im n√§chsten Kapitel vorgestellten Pol-\Nullstellenplan und den dazugeh√∂rigen √úbertragungsfunktionen steht auf</p>
<p><a class="reference external" href="https://www.kvraudio.com/product/filterdemystifier-by-jadehochschule">https://www.kvraudio.com/product/filterdemystifier-by-jadehochschule</a></p>
<p>ein Audio-Plugin (VST und AU) zur Verf√ºgung, dass zus√§tzlich auch die Wirkung
auf Audio-Signale zeigt. Der Source-Code ist ebenfalls √∂ffentlich (<a class="reference external" href="https://github.com/ArnoSchiller/FilterDeMystifier">https://github.com/ArnoSchiller/FilterDeMystifier</a>)</p>
<hr class="footnotes docutils" />
<dl class="footnote brackets">
<dt class="label" id="id4"><span class="brackets"><a class="fn-backref" href="#id2">1</a></span></dt>
<dd><p>W√ºrde gelten <span class="math notranslate nohighlight">\(M&gt;N\)</span> k√∂nnte man durch Polynomdivision eine
√úbertragungsfunktion erhalten, die aus einem simplen Polynom und
einer gebrochen rationalen Funktion mit <span class="math notranslate nohighlight">\(M\leq N\)</span> besteht, wobei das
Polynom ein Polynom in <span class="math notranslate nohighlight">\(z\)</span> und nicht in <span class="math notranslate nohighlight">\(z^{-1}\)</span> w√§re und somit bei
einer z-R√ºcktransformation auf einen nicht-kausalen Anteil f√ºhren
w√ºrde.</p>
</dd>
</dl>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
            



<div class='prev-next-bottom'>
    
    <div id="prev">
        <a class="left-prev" href="systeme.html" title="previous page">
            <i class="prevnext-label fas fa-angle-left"></i>
            <div class="prevnext-info">
                <p class="prevnext-label">previous</p>
                <p class="prevnext-title"><span class="section-number">3. </span>Systeme</p>
            </div>
        </a>
    </div>
     <div id="next">
        <a class="right-next" href="spektren.html" title="next page">
            <div class="prevnext-info">
                <p class="prevnext-label">next</p>
                <p class="prevnext-title"><span class="section-number">5. </span>Spektren</p>
            </div>
            <i class="prevnext-label fas fa-angle-right"></i>
        </a>
     </div>

</div>
        
        </div>
    </div>
    <footer class="footer">
    <div class="container">
      <p>
        
          By Joerg Bitzer<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>