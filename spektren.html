
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>6. Spektren &#8212; Signalverarbeitung 1</title>
    
  <link rel="stylesheet" href="_static/css/index.f658d18f9b420779cfdf24aa0a7e2d77.css">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/sphinx-book-theme.37f24b989f4638ff9c27c22dc7559d4f.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.d3f166471bb80abb5163.js">

    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.7d483ff0a819d6edff12ce0b1ead3928.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="7. Filter" href="filter.html" />
    <link rel="prev" title="5. z-Transformation" href="ztrafo.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="index.html">
  
  
  <h1 class="site-logo" id="site-title">Signalverarbeitung 1</h1>
  
</a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="intro.html">
   Signalverarbeitung 1
  </a>
 </li>
</ul>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="grundlagen.html">
   1. Einführung
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="signale.html">
   2. Signale
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="systeme.html">
   3. Systeme
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="analog.html">
   4. Analoge Signalverarbeitung
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ztrafo.html">
   5. z-Transformation
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   6. Spektren
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="filter.html">
   7. Filter
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="mathe.html">
   8. Mathematische Methoden
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="zbibliography.html">
   9. Literaturverzeichnis
  </a>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/spektren.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://gitlab.gwdg.de/joerg.bitzer/scriptsv/-/tree/master"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://gitlab.gwdg.de/joerg.bitzer/scriptsv/-/tree/master/issues/new?title=Issue%20on%20page%20%2Fspektren.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>


            <!-- Full screen (wrap in <a> to have style consistency -->
            <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                    data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                    title="Fullscreen mode"><i
                        class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#einfluss-der-pole-und-nullstellen-auf-die-ubertragungsfunktion">
   6.1. Einfluss der Pole und Nullstellen auf die Übertragungsfunktion
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#diskrete-fourier-transformation">
   6.2. Diskrete Fourier-Transformation
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#eigenschaften">
   6.3. Eigenschaften
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#zusammenhang-dtft-und-dft">
     6.3.1. Zusammenhang DTFT und DFT
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#symmetrien-der-dft">
     6.3.2. Symmetrien der DFT
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#spektren-reeller-gerader-folgen">
       6.3.2.1. Spektren reeller gerader Folgen
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#rechenregeln">
     6.3.3. Rechenregeln
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#linearitat">
       6.3.3.1. Linearität
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#faltung">
       6.3.3.2. Faltung
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#theorem-von-parseval">
       6.3.3.3. Theorem von Parseval
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#effiziente-implementierung">
     6.3.4. Effiziente Implementierung
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#spezielle-signale-und-ihre-spektren">
   6.4. Spezielle Signale und ihre Spektren
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#spektrum-fur-delta-k">
     6.4.1. Spektrum für
     <span class="math notranslate nohighlight">
      \(\delta(k)\)
     </span>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#spektrum-fur-delta-k-k-0">
     6.4.2. Spektrum für
     <span class="math notranslate nohighlight">
      \(\delta(k-k_0)\)
     </span>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#weitere-fensterfunktionen-und-deren-eigenschaften">
   6.5. Weitere Fensterfunktionen und deren Eigenschaften
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#matlab-und-spektren">
   6.6. Matlab und Spektren
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#fenster-funktionen">
     6.6.1. Fenster-Funktionen
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#fft">
     6.6.2. FFT
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#signalanalyse">
     6.6.3. Signalanalyse
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#ubungen">
   6.7. Übungen
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#wiederholung-des-stoffes-und-einfache-rechenaufgaben">
     6.7.1. Wiederholung des Stoffes und einfache Rechenaufgaben
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#aufgaben-auf-klausurniveau">
     6.7.2. Aufgaben (Auf Klausurniveau)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#matlab-aufgaben">
     6.7.3. Matlab-Aufgaben
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#transfer-leistung">
     6.7.4. Transfer-Leistung
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#zusammenfassung">
   6.8. Zusammenfassung
  </a>
 </li>
</ul>

        </nav>
        
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="spektren">
<h1><span class="section-number">6. </span>Spektren<a class="headerlink" href="#spektren" title="Permalink to this headline">¶</a></h1>
<p>Wir haben bisher zwei Beschreibungsebenen für diskrete Signale und
Systeme kennen gelernt, den Zeitbereich mit der Differenzengleichung und
die z-Ebene. Häufig ist aber von Interesse, wie sich die Signale und
Systeme in Abhängigkeit von der Frequenz verhalten. Diese Darstellung
wird als Spektrum bezeichnet. Dabei ist das Betragsverhalten
(Betragsspektrum), also ob und mit welcher Leistung eine Frequenz im
Signal vorhanden ist oder ob ein System eine bestimmte Frequenz
verstärkt oder dämpft, interessant. Das Phasenverhalten ist für viele
Anwendungen von sekundärer Bedeutung. Trotzdem kann insbesondere bei der
Beschreibung von Systemen das Phasenspektrum eine wichtige Information
darstellen.</p>
<div class="hint admonition">
<p class="admonition-title">Beispiel</p>
<p>Motivationsbeispiel: Feedbackproblematik im Hörgerät oder bei der Bühnenbeschallung. Analyse des Signals (Spektrum) ermöglicht zu erkennen, bei welcher Frequenz die Störung auftritt. Nach der Analyse kann bei dieser Frequenz ein System eingebaut werden, dass die Übertragung dämpft. Durch den frequenzselektiven Eingriﬀ wird das Nutzssignal nur unwesentlich beeinﬂusst.</p>
</div>
<div class="error admonition">
<p class="admonition-title">ToDo</p>
<p>Aktives Beispiel wäre schön.</p>
</div>
<p>Eine Möglichkeit das Verhalten bei einer bestimmten Frequenz zu testen,
ist, das LTI-System mit Signalen anzuregen die nur aus einer Frequenz
bestehen und dann die Veränderung am Ausgang zu messen. Ein sehr gutes
Eingangssignal um Betrag und Phase zu bestimmen ist die ungedämpfte
diskrete Exponentialschwingung</p>
<div class="math notranslate nohighlight" id="equation-eq-def-euler">
<span class="eqno">(6.1)<a class="headerlink" href="#equation-eq-def-euler" title="Permalink to this equation">¶</a></span>\[
    e^{j\Omega_0 k} = \cos(\Omega k)+j\sin(\Omega k)
\]</div>
<p>mit <span class="math notranslate nohighlight">\(\Omega_0 = 2 \pi f_0/ f_s\)</span>, wobei <span class="math notranslate nohighlight">\(f_0\)</span> die Analysefrequenz und <span class="math notranslate nohighlight">\(f_s\)</span>
die Samplingfrequenz angibt.</p>
<p><strong>Exkurs: Frequenzachsen in der DSV</strong> Manchmal ist es verwirrend in
welcher Form Frequenzen in der digitalen Signalverarbeitung angegeben
werden. Die am häufigsten verwendeten Systeme und ihre Äquivalenz als
Achse und ihre Position auf dem Einheitskreis in der z-Ebene zeigt
<a class="reference internal" href="#fig-frequenzskalierungenexkurs"><span class="std std-numref">Abbildung 6.1</span></a> .</p>
<div class="figure align-default" id="fig-frequenzskalierungenexkurs">
<a class="reference internal image-reference" href="_images/FrequenzskalierungenExkurs.png"><img alt="_images/FrequenzskalierungenExkurs.png" src="_images/FrequenzskalierungenExkurs.png" style="height: 150px;" /></a>
<p class="caption"><span class="caption-number">Fig. 6.1 </span><span class="caption-text">Veranschaulichung der unterschiedlichen
Frequenzbezeichnungen in der DSV und ihre Position auf dem Einheitskreis
in der
z-Ebene.</span><a class="headerlink" href="#fig-frequenzskalierungenexkurs" title="Permalink to this image">¶</a></p>
</div>
<p>Mit Hilfe der Faltung ergibt sich am Ausgang eines durch die
Impulsantwort beschriebenen Systems.</p>
<div class="math notranslate nohighlight" id="equation-eq-ftrafo-bsp">
<span class="eqno">(6.2)<a class="headerlink" href="#equation-eq-ftrafo-bsp" title="Permalink to this equation">¶</a></span>\[\begin{split}\begin{aligned}
    y(k)&amp; = &amp;x(k)\ast h(k) = \sum_{\kappa = -\infty}^{\infty} h(\kappa)
    e^{j\Omega_0(k-\kappa)}\\
    &amp;= &amp; \underbrace{e^{j\Omega_0 k}}_{\mbox{Eingangssignal}} \cdot
    \underbrace{\sum_{\kappa = -\infty}^{\infty} h(\kappa) e^{-j\Omega_0
    \kappa}}_{\mbox{Komplexer Multiplikator}}\end{aligned}
\end{split}\]</div>
<p>Das heißt also, am Ausgang können wir eine Schwingung derselben Frequenz messen, die nur in ihrer Phase und ihrem Betrag geändert wird. Berechnen wir
dieses Ausgangsverhalten für alle Frequenzen erhalten wir das Spektrum.
Auffällig bei LTI-Systemen ist, das keine neuen Frequenzen entstehen.
Dies ist eine typische Eigenschaft von LTI-Systemen.</p>
<p><strong>LTI-Systeme erzeugen keine neuen Frequenzen</strong></p>
<p>Bei Systemen wird die frequenzabhängige Veränderung des Betrages und der
Phase Übertragungsfunktion genannt und kann mit</p>
<div class="math notranslate nohighlight" id="equation-eq-dtfd-hin">
<span class="eqno">(6.3)<a class="headerlink" href="#equation-eq-dtfd-hin" title="Permalink to this equation">¶</a></span>\[
    H(e^(j \Omega)) = \sum_{k = -\infty}^{\infty} h(k) e^{-j\Omega k}
\]</div>
<p>berechnet werden. Diese Form ist eng verwandt mit der Fourier-Transformation für analoge Signale und wird deshalb Zeitdiskrete Fourier-Transformation (<em>Discrete Time Fourier-Transformation (DTFT)</em>) genannt.</p>
<p>Vergleichen wir nun Gleichung
<a class="reference internal" href="#equation-eq-dtfd-hin">(6.3)</a> mit der Definition der z-Transformation, so
erkennen wir, dass die DTFT die z-Transformation für <span class="math notranslate nohighlight">\(z = e^{j\Omega}\)</span>
darstellt und somit genau den Einheitskreis in der z-Ebene beschreibt.
Wir können also direkt am Einheitskreis das frequenzabhängige
Übertragungsverhalten von Systemen ablesen. Dies gilt analog natürlich
auch für Signale.</p>
<p>Kennen wir also die z-Transformation eines Systems können wir auch
sofort die Übertragungsfunktion angeben. Betrachten wir beispielsweise
das System <span class="math notranslate nohighlight">\(y(k) = x(k) + x(k-1)\)</span>, dann ergibt <span class="math notranslate nohighlight">\(e^{j\Omega}\)</span> in die
z-Transformierte eingesetzt</p>
<div class="math notranslate nohighlight" id="equation-eq-ftrafo-bsp-ztrafoftrafo">
<span class="eqno">(6.4)<a class="headerlink" href="#equation-eq-ftrafo-bsp-ztrafoftrafo" title="Permalink to this equation">¶</a></span>\[
    H(e^(j \Omega)) = 1+z^{-1} \Big|_{z = e^{j\Omega}} = 1+e^{-j\Omega}
\]</div>
<p>Durch Umformungen erhalten wir.</p>
<div class="math notranslate nohighlight" id="equation-eq-ftrafo-bspuebrtragungf">
<span class="eqno">(6.5)<a class="headerlink" href="#equation-eq-ftrafo-bspuebrtragungf" title="Permalink to this equation">¶</a></span>\[\begin{split}
\begin{aligned}
   e^{j\Omega / 2} H(e^(j \Omega)) &amp;= &amp; e^{j \Omega / 2}+e^{-j\Omega / 2}\\
   &amp; = &amp; \underbrace{2 \cos(\Omega / 2)}_{\mbox{Betrag, wenn $|\cdot|$}}
   \underbrace{e^{-j\Omega / 2}}_{\mbox{Phase}}\end{aligned}
\end{split}\]</div>
<p>Die komplexwertige Darstellung mit Real und Imaginärteil ist dabei zur
Veranschaulichung und Interpretation nicht geeignet. Statt dessen wird
das komplexe Signal meist in den Betragsfrequenzgang, d.h, eine
Darstellung von <span class="math notranslate nohighlight">\(|H(e^(j \Omega))|\)</span> über der Frequenz und den Phasengang, eine
Darstellung des Arguments von <span class="math notranslate nohighlight">\(H(e^(j \Omega))\)</span>, aufgeteilt, wobei beim Betrag
oder dem Betragsquadrat auch häufig eine logarithmische Darstellung
gewählt wird</p>
<div class="section" id="einfluss-der-pole-und-nullstellen-auf-die-ubertragungsfunktion">
<h2><span class="section-number">6.1. </span>Einfluss der Pole und Nullstellen auf die Übertragungsfunktion<a class="headerlink" href="#einfluss-der-pole-und-nullstellen-auf-die-ubertragungsfunktion" title="Permalink to this headline">¶</a></h2>
<p>Um den Einfluss der Pole und Nullstellen auf die Übertragungsfunktion
abzuschätzen, schauen wir uns zunächst noch einmal die <a class="reference internal" href="#fig-uebertragpolnullstellen"><span class="std std-numref">Abbildung 6.2</span></a> an. Bei dieser Abbildung ist
<span class="math notranslate nohighlight">\(|H(e^(j \Omega))|^2\)</span> logarithmisch dargestellt. Der Betragsfrequenzgang der DTFT
kann direkt aus dem enstehenden “Gebirge” abgelesen werden, wenn wir den
Einheitskreis vom Winkel <span class="math notranslate nohighlight">\(0\)</span> bis <span class="math notranslate nohighlight">\(\pi\)</span> umlaufen. Der Pol bei <span class="math notranslate nohighlight">\(\pi/10\)</span>
verursacht eine Verstärkung auf dem Einheitskreis. Ein Pol direkt auf
dem Einheitskreis würde zu einer unendlichen Verstärkung führen. Sobald
der Winkel größer wird als <span class="math notranslate nohighlight">\(\pi/10\)</span> nimmt die Verstärkung ab. Ab einem
Winkel von <span class="math notranslate nohighlight">\(\pi/2\)</span> werden die Nullstellen dominant, die dazu führen,
dass sich der Betragsfrequenzgang null nähert und die Null bei genau
<span class="math notranslate nohighlight">\(\pi\)</span> erreicht. Auf dem unteren Halbkreis geht zunächst der Einfluss der
Nullstelle zurück und der konjugiert komplexe Pol bei <span class="math notranslate nohighlight">\(-\pi/10\)</span> gewinnt
an Einfluss. Bei <span class="math notranslate nohighlight">\(\Omega =
2\pi\)</span> sind wir erneut bei <span class="math notranslate nohighlight">\(\Omega = 0\)</span>. Der Betragsfrequenzgang
wiederholt sich also periodisch in <span class="math notranslate nohighlight">\(2\pi\)</span> für diskrete Signale. Dies ist
auch direkt aus der Beziehung</p>
<div class="math notranslate nohighlight" id="equation-eq-spek-peridozitaetserklaerung">
<span class="eqno">(6.6)<a class="headerlink" href="#equation-eq-spek-peridozitaetserklaerung" title="Permalink to this equation">¶</a></span>\[
    e^{j\Omega k} = e^{j(\Omega +2\pi n) k} \quad \forall \quad n \in \mathbb{N}
\]</div>
<p>zu sehen.</p>
<p>Eine direkte Berechnung des Betrag- und Phasenganges aus den Polen und
Nullstellen ist ebenfalls möglich. Um das zu veranschaulichen ist in
<a class="reference internal" href="#fig-uebertragpolnullstellen"><span class="std std-numref">Abbildung 6.2</span></a>  ein System zweiter Ordnung in der
z-Ebene mit den zwei Polen und den zwei Nullstellen gezeigt.</p>
<div class="figure align-default" id="fig-uebertragpolnullstellen">
<a class="reference internal image-reference" href="_images/UebertragPolNullstellen.png"><img alt="_images/UebertragPolNullstellen.png" src="_images/UebertragPolNullstellen.png" style="width: 50%;" /></a>
<p class="caption"><span class="caption-number">Fig. 6.2 </span><span class="caption-text">Skizze zur Veranschaulichung des
Einflusses von Polen und Nullstellen auf die Übertragungsfunktion
<span class="math notranslate nohighlight">\(H(e^(j \Omega))\)</span>.</span><a class="headerlink" href="#fig-uebertragpolnullstellen" title="Permalink to this image">¶</a></p>
</div>
<p>Um den Betrag des Frequenzganges an der Stelle <span class="math notranslate nohighlight">\(P\)</span> zu berechnen, müssen
die Abstände der Pole und Nullstellen zu diesem Punkt <span class="math notranslate nohighlight">\(A_1,
A_2,B_1,B_2\)</span> bekannt sein. Er ergibt sich</p>
<div class="math notranslate nohighlight" id="equation-eq-spec-einfachebetragsrechnung">
<span class="eqno">(6.7)<a class="headerlink" href="#equation-eq-spec-einfachebetragsrechnung" title="Permalink to this equation">¶</a></span>\[
    \left|H(e^(j \Omega))\right|\Big|_{e^{j\Omega} = P} = |b_0| \frac{B_1 B_2}{A_1
    A_2}.
\]</div>
<p>Zusätzlich hat der Koeffizient <span class="math notranslate nohighlight">\(b_0\)</span> einen Einfluss, der
aber aus dem Pol-Nullstellenplan nicht ersichtlich ist.</p>
<p>Die Phase an diesem Punkt kann durch</p>
<div class="math notranslate nohighlight" id="equation-eq-spec-eenfachephasenrechnung">
<span class="eqno">(6.8)<a class="headerlink" href="#equation-eq-spec-eenfachephasenrechnung" title="Permalink to this equation">¶</a></span>\[
    \arg\left\{H(e^(j \Omega)) \right\}\Big|_{e^{j\Omega} = P} = -\arg\{b_0\}  + \beta_1 + \beta_2
    - \alpha_1 - \alpha_2
\]</div>
<p>berechnet werden. Da <span class="math notranslate nohighlight">\(b_0\)</span> für reellwertige
Systeme ebenfalls reell ist, kann der Term <span class="math notranslate nohighlight">\(\arg\{b_0\}\)</span> auch
weggelassen werden, bzw. führt bei negativem <span class="math notranslate nohighlight">\(b_0\)</span> zu einer
Phasendrehung von <span class="math notranslate nohighlight">\(\pi\)</span>.</p>
<p>Für allgemeine Systeme mit einem Zählergrad <span class="math notranslate nohighlight">\(M\)</span> und einem Nennergrad <span class="math notranslate nohighlight">\(N\)</span>
ergibt sich [<span id="id1">[<span>&#64;KK98</span>]</span>].</p>
<div class="math notranslate nohighlight" id="equation-eq-spektrumbetragallg">
<span class="eqno">(6.9)<a class="headerlink" href="#equation-eq-spektrumbetragallg" title="Permalink to this equation">¶</a></span>\[
    \left|H(e^(j \Omega))\right| = |b_0| \frac{\displaystyle \prod_{i = 0}^{M-1} \sqrt{1-2|n_i|\cos(\Omega-\arg\{n_i\})+|n_i|^2}}
    {\displaystyle \prod_{i = 0}^{N-1}\sqrt{1-2|p_i|\cos(\Omega-\arg\{p_i\})+|p_i|^2}}
\]</div>
<p>bzw. für die Phase</p>
<div class="math notranslate nohighlight" id="equation-eq-spektrumphaseallg">
<span class="eqno">(6.10)<a class="headerlink" href="#equation-eq-spektrumphaseallg" title="Permalink to this equation">¶</a></span>\[\begin{split}
\begin{aligned}
    \arg\left\{H(e^(j \Omega))\right\} &amp;=&amp; (M-N)\Omega - \arg\{b_0\} \\\nonumber
    &amp;&amp; - \sum_{i = 0}^{M-1}\arctan\left\{\frac{\sin \Omega-|n_i|\sin(\arg\{n_i\})}{\cos \Omega-|n_i|\cos(\arg\{n_i\})}
    \right\}\\\nonumber
    &amp;&amp; +\sum_{i = 0}^{N-1}\arctan\left\{\frac{\sin \Omega-|p_i|\sin(\arg\{p_i\})}{\cos \Omega-|p_i|\cos(\arg\{p_i\})} \right\}\end{aligned}
\end{split}\]</div>
<div class="error admonition">
<p class="admonition-title">To Do</p>
<p>Hier fehlt ein Beispiel, dass in Matlab erklärt wird</p>
</div>
<div class="error admonition">
<p class="admonition-title">To Do</p>
<p>Phase muss noch deutlich besser erklärt werden, außerdem scheint die Phasenformel falsch zu sein</p>
</div>
<p>Eine Interpretation führt zu den Schlüssen:</p>
<ul>
<li><p>Je näher ein Pol am Einheitkreis liegt umso größer ist sein Einfluss
auf die Übertragungsfunktion</p></li>
<li><p>Eine Nullstelle auf dem Einheitskreis führt zu einem Phasensprung um
<span class="math notranslate nohighlight">\(\pi\)</span>.</p></li>
<li><p>Systeme, bei denen alle Nullstellen im inneren des Einheitskreises
liegen, heißen minimalphasig.</p></li>
<li><p>Pole oder Nullstellen im Ursprung verändern nur die Phase, aber
nicht den Betrag der Übertragungsfunktion.</p></li>
<li><p>Nullstellen die am Einheitskreis gespiegelt werden
<span class="math notranslate nohighlight">\(r_{out} = 1/r_{in}\)</span>, führen nur zu einer Veränderung der
Grundverstärkung des Betrages der Übertragungsfunktion aber nicht zu
einer Veränderung der Form. Gleichzeitig wird aber die Phase so
verändert, dass sie um über <span class="math notranslate nohighlight">\(180^{\circ}\)</span> dreht und das
resultierende System nicht mehr minimalphasig ist.</p></li>
<li><p>Systeme bei denen die Nullstellen an den Positionen der am
Einheitskreis gespiegelten Pole liegen</p>
<div class="math notranslate nohighlight" id="equation-eq-allpassgrundlagenformel">
<span class="eqno">(6.11)<a class="headerlink" href="#equation-eq-allpassgrundlagenformel" title="Permalink to this equation">¶</a></span>\[
        n_{i_0} = \frac{1}{p_{i_{\infty}}}
\]</div>
</li>
</ul>
<p>heißen Allpasssysteme, da
der Betrag für alle Frequenzen konstant bleibt. Nur die Phase wird
verändert und dreht um <span class="math notranslate nohighlight">\(N \pi\)</span>, wobei <span class="math notranslate nohighlight">\(N\)</span> die Ordnung des Systems
angibt.</p>
</div>
<div class="section" id="diskrete-fourier-transformation">
<span id="sec-diskretefourier-transformation"></span><h2><span class="section-number">6.2. </span>Diskrete Fourier-Transformation<a class="headerlink" href="#diskrete-fourier-transformation" title="Permalink to this headline">¶</a></h2>
<p>Zur Frequenzanalyse ist bisher nur die DTFT bekannt. Aber diese
Transformation kann nicht auf einem Computer umgesetzt werden, da das
resultierende Spektrum nicht diskret ist. Außerdem benötigt man
unendlich viele Eingangswerte um das Spektrum zu berechnen. Deshalb wird
in einem ersten Schritt die Anzahl der genutzten Abtastwerte auf <span class="math notranslate nohighlight">\(N\)</span>
beschränkt. Man könnte dies auch so interpretieren, dass die unendliche
Folge des Signals mit einer Rechteckfolge der Höhe eins und der Länge N
multipliziert wird. Da außerhalb des Eins-Bereichs alle Multiplikationen
zu Null werden, können auch die Summengrenzen verändert werden.</p>
<p>Diese Rechteckfolge werden wir im weiteren mit Fenster oder <em>Window</em>
bezeichnen, da es aus der Folge nur einen Ausschnitt zeigt, in Anlehnung
an ein Glasfenster , das uns nur einen Ausschnitt der Wirklichkeit zeigt
(siehe <a class="reference internal" href="#fig-dft-fenstermultiplikation"><span class="std std-numref">Abbildung 6.3</span></a> ). Die Länge <span class="math notranslate nohighlight">\(N\)</span> nennen wir Blockgröße,
da nur noch ein Block an Daten verarbeitet wird.</p>
<div class="cell tag_hide-input tag_remove-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span>
<span class="kn">from</span> <span class="nn">myst_nb</span> <span class="kn">import</span> <span class="n">glue</span>

<span class="n">matplotlib</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;sv.mplstyle&#39;</span><span class="p">)</span>


<span class="n">fig</span><span class="p">,</span> <span class="n">ax_signal</span> <span class="o">=</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">signal</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random_sample</span><span class="p">(</span><span class="mi">36</span><span class="p">)</span><span class="o">*</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">2</span>
<span class="n">ax_signal</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">36</span><span class="p">),</span> <span class="n">signal</span><span class="p">,</span> <span class="n">use_line_collection</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ax_signal</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Folgenkindex k -&gt;&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Amplitude x[k]&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Eingangssignal&#39;</span><span class="p">,</span> <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">35</span><span class="p">])</span>

<span class="n">ax_window</span> <span class="o">=</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">window</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">10</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">16</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">10</span><span class="p">])</span>
<span class="n">ax_window</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">36</span><span class="p">),</span> <span class="n">window</span><span class="p">,</span> <span class="n">where</span><span class="o">=</span><span class="s1">&#39;mid&#39;</span><span class="p">)</span>
<span class="n">ax_window</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Folgenkindex k -&gt;&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Amplitude x[k]&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Rechteck-Fensterfunktion&#39;</span><span class="p">,</span> <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">35</span><span class="p">])</span>

<span class="n">ax_filtered</span> <span class="o">=</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">filtered_signal</span> <span class="o">=</span> <span class="n">signal</span> <span class="o">*</span> <span class="n">window</span>
<span class="n">ax_filtered</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">36</span><span class="p">),</span> <span class="n">filtered_signal</span><span class="p">,</span> <span class="n">use_line_collection</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ax_filtered</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Folgenkindex k -&gt;&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Amplitude x[k]&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;gefenstertes Signal&#39;</span><span class="p">,</span> <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">35</span><span class="p">])</span>

<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;DFT_FensterMultiplikation&quot;</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="figure align-default" id="fig-dft-fenstermultiplikation" style="width: 75%">
<p class="caption"><span class="caption-number">Fig. 6.3 </span><span class="caption-text">Veranschaulichung der Wirkung einer
Rechteck-Fensterfunktion der Länge
<span class="math notranslate nohighlight">\(N = 16\)</span>.</span><a class="headerlink" href="#fig-dft-fenstermultiplikation" title="Permalink to this image">¶</a></p>
</div>
<p>Das resultierende Spektrum ist aber immer noch kontinuierlich. Durch die
periodische Wiederholung des Spektrums ist es aber ausreichend nur den
Bereich von <span class="math notranslate nohighlight">\(0 \leq \omega\leq 2\pi\)</span> genauer zu betrachten. Um jetzt
eine diskretes Spektrum zu erhalten, unterteilen wir das Spektrum in <span class="math notranslate nohighlight">\(N\)</span>
gleichförmige Abschnitte (man kann auch eine andere Anzahl verwenden, aber N führt zu besonders effizienten Lösungen).</p>
<p>Die DTFT geht damit in</p>
<div class="math notranslate nohighlight" id="equation-eq-dfthin-def">
<span class="eqno">(6.12)<a class="headerlink" href="#equation-eq-dfthin-def" title="Permalink to this equation">¶</a></span>\[
    X(n) = X\left(e^{j 2 \pi n / N}\right) = \sum_{k = 0}^{N-1}x(k) e^{-j 2 \pi n k /N}
\]</div>
<p>über.</p>
<p>Umgekehrt ist es natürlich auch möglich, aus den <span class="math notranslate nohighlight">\(N\)</span> Spektralwerten auch
auf die Folge zurück zuschließen. Die Rücktransformation enthält
zusätzlich noch einen Normierungsterm <span class="math notranslate nohighlight">\(N\)</span> und unterscheidet sich sonst
nur in dem Vorzeichen der e-Funktion.</p>
<div class="math notranslate nohighlight" id="equation-eq-dftrueck-def">
<span class="eqno">(6.13)<a class="headerlink" href="#equation-eq-dftrueck-def" title="Permalink to this equation">¶</a></span>\[
    x(k) = \frac{1}{N} \sum_{n = 0}^{N-1}X(n) e^{j 2 \pi n k /N}
\]</div>
<p>Das Transformationspärchen
<a class="reference internal" href="#equation-eq-dfthin-def">(6.12)</a> und
<a class="reference internal" href="#equation-eq-dftrueck-def">(6.13)</a> werden als diskrete Fourier-Transformation
(DFT), bzw. inverse DFT (IDFT) bezeichnet.</p>
</div>
<div class="section" id="eigenschaften">
<h2><span class="section-number">6.3. </span>Eigenschaften<a class="headerlink" href="#eigenschaften" title="Permalink to this headline">¶</a></h2>
<div class="section" id="zusammenhang-dtft-und-dft">
<h3><span class="section-number">6.3.1. </span>Zusammenhang DTFT und DFT<a class="headerlink" href="#zusammenhang-dtft-und-dft" title="Permalink to this headline">¶</a></h3>
<p>Wir haben, um von der exakten Darstellung des Spektrums mittels DTFT auf
die computerlösbare DFT zu kommen, zwei Veränderungen vorgenommen und
natürlich spiegeln sich diese Veränderungen auch im Ergebnis wieder. Wir
müssen also versuchen, die Veränderungen zu analysieren, um sicher zu
sein, dass die DFT zumindest eine Näherung der DTFT ist.</p>
<p>Zunächst ist es interessant die vorgenommene Diskretisierung im
Frequezbereich zu untersuchen. Im Grunde genommen haben wir das Spektrum
abgetastet. Die Konsequenz der Abtastung kennen wir bereits aus der
normalen Abtastung im Zeitbereich. Es kommt zu einer periodischen
Wiederholung des Spektrums. Die Abtastung im Frequenzbereich führt zu
einer periodischen Wiederholung im Zeitbereich. Wenn man also ein Signal
analysiert und zurück transformiert ergibt sich eine periodische
Wiederholung. Auch hier gibt es eine andere Interpretationsmöglichkeit.
Bei der Analyse von periodischen Signalen mittels Fourier-Reihen ergeben
sich diskrete Spektren. Ein diskretes Spektrum führt im Umkehrschluss
also zu einer periodischen Zeitfunktion, wobei bei der DFT die Periode
genau <span class="math notranslate nohighlight">\(N\)</span> ist (siehe <a class="reference internal" href="#fig-dft-signalperiodizitaet"><span class="std std-numref">Abbildung 6.4</span></a>).</p>
<div class="figure align-default" id="fig-dft-signalperiodizitaet">
<a class="reference internal image-reference" href="_images/DFT_SignalPeriodizitaet.png"><img alt="_images/DFT_SignalPeriodizitaet.png" src="_images/DFT_SignalPeriodizitaet.png" style="width: 50%;" /></a>
<p class="caption"><span class="caption-number">Fig. 6.4 </span><span class="caption-text">Veranschaulichung der erzwungenen
Signal-Periodizität durch die
DFT.</span><a class="headerlink" href="#fig-dft-signalperiodizitaet" title="Permalink to this image">¶</a></p>
</div>
<p>Der Einfluss der Fenster-Funktion lässt sich zunächst nur durch die DTFT
beschreiben. Es ist bekannt, dass eine Faltung im Zeitbereich zu einer
Multiplikation im Bildbereich (Frequenzbereich) führt. Das Umgekehrte
gilt aber auch. Eine Multiplikation im Zeitbereich, und die Nutzung des
Fensters ist eine Multiplikation, führt im Frequenzbereich zu einer
Faltung der Spektren, wobei die Faltung hier kontinuierlich als Integral
zu definieren ist, da wir ja ein kontinuierliches periodisches Spektrum
haben.</p>
<div class="math notranslate nohighlight" id="equation-eq-spektrumbegrenzterfolgen">
<span class="eqno">(6.14)<a class="headerlink" href="#equation-eq-spektrumbegrenzterfolgen" title="Permalink to this equation">¶</a></span>\[
    H(e^(j \Omega)) \Big|_{0 \leq n \leq N} = \int_{\theta = -\pi}^{\pi} H
    (e^{j\theta}) H^{W}(e^{j(\Omega - \theta)})d\theta
\]</div>
<p>wobei <span class="math notranslate nohighlight">\(H^{W}\)</span> die Übertragungsfunktion der Fensterfunktion ist.</p>
<p>Für das Rechteckfenster ergibt sich das Spektrum, indem wir zunächst die z-Transformation der Fensterfolge <span class="math notranslate nohighlight">\(w(k)\)</span> ansetzen Es gilt:</p>
<div class="math notranslate nohighlight">
\[
H^{W}(z) = \sum_{k = -\infty}^{\infty} w(k) z^{-k} = \sum_{k = 0}^{N-1} z^{-k}\]</div>
<p>Durch einsetzen von <span class="math notranslate nohighlight">\(z = e^{j\Omega}\)</span> ergibt sich das Spektrum
$<span class="math notranslate nohighlight">\(H^{W}(z)\Big|_{z = e^{j\Omega}} = \sum_{k = 0}^{N-1} e^{-j\Omega k}
\)</span>$</p>
<p>mit der Formel der endlichen geometrischen Reihe<a class="footnote-reference brackets" href="#id11" id="id2">2</a> erhält man das
Spektrum der Rechteckfunktion:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{aligned}
    H^{W}(e^(j \Omega)) &amp; = &amp; \frac{1-e^{-j\Omega N}}{1- e^{-j\Omega}}\\
    &amp; = &amp; \frac{e^{-j\Omega N/2} \overbrace{(e^{j\Omega N/2}- e^{-j\Omega N/2})}^{2j\sin(\Omega N/2)}}
    {e^{-j \Omega/2}\underbrace{(e^{j \Omega/2}- e^{-j\Omega/2})}_{2j\sin(\Omega/2)}}\\
    &amp; = &amp; e^{-j(N-1)\Omega/2}\frac{\sin\left(N \Omega/2
\right)}{\sin\left(\Omega/2 \right)}\end{aligned}
\end{split}\]</div>
<p>Der vordere Teil dieser Funktion entspricht einer linearen Phasenverschiebung. Der zweite Teil mit den Sinustermen stellt eine sogenannte Dirichlet-Funktion dar.
Der Betrag dieser Funktion ist in <a class="reference internal" href="#fig-dirichletfkt"><span class="std std-numref">Abbildung 6.5</span></a> gezeigt.</p>
<div class="cell tag_hide-input tag_remove-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span>
<span class="kn">from</span> <span class="nn">myst_nb</span> <span class="kn">import</span> <span class="n">glue</span>

<span class="n">matplotlib</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;sv.mplstyle&#39;</span><span class="p">)</span>



<span class="n">N</span> <span class="o">=</span> <span class="mi">16</span>
<span class="n">freqs</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">600</span><span class="p">)</span>
<span class="n">dirichlet</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">freqs</span><span class="p">)</span>
<span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">freqs</span><span class="p">)):</span>
    <span class="n">dirichlet</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">N</span><span class="o">*</span><span class="n">freqs</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mf">0.5</span><span class="p">)</span><span class="o">/</span><span class="n">numpy</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">freqs</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="mf">0.5</span><span class="p">)</span>

<span class="n">dirichlet_abs</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">dirichlet</span><span class="p">)</span><span class="o">/</span><span class="n">numpy</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">dirichlet</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>

<span class="n">ax_dirichlet</span> <span class="o">=</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">subplot</span><span class="p">()</span>
<span class="n">ax_dirichlet</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">freqs</span><span class="p">,</span> <span class="n">dirichlet_abs</span><span class="p">)</span>
<span class="n">ax_dirichlet</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Frequenz rad/pi &#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Frequenzanteil normiert auf 1&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Spektrum eines Rechteckfenster (Dirichlet-Funktion)&#39;</span><span class="p">)</span>

<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;DirichletFkt&quot;</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="figure align-default" id="fig-dirichletfkt" style="width: 75%">
<p class="caption"><span class="caption-number">Fig. 6.5 </span><span class="caption-text">Betrag von <span class="math notranslate nohighlight">\(H^{W}(e^(j \Omega))\)</span> für
<span class="math notranslate nohighlight">\(N = 16\)</span>.</span><a class="headerlink" href="#fig-dirichletfkt" title="Permalink to this image">¶</a></p>
</div>
<div class="hint admonition">
<p class="admonition-title">Beispiel</p>
<p>DTFT und DFT bei einer Cosinus-Schwingung<br />
Um die Unterscheide zwischen DTFT und DFT bei der Spektrumsberechnung
eines Cosinus müssen wir zunächst das Spektrum einer abgetasteten
Cosinus-Schwingung berechnen:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{aligned}
H(e^(j \Omega)) &amp; = &amp; \sum_{-\infty}^{\infty} \cos \left(k \Omega_0  \right) e^{-j\Omega k}\\
       &amp; = &amp; \sum_{-\infty}^{\infty} \frac{1}{2}\left( e^{j k \Omega_0} + e^{-j k \Omega_0}\right) e^{-j\Omega k}\\
       &amp; = &amp; \sum_{-\infty}^{\infty} \frac{1}{2} \left( e^{j k (\Omega_0-\Omega)} + e^{-j k (\Omega_0 + \Omega)}\right)\\
       &amp; = &amp; \sum_{-\infty}^{\infty} \frac{1}{2} e^{-j k (\Omega-\Omega_0)}
       + \sum_{-\infty}^{\infty} \frac{1}{2} e^{-j k (\Omega + \Omega_0)}\\
       &amp; = &amp; \frac{1}{2} \delta^D{\Omega - \Omega_0}
       + \frac{1}{2} \delta^D{\Omega + \Omega_0}\end{aligned}
\end{split}\]</div>
<p>mit
<span class="math notranslate nohighlight">\(\Omega = 2\pi f / f_s\)</span>. Das heißt, das Spektrum des abgetasteten
Cosinus hat nur zwei definierte Frequenzwerte, an den Frequenzen
<span class="math notranslate nohighlight">\(\Omega = \pm \Omega_0\)</span>.</p>
</div>
<p>Um den Einfluss der Annäherung durch die DFT zu veranschaulichen,
begrenzen wir den betrachteten Signalausschnitt auf <span class="math notranslate nohighlight">\(N\)</span> Datenwerte. Dies
führt wie in Gleichung
<a class="reference internal" href="#equation-eq-spektrumbegrenzterfolgen">(6.14)</a> gezeigt zu einer Faltung mit
dem Spektrum des Rechtecks. Durch die Siebeigenschaft der
<span class="math notranslate nohighlight">\(\delta\)</span>-Funktion ergibt sich</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{aligned}
    H(e^(j \Omega)) &amp; = &amp; \left(\frac{1}{2} \delta \left(\Omega - \Omega_0 \right)
       + \frac{1}{2} \delta \left(\Omega + \Omega_0 \right) \right) \ast H^{W}(e^(j \Omega)) \\
           &amp; = &amp; \frac{1}{2} H^{W} \left(e^{j(\Omega -\Omega_0 )}\right) +
                 \frac{1}{2} H^{W} \left(e^{j(\Omega + \Omega_0 )}\right).\end{aligned}
\end{split}\]</div>
<p>Das Spektrum des Rechtecks wird also, um <span class="math notranslate nohighlight">\(\pm \Omega_0\)</span> verschoben.
<a class="reference internal" href="#fig-dft-cosinus"><span class="std std-numref">Abbildung 6.6</span></a> zeigt das resultierende
Spektrum für <span class="math notranslate nohighlight">\(N = 16\)</span> bei einer Grundfrequenz von 155Hz und einer
Abtastrate von <span class="math notranslate nohighlight">\(f_s = 1\)</span>kHz.</p>
<div class="cell tag_hide-input tag_remove-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span>
<span class="kn">from</span> <span class="nn">myst_nb</span> <span class="kn">import</span> <span class="n">glue</span>

<span class="n">matplotlib</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;sv.mplstyle&#39;</span><span class="p">)</span>

<span class="n">num_samples</span> <span class="o">=</span> <span class="mi">16</span>
<span class="n">f0</span> <span class="o">=</span> <span class="mi">155</span>
<span class="n">fs</span> <span class="o">=</span> <span class="mi">1000</span>

<span class="n">sample</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">num_samples</span>

<span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_samples</span><span class="p">):</span>
    <span class="n">sample</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">f0</span><span class="o">*</span><span class="n">idx</span><span class="o">/</span><span class="n">fs</span><span class="p">)</span>

<span class="n">sample</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">4</span> <span class="o">+</span> <span class="n">sample</span> <span class="o">+</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">4</span><span class="p">])</span>
<span class="n">spectrum</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>
<span class="n">spectrum_abs</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">spectrum</span><span class="p">)</span><span class="o">/</span><span class="n">numpy</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">spectrum</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
<span class="n">ifft</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">ifft</span><span class="p">(</span><span class="n">spectrum</span><span class="p">)</span>


<span class="n">freqs_fft</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">spectrum_abs</span><span class="p">))</span>

<span class="c1"># Bild 5.6</span>
<span class="n">f1</span><span class="p">,</span> <span class="p">(</span><span class="n">ax_sample</span><span class="p">,</span> <span class="n">ax_spectrum</span><span class="p">)</span> <span class="o">=</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">ax_sample</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>
<span class="n">ax_sample</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Folgenndex k -&gt;&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Amplitude x[k]&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Eingangssignal Sinus&#39;</span><span class="p">)</span>

<span class="n">ax_spectrum</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">freqs_fft</span><span class="p">,</span> <span class="n">spectrum_abs</span><span class="p">)</span>
<span class="n">ax_spectrum</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Frequenz rad/pi &#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Frequenzanteil normiert auf 1&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Spektrum eines Rechteckfenster (Dirichlet-Funktion)&#39;</span><span class="p">)</span>

<span class="c1"># Bild 5.7</span>
<span class="n">f2</span><span class="p">,</span> <span class="p">(</span><span class="n">ax_spec_stem</span><span class="p">,</span> <span class="n">ax_ifft</span><span class="p">)</span> <span class="o">=</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">ax_spec_stem</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">freqs_fft</span><span class="p">,</span> <span class="n">spectrum_abs</span><span class="p">,</span> <span class="n">use_line_collection</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ax_spec_stem</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Frequenz rad/pi &#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Frequenzanteil normiert auf 1&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Spektrum eines Rechteckfenster (Dirichlet-Funktion)&#39;</span><span class="p">)</span>

<span class="n">ax_ifft</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ifft</span><span class="p">)</span>
<span class="n">ax_ifft</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Folgenndex k -&gt;&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Amplitude x[k]&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;durch inverse FFT rekonstruiertes Signal&#39;</span><span class="p">)</span>

<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;DFT_Cosinus&quot;</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="figure align-default" id="fig-dft-cosinus" style="width: 75%">
<p class="caption"><span class="caption-number">Fig. 6.6 </span><span class="caption-text">Spektrum (Rechts) einer
abgetasteten Cosinus-Fkt., die auf <span class="math notranslate nohighlight">\(N = 16\)</span> Werte begrenzt wird (Links)
(<span class="math notranslate nohighlight">\(f_s = 1\)</span>kHz und
<span class="math notranslate nohighlight">\(f_0 = 155\)</span>Hz).</span><a class="headerlink" href="#fig-dft-cosinus" title="Permalink to this image">¶</a></p>
</div>
<p>Um nun das DFT-Spektrum zu berechnen ist zusätzlich die Abtastung im
Frequenzbereich notwendig. Dies hat implizit zur Folge, dass die
Cosinusfolge periodisch wiederholt wird. Das abgetastete Spektrum ist
auf der linken Seite in Abbildung
<a class="reference internal" href="#fig-dft-cosinusspektrum"><span class="std std-numref">Abbildung 6.7</span></a> zu sehen und die
resultierende Folge auf der rechten Seite.</p>
<div class="figure align-default" id="fig-dft-cosinusspektrum">
<a class="reference internal image-reference" href="_images/DFT_CosinusSpektrum.png"><img alt="_images/DFT_CosinusSpektrum.png" src="_images/DFT_CosinusSpektrum.png" style="width: 80%;" /></a>
<p class="caption"><span class="caption-number">Fig. 6.7 </span><span class="caption-text">Abgetastetes Spektrum
(Links) und die daraus resultierende periodisch fortgesetzte Cosinus-Fkt
mit Sprungstellen
(rechts).</span><a class="headerlink" href="#fig-dft-cosinusspektrum" title="Permalink to this image">¶</a></p>
</div>
<p>Das resultierende Spektrum hat nicht das erwartete Maximum bei <span class="math notranslate nohighlight">\(f_0\)</span>, da
<span class="math notranslate nohighlight">\(155Hz\)</span> nicht im Abtastraster einer 16 Punkte FFT bei einer Abtastrate
von 1kHz liegt. Statt dessen ist die Leistung des Cosinus über viele
Abtastpunkte spektral verteilt. Dieser Effekt wird auch als <em>Leakage</em>
bezeichnet.</p>
<div class="error admonition">
<p class="admonition-title">To Do</p>
<p>Beispiele mit anderen Frequenzen, um zu zeigen, dass Dirichlet-
Funktion abgetastet wird.</p>
</div>
</div>
<div class="section" id="symmetrien-der-dft">
<h3><span class="section-number">6.3.2. </span>Symmetrien der DFT<a class="headerlink" href="#symmetrien-der-dft" title="Permalink to this headline">¶</a></h3>
<p>Eine der wichtigsten Symmetrien für die diskrete sowie für die
zeitdiskrete Fourier-Transformation (DFT und DTFT) ergibt sich für
reelle Signale. Aus den Eigenschaften der z-Transformation ist deutlich,
dass sich nur dann reelle Koeffizienten bei Signalen und Systemen
ergeben, wenn die Pole und Nullstellen konjugiert komplex auftreten.
Daraus ergibt sich, dass die Spektren reeller Signale konjugiert komplex
sind. Es ergibt sich also eine Symmetrie der Spektren an der Null Hertz
(Gleichstrom) Linie. Der Realteil ist dabei achsensymmetrisch (gerade)
und der Imaginärteil punktsymmetrisch (ungerade). Diese Symmetrien
ergeben sich auch, wenn Betrag und Phase betrachtet werden. Der Betrag
reeller Funktionen ist immer achsensymmetrisch und die Phase
punktsymmetrisch (siehe <a class="reference internal" href="#fig-symmetrieplot"><span class="std std-numref">Abbildung 6.8</span></a>)</p>
<div class="figure align-default" id="fig-symmetrieplot">
<a class="reference internal image-reference" href="_images/SymmetriePlot.png"><img alt="_images/SymmetriePlot.png" src="_images/SymmetriePlot.png" style="width: 80%;" /></a>
<p class="caption"><span class="caption-number">Fig. 6.8 </span><span class="caption-text">Beispiel eines Frequenz- und Phasenverlaufs
eines reellwertigen
Systems.</span><a class="headerlink" href="#fig-symmetrieplot" title="Permalink to this image">¶</a></p>
</div>
<p>Die Symmetrien lassen sich bei der Berechnung der DFT und IDFT
ausnutzen, da immer nur das halbe Spektrum berechnet werden muss,
während die andere Hälfte durch Spiegelung erzeugt werden kann. Häufig
kommt es vor, dass man im Spektralbereich etwas berechnet und an der
dazugehörigen Zeitfolge interessiert ist (zum Beispiel beim
Filterentwurf). Es reicht aus, für eine <span class="math notranslate nohighlight">\(N\)</span>-Punkte DFT, <span class="math notranslate nohighlight">\(N/2+1\)</span>
Spektralwerte zu kennen. Man benötigt einen Wert mehr, da die DFT für
die höchste Frequenz bei <span class="math notranslate nohighlight">\(f_s/2\)</span> nur einen reellwertigen Koeffizienten
besitzt. Die Kopievorschrift in Matlab sieht dann wie folgt aus, wobei
wir annehmen, die <span class="math notranslate nohighlight">\(N/2+1\)</span> Werte sind in <code class="docutils literal notranslate"><span class="pre">H_halb</span></code> gespeichert</p>
<div class="tabbed-set docutils">
<input checked="checked" id="49eb875a-43cd-47d0-9f3c-7277c29af5a8" name="8bda020f-8b02-4c40-aba2-03b89ec90cdf" type="radio">
</input><label class="tabbed-label" for="49eb875a-43cd-47d0-9f3c-7277c29af5a8">
Matlab</label><div class="tabbed-content docutils">
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span>    <span class="n">H_voll</span> <span class="p">=</span> <span class="p">[</span><span class="n">H_halb</span> <span class="nb">conj</span><span class="p">(</span><span class="n">H_halb</span><span class="p">(</span><span class="k">end</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">))];</span>
</pre></div>
</div>
</div>
<input id="e8015894-6a28-4bc1-b81d-482bb839a630" name="8bda020f-8b02-4c40-aba2-03b89ec90cdf" type="radio">
</input><label class="tabbed-label" for="e8015894-6a28-4bc1-b81d-482bb839a630">
Python</label><div class="tabbed-content docutils">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>    <span class="n">H_halb_c</span> <span class="o">=</span> <span class="n">H_halb</span><span class="p">[:,</span><span class="o">-</span><span class="mi">1</span><span class="p">}]</span>
    <span class="n">H_voll</span> <span class="o">=</span> <span class="n">H_halb</span> <span class="o">+</span> <span class="n">H_halb_c</span>
</pre></div>
</div>
</div>
</div>
<p>Die Gegenprobe, ob alle Symmetrien richtig aufgebaut wurden, ist das
Überprüfen, ob nach der Rücktransformation eine rein reellwertige Folge
entsteht, wobei bei Matlab durch Rundungsfehler immer die resultierende
Variable komplex ist. Es ist deshalb immer notwendig, den Betrag des
Imaginäranteils zu überprüfen. Dieser sollte sehr kleine Werte um
<span class="math notranslate nohighlight">\(10^{-7}\)</span> nicht überschreiten.</p>
<p>Wie lässt sich die Symmetriebedingung mathematisch zeigen?</p>
<p>Ausgehend von</p>
<div class="math notranslate nohighlight">
\[
X(n) = \sum_{k = 0}^{N-1} x(k) e^{-jkn2\pi/N}
\]</div>
<p>ergibt sich für die an der y-Achse gespiegelte Folge durch Variablensubstitution</p>
<div class="math notranslate nohighlight">
\[
X(-n) = \sum_{k = 0}^{N-1} x(k) e^{jkn2\pi/N}
\]</div>
<p>Konjugiert man dieses Signal ergibt sich</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{aligned}
    X^{\ast}(-n)  &amp;  =  &amp; \sum_{k = 0}^{N-1} \underbrace{x^{\ast}(k)}_{=x(k)\:\mbox{, da reell}}
    \underbrace{e^{-jkn2\pi/N}}_{\mbox{Beachte -}}\\
                  &amp;  =  &amp; X(n)\end{aligned}
\end{split}\]</div>
<div class="section" id="spektren-reeller-gerader-folgen">
<h4><span class="section-number">6.3.2.1. </span>Spektren reeller gerader Folgen<a class="headerlink" href="#spektren-reeller-gerader-folgen" title="Permalink to this headline">¶</a></h4>
<p>Die Symmetriebedingung reeller gerader Folgen kann aus den vorherigen
Überlegungen geschlossen werden. Da gerade Funktionen achsensymmetrisch
sind, der Imaginärteil aber punktsymmetrisch, können wir schließen, dass
reelle, gerade Funktionen ein reelles, gerades Spektrum haben.</p>
</div>
</div>
<div class="section" id="rechenregeln">
<h3><span class="section-number">6.3.3. </span>Rechenregeln<a class="headerlink" href="#rechenregeln" title="Permalink to this headline">¶</a></h3>
<div class="section" id="linearitat">
<h4><span class="section-number">6.3.3.1. </span>Linearität<a class="headerlink" href="#linearitat" title="Permalink to this headline">¶</a></h4>
<p>Die DFT ist eine lineare Transformation. Es gilt also das
Superpositionsprinzip:</p>
<div class="math notranslate nohighlight" id="equation-eq-dft-linearitaet">
<span class="eqno">(6.15)<a class="headerlink" href="#equation-eq-dft-linearitaet" title="Permalink to this equation">¶</a></span>\[
  a_1 x_1(k) + a_2 x_2(k) ;\circ \hskip-1ex -\hskip-1.2ex -\hskip-1.2ex- \hskip-1ex \bullet\; a_1 X_1(n) + a_2 X_2(n)
\]</div>
</div>
<div class="section" id="faltung">
<span id="sec-dft-faltung"></span><h4><span class="section-number">6.3.3.2. </span>Faltung<a class="headerlink" href="#faltung" title="Permalink to this headline">¶</a></h4>
<p>Bisher haben wir bereits die Faltung bei der z-Transformation kennen
gelernt und den Übergang der Faltung in die Multiplikation in der
z-Ebene. Dieser Zusammenhang gilt auch für die DTFT, aber nicht so
direkt für die DFT. Um das zu veranschaulichen, kann ein einfaches
Beispiel dienen. Gehen wir davon aus, dass wir eine Folge mit <span class="math notranslate nohighlight">\(N = 8\)</span>
Werten mit Hilfe der DFT in den Bildbereich transformieren. Wir erhalten
8 Frequenzpunkte. Des Weiteren transformieren wir eine zweite Folge mit
8 Datenwerten. Wir erhalten erneut 8 Spektralwerte. Multiplizieren wir
diese beiden Spektren und führen eine Rücktransformation durch, so
besteht das Ergebnis auch aus 8 Werten im Zeitbereich. Aus der
Faltungsalgebra wissen wir aber, dass das Faltungsprodukt aus <span class="math notranslate nohighlight">\(L+M-1\)</span>
Elementen bestehen muss, in diesem Beispiel also 15 Datenwerte. Daraus
folgt, dass die Faltung nicht der Multiplikation mit den
DFT-Spektralwerten entspricht.</p>
<p>Die Ursache hierfür ist in der implizierten Periodizität der DFT zu
finden. Das DFT Spektrum ist gerade nicht das Signal im betrachteten
Zeitfenster, sondern ein Signal das periodisch fortgesetzt ist. Die
Multiplikation im Frequenzbereich führt deshalb auf eine Faltung dieser
periodisch fortgesetzten Sequenzen. Dies führt dazu, dass auch das
Faltungsprodukt periodisch ist. Man spricht deshalb von der zyklischen
Faltung. Das Ergebnis kann sich vollständig von dem gewünschten Ergebnis
unterscheiden. Dies wird in <a class="reference internal" href="#fig-bspzyklischefaltung"><span class="std std-numref">Abbildung 6.9</span></a> demonstriert. Die beiden Folgen
(a,b) ergeben bei der Faltung im Zeitbereich die Folge c. Die Lösung mit
Hilfe der DFT führt auf die Folge d.</p>
<div class="cell tag_hide-input tag_remove-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span>
<span class="kn">from</span> <span class="nn">myst_nb</span> <span class="kn">import</span> <span class="n">glue</span>

<span class="n">matplotlib</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;sv.mplstyle&#39;</span><span class="p">)</span>



<span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">]</span>
<span class="n">b</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">]</span>
<span class="n">konventionelle_faltung</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
<span class="n">dft_spektrum</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">*</span> <span class="n">numpy</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="n">zyklische_faltung</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">ifft</span><span class="p">(</span><span class="n">dft_spektrum</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="p">((</span><span class="n">ax_a</span><span class="p">,</span> <span class="n">ax_b</span><span class="p">),</span> <span class="p">(</span><span class="n">ax_ab</span><span class="p">,</span> <span class="n">ax_fft</span><span class="p">))</span> <span class="o">=</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

<span class="n">ax_a</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">use_line_collection</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ax_a</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Folgenndex k -&gt;&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Amplitude x[k]&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Signal A&#39;</span><span class="p">)</span>
<span class="n">ax_b</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">use_line_collection</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ax_b</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Folgenndex k -&gt;&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Amplitude x[k]&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Signal B&#39;</span><span class="p">)</span>
<span class="n">ax_ab</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">konventionelle_faltung</span><span class="p">,</span> <span class="n">use_line_collection</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ax_ab</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Folgenndex k -&gt;&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Amplitude&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Konventionelle Faltung&#39;</span><span class="p">)</span>
<span class="n">ax_fft</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">zyklische_faltung</span><span class="p">,</span> <span class="n">use_line_collection</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ax_fft</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Folgenndex k -&gt;&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Amplitude&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Zyklische Faltung&#39;</span><span class="p">)</span>

<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;BspZyklischeFaltung&quot;</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="figure align-default" id="fig-bspzyklischefaltung" style="width: 75%">
<p class="caption"><span class="caption-number">Fig. 6.9 </span><span class="caption-text">Beispiel für zyklische Faltung. Die
beiden Folgen (Bild a,b) ergeben bei konventioneller Faltung Bild c.
Bild d zeigt das Resultat für die direkte Faltung im Frequenzbereich mit
Hilfe der DFT.</span><a class="headerlink" href="#fig-bspzyklischefaltung" title="Permalink to this image">¶</a></p>
</div>
<p>Um die zyklischen Faltungsprodukte zu verhindern ist es notwendig Nullen
an die zu transformierenden Folgen anzuhängen (<em>Zero-Padding</em>) und eine
entsprechend größere Transformationslänge zu wählen. Dies führt dazu,
dass die implizite Periodizität die Nullen einschließt. Die Nullen
verändern das Spektrum nicht, sondern nur die Frequenzauflösung<a class="footnote-reference brackets" href="#id12" id="id3">3</a>. Die
Rücktransformation führt zu der gewünschten Faltungsfolge, wobei durch
die vorher eingebrachten Nullen keine zyklischen Faltungsprodukte das
Ergebnis verfälschen. Bei dem obigen Beispiel würde sich das Ergebnis in
<a class="reference internal" href="#fig-bspzyklischefaltung"><span class="std std-numref">Abbildung 6.9</span></a> c ergeben, wenn an die Folgen a und
b jeweils 8 Nullen angehängt werden und die DFT Länge auf 16 erhöht
wird.</p>
<div class="error admonition">
<p class="admonition-title">To Do</p>
<p>Einfacheres Beispiel mit Rechteck und Dreiecksfunktionen, bei denen die Wiederholungen eingezeichnet sind.</p>
</div>
</div>
<div class="section" id="theorem-von-parseval">
<h4><span class="section-number">6.3.3.3. </span>Theorem von Parseval<a class="headerlink" href="#theorem-von-parseval" title="Permalink to this headline">¶</a></h4>
<p>Das Theorem von Parseval sagt aus, dass man die Energie eines Signals im
Zeit, oder im Frequenzbereich berechnen kann, bzw. dass die Leistung
eines Signals im Zeit- und Frequenzbereich gleich ist. Es gilt also für
die DTFT:</p>
<div class="math notranslate nohighlight" id="equation-eq-parsevaldtft">
<span class="eqno">(6.16)<a class="headerlink" href="#equation-eq-parsevaldtft" title="Permalink to this equation">¶</a></span>\[
    \sum_{k = -\infty}^{\infty} x^2(k) = \frac{1}{2\pi} \int_{-\pi}^{\pi} \left|X(e^(j \Omega)) \right|^2 d\Omega
\]</div>
<p>bzw. für die DFT</p>
<div class="math notranslate nohighlight" id="equation-eq-parsevaldft">
<span class="eqno">(6.17)<a class="headerlink" href="#equation-eq-parsevaldft" title="Permalink to this equation">¶</a></span>\[
    \sum_{k = 0}^{N-1} x^2(k) = \frac{1}{N}\sum_{n = 0}^{N-1} |X(n)|^2
\]</div>
</div>
</div>
<div class="section" id="effiziente-implementierung">
<h3><span class="section-number">6.3.4. </span>Effiziente Implementierung<a class="headerlink" href="#effiziente-implementierung" title="Permalink to this headline">¶</a></h3>
<p>Die DFT lässt sich durch Ausnutzung unterschiedlicher Symmetrien sehr
effizient berechnen. Um dies zu verdeutlichen, soll das sog. <em>Decimation
in Time</em>-Verfahren zur drastischen Reduktion der benötigten
Rechenleistung, genauer gezeigt werden. Andere Verfahren können in der
sehr umfangreichen Literatur zur Entwicklung der sog. Fast Fourier
Transform (FFT) gefunden werden <span id="id4">[<a class="reference internal" href="zbibliography.html#id187"><span>Coo90</span></a>,<a class="reference internal" href="zbibliography.html#id150"><span>KK98</span></a>,<a class="reference internal" href="zbibliography.html#id186"><span>OS99</span></a>]</span>.</p>
<p>Um eine effiziente Realisierung zu finden, legen wir die Länge der FFT
so fest, dass sie eine 2er Potenz darstellt. Besonders häufig in der
Audio und Sprachsignalverarbeitung genutzte FFT-Längen sind 256 , 512,
1024 und 2048. Durch diese Forderung ist es möglich, die Folge in zwei
Teilfolgen zu zerlegen, wobei wir immer abwechselnd die Elemente der
Folge, den jeweiligen neuen Teilfolgen zuordnen. Es ergeben sich die
Folgen <span class="math notranslate nohighlight">\(x(2k)\)</span> und <span class="math notranslate nohighlight">\(x(2k+1)\)</span> (siehe <a class="reference internal" href="#fig-decimationintime"><span class="std std-numref">Abbildung 6.10</span></a>).</p>
<div class="figure align-default" id="fig-decimationintime">
<a class="reference internal image-reference" href="_images/DecimationInTime.png"><img alt="_images/DecimationInTime.png" src="_images/DecimationInTime.png" style="width: 50%;" /></a>
<p class="caption"><span class="caption-number">Fig. 6.10 </span><span class="caption-text">Aufteilung einer Sequenz in zwei
Teilsequenzen zur Erklärung der FFT (Decimation in
Time)</span><a class="headerlink" href="#fig-decimationintime" title="Permalink to this image">¶</a></p>
</div>
<p>Die Konsequenzen für die DFT lassen sich nun wie folgt berechnen:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{aligned}
 \nonumber
\sum_{k = 0}^{N-1} x(k) e^{-j 2 \pi n k /N} &amp; = &amp;
\sum_{k = 0}^{\frac{N}{2}-1} \underbrace{x(2k)}_{u(k)} e^{-j 2 \pi n 2k /N} +
\sum_{k = 0}^{\frac{N}{2}-1} \underbrace{x(2k+1)}_{v(k)} e^{-j 2 \pi n (2k+1) /N} \\\nonumber
&amp; = &amp; \underbrace{\sum_{k = 0}^{\frac{N}{2}-1}u(k) e^{-j 2 \pi n k /\frac{N}{2}}}_{U(n) \qquad \mbox {N/2 DFT}} +
e^{-j2\pi n /N} \underbrace{\sum_{k = 0}^{\frac{N}{2}-1}
v(k) e^{-j 2 \pi n k /\frac{N}{2}}}_{V(n) \qquad \mbox {N/2 DFT}}\\
X(n) &amp; = &amp; U(n) + e^{-j2\pi n /N} V(n)\end{aligned}
\end{split}\]</div>
<p>Die N-Punkte DFT
lässt sich also in zwei N/2-Punkte DFT zerlegen. Hierbei tritt jetzt das
Problem auf, dass die Folgen <span class="math notranslate nohighlight">\(U(n)\)</span> und <span class="math notranslate nohighlight">\(V(n)\)</span> nur bis <span class="math notranslate nohighlight">\(N/2\)</span> definiert
sind, da ja auch nur eine N/2 DFT durchgeführt wurde. Die Lösung für
dieses Problem ist durch die Periodizität der DFT aber sehr einfach zu
umgehen, da sich das Spektrum immer wiederholt.</p>
<p>Aber warum stellt es einen Vorteil dar, wenn man die DFT so zerlegen
kann? Dazu müssen wir überlegen, wie viele Multiplikationen notwendig
sind um eine diskrete Frequenz zu berechnen. Es sind <span class="math notranslate nohighlight">\(N\)</span> komplexe
Multiplikatinen nötig. Dieser Schritt muss für alle diskreten Frequenzen
durchgeführt werden. Die Berechnung des vollständigen Spektrums benötigt
also <span class="math notranslate nohighlight">\(N^2\)</span> Multiplikationen. Teilen wir die Aufgabe in zwei Teilspektren
benötigt man <span class="math notranslate nohighlight">\(2\left(\frac{N}{2}\right)^2\)</span> + <span class="math notranslate nohighlight">\(N\)</span> Multiplikationen für
den Drehfaktor vor <span class="math notranslate nohighlight">\(V(n)\)</span>. Im Vergleich ergeben sich für <span class="math notranslate nohighlight">\(N = 8\)</span> einmal
64 Multiplikationen und für die aufgeteilten Spektren 40
Multiplikationen. Der Schritt der Aufteilung kann nun solange wiederholt
werden, bis die Folge nicht weiter aufgeteilt werden kann (<span class="math notranslate nohighlight">\(N = 2\)</span>).
Zusätzlich können einige Multiplikationen vernachlässigt werden, da
<span class="math notranslate nohighlight">\(e^{j0} = 1\)</span> ist. Eine Reduktion auf
<span class="math notranslate nohighlight">\(\frac{N}{2}\left( ld \frac{N}{2} \right)\)</span> ist so möglich (ld = Logarithmus zur Basis 2 (logarithmus dualis)). Somit
ergibt sich eine in der Rechenleistung stark reduzierte DFT, die als
<em>Fast Fourier Transform</em> (FFT) bekannt ist<a class="footnote-reference brackets" href="#id13" id="id5">5</a>.</p>
</div>
</div>
<div class="section" id="spezielle-signale-und-ihre-spektren">
<h2><span class="section-number">6.4. </span>Spezielle Signale und ihre Spektren<a class="headerlink" href="#spezielle-signale-und-ihre-spektren" title="Permalink to this headline">¶</a></h2>
<div class="section" id="spektrum-fur-delta-k">
<h3><span class="section-number">6.4.1. </span>Spektrum für <span class="math notranslate nohighlight">\(\delta(k)\)</span><a class="headerlink" href="#spektrum-fur-delta-k" title="Permalink to this headline">¶</a></h3>
<p>Berechnet man die DTFT für den <span class="math notranslate nohighlight">\(\delta\)</span>-Impuls ergibt sich</p>
<div class="math notranslate nohighlight" id="equation-eq-spektrumdeltaimpuls">
<span class="eqno">(6.19)<a class="headerlink" href="#equation-eq-spektrumdeltaimpuls" title="Permalink to this equation">¶</a></span>\[
    X(e^(j \Omega)) = \sum_{k = -\infty}^{\infty} \delta(k)e^{-jk \Omega} =e^{-j0 \Omega} = 1,
\]</div>
<p>da der <span class="math notranslate nohighlight">\(\delta\)</span>-Impuls ausschließlich an der Stelle <span class="math notranslate nohighlight">\(k = 0\)</span> definiert
ist. Das Betrag des Spektrums ist also eins für alle Frequenzen und die
Phase ist null für alle Frequenzen.</p>
</div>
<div class="section" id="spektrum-fur-delta-k-k-0">
<h3><span class="section-number">6.4.2. </span>Spektrum für <span class="math notranslate nohighlight">\(\delta(k-k_0)\)</span><a class="headerlink" href="#spektrum-fur-delta-k-k-0" title="Permalink to this headline">¶</a></h3>
<p>Der um <span class="math notranslate nohighlight">\(k_0\)</span> verschobene <span class="math notranslate nohighlight">\(\delta\)</span>-Impuls führt zu einem etwas anderem
Spektrum</p>
<div class="math notranslate nohighlight" id="equation-eq-spektrumdeltaimpuls">
<span class="eqno">(6.19)<a class="headerlink" href="#equation-eq-spektrumdeltaimpuls" title="Permalink to this equation">¶</a></span>\[
    X(e^(j \Omega)) = \sum_{k = -\infty}^{\infty} \delta(k-k_0)e^{-jk \Omega} =e^{-jk_0 \Omega}.
\]</div>
<p>Das Spektrum ist im Betrag ebenfalls Eins für alle Frequenzen, aber die
Phase des Signals wird linear abhängig von der Frequenz verändert, wenn
ein <span class="math notranslate nohighlight">\(\delta(k)\)</span> ein System darstellt</p>
</div>
</div>
<div class="section" id="weitere-fensterfunktionen-und-deren-eigenschaften">
<h2><span class="section-number">6.5. </span>Weitere Fensterfunktionen und deren Eigenschaften<a class="headerlink" href="#weitere-fensterfunktionen-und-deren-eigenschaften" title="Permalink to this headline">¶</a></h2>
<p>Wir haben gesehen, dass die DFT für eine zeitlich beschränkte Funktion
auch als Multiplikation mit einer Fensterfunktion interpretiert werden
kann. Dieses Fenster hatte einen deutlichen Einfluss auf das
dargestellte Spektrum. Zur Beschreibung der Eigenschaften des Fensters
im Frequenzbereich wird häufig die spektrale Auflösung des Maximums zu
den 3dB Punkten verwendet. Weiterhin ist eine interessante Größe, welche
Höhe die nächsten Maxima haben (Betrag). Für das Rechteckfenster sind
diese beiden Größen durch <span class="math notranslate nohighlight">\(2pi/N\)</span> und <span class="math notranslate nohighlight">\(\approx 13\)</span>dB gegeben. Etwas
anders sieht dies bei anderen Fensterfunktionen aus (siehe <a class="reference internal" href="#fig-rechteckwindow"><span class="std std-numref">Abbildung 6.11</span></a>
bis <a class="reference internal" href="#fig-kaiserwindow"><span class="std std-numref">Abbildung 6.20</span></a></p>
<div class="cell tag_hide-input tag_remove-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span>
<span class="kn">from</span> <span class="nn">myst_nb</span> <span class="kn">import</span> <span class="n">glue</span>

<span class="n">matplotlib</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;sv.mplstyle&#39;</span><span class="p">)</span>


<span class="n">rect_window</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">30</span><span class="o">+</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span>
<span class="n">rect_window</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">rect_window</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">1000</span><span class="p">])</span>

<span class="n">spectrum</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">rect_window</span><span class="p">)</span>
<span class="n">mid</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">spectrum</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="n">spectrum</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">spectrum</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">mid</span><span class="p">):],</span> <span class="n">spectrum</span><span class="p">[:</span><span class="nb">int</span><span class="p">(</span><span class="n">mid</span><span class="p">)]])</span>
<span class="n">spectrum_abs</span> <span class="o">=</span> <span class="mi">20</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">spectrum</span><span class="p">)</span><span class="o">/</span><span class="n">numpy</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">spectrum</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
<span class="n">freqs_fft</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">spectrum_abs</span><span class="p">))</span>

<span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax_sample</span><span class="p">,</span> <span class="n">ax_spectrum</span><span class="p">)</span> <span class="o">=</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">ax_sample</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rect_window</span><span class="p">)</span>
<span class="n">ax_sample</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Folgenndex k -&gt;&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Amplitude x[k]&#39;</span><span class="p">,</span> <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">31</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Rechteck-Fenster im Frequenzbereich&#39;</span><span class="p">)</span>

<span class="n">ax_spectrum</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">freqs_fft</span><span class="p">,</span> <span class="n">spectrum_abs</span><span class="p">)</span>
<span class="n">ax_spectrum</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Frequenz rad/pi &#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Dämpfung in dB&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Rechteck-Fenster im Frequenzbereich&#39;</span><span class="p">)</span>

<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;RechteckWindow&quot;</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="figure align-default" id="fig-rechteckwindow" style="width: 75%">
<p class="caption"><span class="caption-number">Fig. 6.11 </span><span class="caption-text">Zeitliche und spektrale Eigenschaft des Rechteckfensters</span><a class="headerlink" href="#fig-rechteckwindow" title="Permalink to this image">¶</a></p>
</div>
<p>Als Ursache für das verschmieren im Frequenzbereich wurde die Faltung
mit der Fensterfunktion genannt. Die Ursache im Zeitbereich hierfür war
das abrupte Abschneiden, dass durch die angenommene zirkulare
WIederholung zu einem nicht-repräsentativen Ausschnitt führte. Deshalb
ist eine Design-Idee für andere Fenster eine möglichst weiche
Ausblendung zu den Rändern zu ermöglichen. Fenster die diese Eigenschaft
besitzen können zum Beispiel durch Cosinusfunktionen realisiert werden.</p>
<p>Eine generalisierte Version ergibt sich dabei zu</p>
<div class="math notranslate nohighlight" id="equation-eq-windowfunction-general">
<span class="eqno">(6.20)<a class="headerlink" href="#equation-eq-windowfunction-general" title="Permalink to this equation">¶</a></span>\[
   w(k) = \alpha - \beta \cos(2\pi k /N) + \gamma \cos(4\pi k /N) \quad mit \quad 0\leq k
   &lt; N
\]</div>
<p>Durch Veränderung der drei Parameter <span class="math notranslate nohighlight">\(\alpha, \beta, \gamma\)</span> können die
bekanntesten Fenster-Funktionen angegeben werden<a class="footnote-reference brackets" href="#id14" id="id6">6</a>.</p>
<ul class="simple">
<li><p><strong>von Hann- Fenster (oft fälschlich Hanning):</strong> Für das Hann-Fenster ist
<span class="math notranslate nohighlight">\(\alpha = \beta = 0.5\)</span> und <span class="math notranslate nohighlight">\(\gamma = 0\)</span>. Daraus ergibt sich im
Frequenzbereich ein etwas breiteres Hauptmaxima <span class="math notranslate nohighlight">\(4\pi/N\)</span>. Die
Nebenmaxima sind dafür im Gegensatz zum Rechteck-Fenster sehr viel
stärker bedämpft.</p></li>
</ul>
<div class="cell tag_hide-input tag_remove-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span>
<span class="kn">from</span> <span class="nn">myst_nb</span> <span class="kn">import</span> <span class="n">glue</span>

<span class="n">matplotlib</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;sv.mplstyle&#39;</span><span class="p">)</span>


<span class="n">N</span> <span class="o">=</span> <span class="mi">32</span>
<span class="n">von_hann_window</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">N</span>

<span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
    <span class="n">von_hann_window</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">-</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">idx</span><span class="o">/</span><span class="n">N</span><span class="p">)</span>
<span class="n">von_hann_window</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">von_hann_window</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">1000</span><span class="p">])</span>
<span class="n">spectrum</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">von_hann_window</span><span class="p">)</span>
<span class="n">mid</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">spectrum</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="n">spectrum</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">spectrum</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">mid</span><span class="p">):],</span> <span class="n">spectrum</span><span class="p">[:</span><span class="nb">int</span><span class="p">(</span><span class="n">mid</span><span class="p">)]])</span>
<span class="n">spectrum_abs</span> <span class="o">=</span> <span class="mi">20</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">spectrum</span><span class="p">)</span><span class="o">/</span><span class="n">numpy</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">spectrum</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
<span class="n">freqs_fft</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">spectrum_abs</span><span class="p">))</span>

<span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax_sample</span><span class="p">,</span> <span class="n">ax_spectrum</span><span class="p">)</span> <span class="o">=</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">ax_sample</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">von_hann_window</span><span class="p">)</span>
<span class="n">ax_sample</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Folgenndex k -&gt;&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Amplitude x[k]&#39;</span><span class="p">,</span> <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Von-Hann-Fenster im Zeitbereich&#39;</span><span class="p">)</span>

<span class="n">ax_spectrum</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">freqs_fft</span><span class="p">,</span> <span class="n">spectrum_abs</span><span class="p">)</span>
<span class="n">ax_spectrum</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Frequenz rad/pi &#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Dämpfung in dB&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Von-Hann-Fenster im Frequenzbereich&#39;</span><span class="p">)</span>

<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;HannWindow&quot;</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="figure align-default" id="fig-hannwindow" style="width: 75%">
<p class="caption"><span class="caption-number">Fig. 6.12 </span><span class="caption-text">Zeitliche und spektrale Eigenschaft des von Hann-Fensters</span><a class="headerlink" href="#fig-hannwindow" title="Permalink to this image">¶</a></p>
</div>
<ul class="simple">
<li><p><strong>Hamming- Fenster:</strong> Für das Hamming-Fenster ist <span class="math notranslate nohighlight">\(\alpha = 0.54\)</span>,
<span class="math notranslate nohighlight">\(\beta = 0.46\)</span> und <span class="math notranslate nohighlight">\(\gamma = 0\)</span>. Das Design-Ziel des Hamming-Fenster
ist das erste Nebenmaxima möglichst optimal zu unterdrücken. Dafür
geht aber insgesamt eine schlechtere Dämpfung der anderen
Nebenmaxima einher. Die Verbreiterung entspricht der des
Hann-Fensters <span class="math notranslate nohighlight">\(4\pi/N\)</span></p></li>
</ul>
<div class="cell tag_hide-input tag_remove-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span>
<span class="kn">from</span> <span class="nn">myst_nb</span> <span class="kn">import</span> <span class="n">glue</span>

<span class="n">matplotlib</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;sv.mplstyle&#39;</span><span class="p">)</span>



<span class="n">N</span> <span class="o">=</span> <span class="mi">32</span> <span class="c1"># Fensterlänge</span>
<span class="n">hamming_window</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">N</span> <span class="c1"># Fenstervektor</span>

<span class="c1"># berechnet Fenster</span>
<span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
    <span class="n">hamming_window</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.54</span> <span class="o">-</span> <span class="mf">0.46</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">idx</span><span class="o">/</span><span class="n">N</span><span class="p">)</span>
<span class="n">hamming_window</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">hamming_window</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">100000</span><span class="p">])</span> <span class="c1"># nullen hinzufügen</span>

<span class="n">spectrum</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">hamming_window</span><span class="p">)</span>
<span class="n">mid</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">spectrum</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="n">spectrum</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">spectrum</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">mid</span><span class="p">):],</span> <span class="n">spectrum</span><span class="p">[:</span><span class="nb">int</span><span class="p">(</span><span class="n">mid</span><span class="p">)]])</span> <span class="c1"># spektrum von pi bis 2*pi wird in den negativen Bereich verschoben</span>
<span class="n">spectrum_abs</span> <span class="o">=</span> <span class="mi">20</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">spectrum</span><span class="p">)</span><span class="o">/</span><span class="n">numpy</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">spectrum</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">())</span> <span class="c1"># dB von Spektrum</span>
<span class="n">freqs_fft</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">spectrum_abs</span><span class="p">))</span> <span class="c1"># Frequenz von -1 bis 1 in rad/pi</span>

<span class="c1"># Fensterplot</span>
<span class="n">ax_sample</span> <span class="o">=</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">ax_sample</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">hamming_window</span><span class="p">)</span>
<span class="n">ax_sample</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Folgenndex k -&gt;&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Amplitude x[k]&#39;</span><span class="p">,</span> <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Hamming-Fenster im Zeitbereich&#39;</span><span class="p">)</span>

<span class="c1"># Spektraler Plot</span>
<span class="n">ax_spectrum</span> <span class="o">=</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">ax_spectrum</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">freqs_fft</span><span class="p">,</span> <span class="n">spectrum_abs</span><span class="p">)</span>
<span class="n">ax_spectrum</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Frequenz rad/pi &#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Dämpfung in dB&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Hamming-Fenster im Frequenzbereich&#39;</span><span class="p">)</span>

<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;HammingWindow&quot;</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="figure align-default" id="fig-hammingwindow" style="width: 75%">
<p class="caption"><span class="caption-number">Fig. 6.13 </span><span class="caption-text">Zeitliche und spektrale Eigenschaft des Hamming-Fensters</span><a class="headerlink" href="#fig-hammingwindow" title="Permalink to this image">¶</a></p>
</div>
<ul class="simple">
<li><p><strong>Blackman- Fenster:</strong> Für das Blackman-Fenster ist <span class="math notranslate nohighlight">\(\alpha = 0.42\)</span>,
<span class="math notranslate nohighlight">\(\beta = 0.5\)</span> und <span class="math notranslate nohighlight">\(\gamma = 0.08\)</span>. Dieses Fenster hat eine deutlich
breitere Hauptkeule <span class="math notranslate nohighlight">\(6\pi/N\)</span>, aber die Dämpfung der Nebenmaxima und
der Abfall der weiteren Nebenmaxima ist sehr hoch.</p></li>
</ul>
<div class="cell tag_hide-input tag_remove-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span>
<span class="kn">from</span> <span class="nn">myst_nb</span> <span class="kn">import</span> <span class="n">glue</span>

<span class="n">matplotlib</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;sv.mplstyle&#39;</span><span class="p">)</span>


<span class="n">N</span> <span class="o">=</span> <span class="mi">32</span>
<span class="n">blackman_window</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">N</span>

<span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
    <span class="n">blackman_window</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.42</span> <span class="o">-</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">idx</span><span class="o">/</span><span class="n">N</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.08</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">idx</span><span class="o">/</span><span class="n">N</span><span class="p">)</span>
<span class="n">blackman_window</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">blackman_window</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">1000</span><span class="p">])</span>


<span class="n">spectrum</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">blackman_window</span><span class="p">)</span>
<span class="n">mid</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">spectrum</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="n">spectrum</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">spectrum</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">mid</span><span class="p">):],</span> <span class="n">spectrum</span><span class="p">[:</span><span class="nb">int</span><span class="p">(</span><span class="n">mid</span><span class="p">)]])</span>
<span class="n">spectrum_abs</span> <span class="o">=</span> <span class="mi">20</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">spectrum</span><span class="p">)</span><span class="o">/</span><span class="n">numpy</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">spectrum</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
<span class="n">freqs_fft</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">spectrum_abs</span><span class="p">))</span>

<span class="n">ax_sample</span> <span class="o">=</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">ax_sample</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">blackman_window</span><span class="p">)</span>
<span class="n">ax_sample</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Folgenndex k -&gt;&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Amplitude x[k]&#39;</span><span class="p">,</span> <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Blackman-Fenster im Zeitbereich&#39;</span><span class="p">)</span>

<span class="n">ax_spectrum</span> <span class="o">=</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">ax_spectrum</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">freqs_fft</span><span class="p">,</span> <span class="n">spectrum_abs</span><span class="p">)</span>
<span class="n">ax_spectrum</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Frequenz rad/pi &#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Dämpfung in dB&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Blackman-Fenster im Frequenzbereich&#39;</span><span class="p">)</span>

<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;BlackmanWindow&quot;</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="figure align-default" id="fig-blackmanwindow" style="width: 75%">
<p class="caption"><span class="caption-number">Fig. 6.14 </span><span class="caption-text">Zeitliche und spektrale Eigenschaft des
Blackman-Fensters</span><a class="headerlink" href="#fig-blackmanwindow" title="Permalink to this image">¶</a></p>
</div>
<ul class="simple">
<li><p><strong>Dolph-Chebbyscheff Fenster:</strong> Im Gegensatz zu den anderen Fenstern
in das Dolph-Chebbycheff Fenster parametrisierbar. Bei einer
vorgegebenen Fensterlänge <span class="math notranslate nohighlight">\(N\)</span> kann die Absenkung der Nebenzipfel
angegeben werden. Dieser Wert wird für alle Nebenzipfel gleichmäßig
erreicht. Die Breite der Hauptkeule wird gleichzeitig optimal klein
für eine gegebene Fensterlänge <span class="math notranslate nohighlight">\(N\)</span>. Siehe auch in Matlab <code class="docutils literal notranslate"><span class="pre">chebwin</span></code></p></li>
</ul>
<div class="cell tag_hide-input tag_remove-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">signal</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span>
<span class="kn">from</span> <span class="nn">myst_nb</span> <span class="kn">import</span> <span class="n">glue</span>

<span class="n">matplotlib</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;sv.mplstyle&#39;</span><span class="p">)</span>


<span class="n">N</span> <span class="o">=</span> <span class="mi">32</span>

<span class="n">dolph_cheb_win</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">windows</span><span class="o">.</span><span class="n">chebwin</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">at</span><span class="o">=</span><span class="mi">40</span><span class="p">)</span>
<span class="n">dolph_cheb_win</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">dolph_cheb_win</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">1000</span><span class="p">])</span>


<span class="n">spectrum</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">dolph_cheb_win</span><span class="p">)</span>
<span class="n">mid</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">spectrum</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="n">spectrum</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">spectrum</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">mid</span><span class="p">):],</span> <span class="n">spectrum</span><span class="p">[:</span><span class="nb">int</span><span class="p">(</span><span class="n">mid</span><span class="p">)]])</span>
<span class="n">spectrum_abs</span> <span class="o">=</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">numpy</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">spectrum</span><span class="p">)</span><span class="o">/</span><span class="n">numpy</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">spectrum</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
<span class="n">freqs_fft</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">spectrum_abs</span><span class="p">))</span>

<span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax_sample</span><span class="p">,</span> <span class="n">ax_spectrum</span><span class="p">)</span> <span class="o">=</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

<span class="n">ax_sample</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dolph_cheb_win</span><span class="p">)</span>
<span class="n">ax_sample</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Folgenndex k -&gt;&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Amplitude x[k]&#39;</span><span class="p">,</span> <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Dolph-Chebbychev-Fenster im Zeitbereich&#39;</span><span class="p">)</span>

<span class="n">ax_spectrum</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">freqs_fft</span><span class="p">,</span> <span class="n">spectrum_abs</span><span class="p">)</span>
<span class="n">ax_spectrum</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Frequenz rad/pi &#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Dämpfung in dB&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Dolph-Chebbychev-Fenster im Frequenzbereich&#39;</span><span class="p">)</span>

<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;ChebWindow&quot;</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="figure align-default" id="fig-chebwindow" style="width: 75%">
<p class="caption"><span class="caption-number">Fig. 6.15 </span><span class="caption-text">Zeitliche und spektrale Eigenschaft des
Dolph-Chebbycheff-Fensters</span><a class="headerlink" href="#fig-chebwindow" title="Permalink to this image">¶</a></p>
</div>
<ul class="simple">
<li><p><strong>Kaiser Fenster:</strong> Auch das Kaiser Fenster ist mit Hilfe des
Parameters <span class="math notranslate nohighlight">\(\alpha\)</span> veränderlich. Es basiert auf der Form</p></li>
</ul>
<div class="math notranslate nohighlight" id="equation-eq-kaiser-fenster">
<span class="eqno">(6.22)<a class="headerlink" href="#equation-eq-kaiser-fenster" title="Permalink to this equation">¶</a></span>\[\begin{split}
       w(k,\alpha) = \left\{\begin{array}{c}
         \frac{I_0\left(\alpha \sqrt{1-(k/N)^2}\right)}{I_0 (\alpha)}     \quad mit \quad 0\leq k
       &lt; N\\
         0 \quad \quad \mbox{sonst} \\
       \end{array}
       \right.
\end{split}\]</div>
<p>wobei <span class="math notranslate nohighlight">\(I_0\)</span> die modifizierte Bessel-Funktion nullter
Ordnung darstellt.</p>
<p><a class="reference internal" href="#fig-kaiserwindow"><span class="std std-numref">Abbildung 6.20</span></a>  und
<a class="reference internal" href="#fig-kaiserwindow2"><span class="std std-numref">Abbildung 6.21</span></a>  zeigen für unterschiedliche <span class="math notranslate nohighlight">\(\alpha\)</span>
den zeitlichen Verlauf und die dazugehörigen spektralen
Eigenschaften.</p>
<div class="cell tag_hide-input tag_remove-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span>
<span class="kn">from</span> <span class="nn">myst_nb</span> <span class="kn">import</span> <span class="n">glue</span>

<span class="n">matplotlib</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;sv.mplstyle&#39;</span><span class="p">)</span>


<span class="n">N</span> <span class="o">=</span> <span class="mi">32</span>

<span class="n">k4_window</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">kaiser</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">k2_window</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">kaiser</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">k4_window</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">k4_window</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">1000</span><span class="p">])</span>
<span class="n">k2_window</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">k2_window</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">1000</span><span class="p">])</span>


<span class="n">spectrum_k4</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">k4_window</span><span class="p">)</span>
<span class="n">spectrum_k2</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">k2_window</span><span class="p">)</span>

<span class="n">mid</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">spectrum_k4</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>

<span class="n">spectrum_k4</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">spectrum_k4</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">mid</span><span class="p">):],</span> <span class="n">spectrum_k4</span><span class="p">[:</span><span class="nb">int</span><span class="p">(</span><span class="n">mid</span><span class="p">)]])</span>
<span class="n">spectrum_k2</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">spectrum_k2</span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">mid</span><span class="p">):],</span> <span class="n">spectrum_k2</span><span class="p">[:</span><span class="nb">int</span><span class="p">(</span><span class="n">mid</span><span class="p">)]])</span>
<span class="n">spectrum_k4_abs</span> <span class="o">=</span> <span class="mi">20</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">spectrum_k4</span><span class="p">)</span><span class="o">/</span><span class="n">numpy</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">spectrum_k4</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
<span class="n">spectrum_k2_abs</span> <span class="o">=</span> <span class="mi">20</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">spectrum_k2</span><span class="p">)</span><span class="o">/</span><span class="n">numpy</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">spectrum_k2</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
<span class="n">freqs_fft_k4</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">spectrum_k4_abs</span><span class="p">))</span>
<span class="n">freqs_fft_k2</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">spectrum_k2_abs</span><span class="p">))</span>

<span class="n">fig1</span><span class="p">,</span> <span class="p">(</span><span class="n">ax_sample_k4</span><span class="p">,</span> <span class="n">ax_spectrum_k4</span><span class="p">)</span> <span class="o">=</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">ax_sample_k4</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">k4_window</span><span class="p">)</span>
<span class="n">ax_spectrum_k4</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">freqs_fft_k4</span><span class="p">,</span> <span class="n">spectrum_k4_abs</span><span class="p">)</span>
<span class="n">ax_sample_k4</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Folgenndex k -&gt;&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Amplitude x[k]&#39;</span><span class="p">,</span> <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Kaiser-Fenster (beta = 4) im Zeitbereich&#39;</span><span class="p">)</span>
<span class="n">ax_spectrum_k4</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Frequenz rad/pi &#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Dämpfung in dB&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Kaiser-Fenster (beta = 4) im Frequenzbereich&#39;</span><span class="p">)</span>


<span class="n">fig2</span><span class="p">,</span> <span class="p">(</span><span class="n">ax_sample_k2</span><span class="p">,</span> <span class="n">ax_spectrum_k2</span><span class="p">)</span> <span class="o">=</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">ax_sample_k2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">k2_window</span><span class="p">)</span>
<span class="n">ax_spectrum_k2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">freqs_fft_k2</span><span class="p">,</span> <span class="n">spectrum_k2_abs</span><span class="p">)</span>
<span class="n">ax_sample_k2</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Folgenndex k -&gt;&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Amplitude x[k]&#39;</span><span class="p">,</span> <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Kaiser-Fenster (beta = 2) im Zeitbereich&#39;</span><span class="p">)</span>
<span class="n">ax_spectrum_k2</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Frequenz rad/pi &#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Dämpfung in dB&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Kaiser-Fenster (beta = 2) im Frequenzbereich&#39;</span><span class="p">)</span>

<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;KaiserWindow&quot;</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="tabbed-set docutils">
<input checked="checked" id="f667190d-cba9-40fc-84f2-6365d42acd3c" name="6bd6eb77-80cd-4044-b37a-fc3c8e18fbb3" type="radio">
</input><label class="tabbed-label" for="f667190d-cba9-40fc-84f2-6365d42acd3c">
von Hann</label><div class="tabbed-content docutils">
<ul class="simple">
<li><p><strong>von Hann- Fenster (oft fälschlich Hanning):</strong> Für das Hann-Fenster ist
<span class="math notranslate nohighlight">\(\alpha = \beta = 0.5\)</span> und <span class="math notranslate nohighlight">\(\gamma = 0\)</span>. Daraus ergibt sich im
Frequenzbereich ein etwas breiteres Hauptmaxima <span class="math notranslate nohighlight">\(4\pi/N\)</span>. Die
Nebenmaxima sind dafür im Gegensatz zum Rechteck-Fenster sehr viel
stärker bedämpft.</p></li>
</ul>
<div class="figure align-default" id="id7" style="width: 75%">
<p class="caption"><span class="caption-number">Fig. 6.16 </span><span class="caption-text">Zeitliche und spektrale Eigenschaft des von Hann-Fensters</span><a class="headerlink" href="#id7" title="Permalink to this image">¶</a></p>
</div>
</div>
<input id="2ffe2474-4ca1-4110-b66b-6c6c9f7cbabd" name="6bd6eb77-80cd-4044-b37a-fc3c8e18fbb3" type="radio">
</input><label class="tabbed-label" for="2ffe2474-4ca1-4110-b66b-6c6c9f7cbabd">
Hamming</label><div class="tabbed-content docutils">
<ul class="simple">
<li><p><strong>Hamming- Fenster:</strong> Für das Hamming-Fenster ist <span class="math notranslate nohighlight">\(\alpha = 0.54\)</span>,
<span class="math notranslate nohighlight">\(\beta = 0.46\)</span> und <span class="math notranslate nohighlight">\(\gamma = 0\)</span>. Das Design-Ziel des Hamming-Fenster
ist das erste Nebenmaxima möglichst optimal zu unterdrücken. Dafür
geht aber insgesamt eine schlechtere Dämpfung der anderen
Nebenmaxima einher. Die Verbreiterung entspricht der des
Hann-Fensters <span class="math notranslate nohighlight">\(4\pi/N\)</span></p></li>
</ul>
<div class="figure align-default" id="id8" style="width: 75%">
<p class="caption"><span class="caption-number">Fig. 6.17 </span><span class="caption-text">Zeitliche und spektrale Eigenschaft des Hamming-Fensters</span><a class="headerlink" href="#id8" title="Permalink to this image">¶</a></p>
</div>
</div>
<input id="5735ef82-3c0e-41fc-8127-09648a02405b" name="6bd6eb77-80cd-4044-b37a-fc3c8e18fbb3" type="radio">
</input><label class="tabbed-label" for="5735ef82-3c0e-41fc-8127-09648a02405b">
Blackman</label><div class="tabbed-content docutils">
<ul class="simple">
<li><p><strong>Blackman- Fenster:</strong> Für das Blackman-Fenster ist <span class="math notranslate nohighlight">\(\alpha = 0.42\)</span>,
<span class="math notranslate nohighlight">\(\beta = 0.5\)</span> und <span class="math notranslate nohighlight">\(\gamma = 0.08\)</span>. Dieses Fenster hat eine deutlich
breitere Hauptkeule <span class="math notranslate nohighlight">\(6\pi/N\)</span>, aber die Dämpfung der Nebenmaxima und
der Abfall der weiteren Nebenmaxima ist sehr hoch.</p></li>
</ul>
<div class="figure align-default" id="id9" style="width: 75%">
<p class="caption"><span class="caption-number">Fig. 6.18 </span><span class="caption-text">Zeitliche und spektrale Eigenschaft des
Blackman-Fensters</span><a class="headerlink" href="#id9" title="Permalink to this image">¶</a></p>
</div>
</div>
<input id="4c00292d-9e5a-4f0d-bd0e-335a24459af1" name="6bd6eb77-80cd-4044-b37a-fc3c8e18fbb3" type="radio">
</input><label class="tabbed-label" for="4c00292d-9e5a-4f0d-bd0e-335a24459af1">
Dolph-Chebbyscheff</label><div class="tabbed-content docutils">
<ul class="simple">
<li><p><strong>Dolph-Chebbyscheff Fenster:</strong> Im Gegensatz zu den anderen Fenstern
in das Dolph-Chebbycheff Fenster parametrisierbar. Bei einer
vorgegebenen Fensterlänge <span class="math notranslate nohighlight">\(N\)</span> kann die Absenkung der Nebenzipfel
angegeben werden. Dieser Wert wird für alle Nebenzipfel gleichmäßig
erreicht. Die Breite der Hauptkeule wird gleichzeitig optimal klein
für eine gegebene Fensterlänge <span class="math notranslate nohighlight">\(N\)</span>. Siehe auch in Matlab <code class="docutils literal notranslate"><span class="pre">chebwin</span></code></p></li>
</ul>
<div class="figure align-default" id="id10" style="width: 75%">
<p class="caption"><span class="caption-number">Fig. 6.19 </span><span class="caption-text">Zeitliche und spektrale Eigenschaft des
Dolph-Chebbycheff-Fensters</span><a class="headerlink" href="#id10" title="Permalink to this image">¶</a></p>
</div>
</div>
<input id="d78baec6-a59d-4f2c-91be-5c4e6aeace10" name="6bd6eb77-80cd-4044-b37a-fc3c8e18fbb3" type="radio">
</input><label class="tabbed-label" for="d78baec6-a59d-4f2c-91be-5c4e6aeace10">
Kaiser-Fester</label><div class="tabbed-content docutils">
<ul class="simple">
<li><p><strong>Kaiser Fenster:</strong> Auch das Kaiser Fenster ist mit Hilfe des
Parameters <span class="math notranslate nohighlight">\(\alpha\)</span> veränderlich. Es basiert auf der Form</p></li>
</ul>
<div class="math notranslate nohighlight" id="equation-eq-kaiser-fenster">
<span class="eqno">(6.22)<a class="headerlink" href="#equation-eq-kaiser-fenster" title="Permalink to this equation">¶</a></span>\[\begin{split}
       w(k,\alpha) = \left\{\begin{array}{c}
         \frac{I_0\left(\alpha \sqrt{1-(k/N)^2}\right)}{I_0 (\alpha)}     \quad mit \quad 0\leq k
       &lt; N\\
         0 \quad \quad \mbox{sonst} \\
       \end{array}
       \right.
\end{split}\]</div>
<p>wobei <span class="math notranslate nohighlight">\(I_0\)</span> die modifizierte Bessel-Funktion nullter
Ordnung darstellt.</p>
<p><a class="reference internal" href="#fig-kaiserwindow"><span class="std std-numref">Abbildung 6.20</span></a>  und
<a class="reference internal" href="#fig-kaiserwindow2"><span class="std std-numref">Abbildung 6.21</span></a>  zeigen für unterschiedliche <span class="math notranslate nohighlight">\(\alpha\)</span>
den zeitlichen Verlauf und die dazugehörigen spektralen
Eigenschaften.</p>
<div class="figure align-default" id="fig-kaiserwindow" style="width: 75%">
<p class="caption"><span class="caption-number">Fig. 6.20 </span><span class="caption-text">Zeitliche und spektrale Eigenschaft des
Kaiser-Fensters mit
<span class="math notranslate nohighlight">\(\alpha =\)</span> 2 und 4.</span><a class="headerlink" href="#fig-kaiserwindow" title="Permalink to this image">¶</a></p>
</div>
</div>
</div>
<div class="figure align-default" id="fig-kaiserwindow2">
<a class="reference internal image-reference" href="_images/KaiserWindow2.png"><img alt="_images/KaiserWindow2.png" src="_images/KaiserWindow2.png" style="height: 150px;" /></a>
<p class="caption"><span class="caption-number">Fig. 6.21 </span><span class="caption-text">Zeitliche und spektrale Eigenschaft des
Kaiser-Fensters mit
<span class="math notranslate nohighlight">\(\alpha = 2\)</span>.</span><a class="headerlink" href="#fig-kaiserwindow2" title="Permalink to this image">¶</a></p>
</div>
<div class="error admonition">
<p class="admonition-title">To Do</p>
<p>Vergleichstabelle der Fensterfunktionen, Hinweise für Applikationen</p>
</div>
</div>
<div class="section" id="matlab-und-spektren">
<h2><span class="section-number">6.6. </span>Matlab und Spektren<a class="headerlink" href="#matlab-und-spektren" title="Permalink to this headline">¶</a></h2>
<p>siehe Matlab Versuch drei.</p>
<div class="section" id="fenster-funktionen">
<h3><span class="section-number">6.6.1. </span>Fenster-Funktionen<a class="headerlink" href="#fenster-funktionen" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="fft">
<h3><span class="section-number">6.6.2. </span>FFT<a class="headerlink" href="#fft" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="signalanalyse">
<h3><span class="section-number">6.6.3. </span>Signalanalyse<a class="headerlink" href="#signalanalyse" title="Permalink to this headline">¶</a></h3>
</div>
</div>
<div class="section" id="ubungen">
<h2><span class="section-number">6.7. </span>Übungen<a class="headerlink" href="#ubungen" title="Permalink to this headline">¶</a></h2>
<div class="section" id="wiederholung-des-stoffes-und-einfache-rechenaufgaben">
<h3><span class="section-number">6.7.1. </span>Wiederholung des Stoffes und einfache Rechenaufgaben<a class="headerlink" href="#wiederholung-des-stoffes-und-einfache-rechenaufgaben" title="Permalink to this headline">¶</a></h3>
<ol class="simple">
<li><p>Bei einer Abtastrate von 44100 Hz und einer DFT Auflösung von <span class="math notranslate nohighlight">\(1024\)</span>
soll ein Sinus erzeugt werden, der keinerlei Leck-Effekt zur Folge
hat. Welche Frequenzen sind mögliche Kandidaten.</p></li>
<li><p>Wozu werden Fensterfunktionen benötigt?</p></li>
<li><p>Nach welchem Prinzip kann die Rechenleistung der DFT reduziert
werden?</p></li>
<li><p>Welchen Einfluss haben Pole auf das Übertragungsverhalten und
welchen Einfluss Nullstellen?</p></li>
<li><p>Wodurch entsteht ein Allpass-System?</p></li>
<li><p>Erklären Sie, die Folgen des Übergangs von der DTFT zur DFT!</p></li>
<li><p>Um zu zeigen, dass nicht-lineare Systeme neue Frequenzen erzeugen,
sollten Sie das System <span class="math notranslate nohighlight">\(y(k) = x^2(k)\)</span> mit der Exponentialschwingung
anregen und sich das Ergebnis anschauen</p></li>
<li><p>Ein mit 200Hz abgetastetes reelles Signal wird mit einer 8 Punkte
DFT spektral analysiert. Welche Frequenzbereiche sind in den 8
Spektralwerten enthalten? Welche dieser Werte (Indize) haben den
gleichen Betrag?</p></li>
<li><p>Zeichnen Sie qualitativ die Betragsübertragungsfunktion für die
folgenden durch einen Pol-Nullstellenplan gegebenen Systeme:</p></li>
<li><p>Berechnen Sie das Spektrum einer Cosinus-Schwingung der Frequenz
2000 Hz bei einer Abtastrate von 6000 Hz, wenn Sie eine 6 Punkte DFT
verwenden.</p></li>
</ol>
</div>
<div class="section" id="aufgaben-auf-klausurniveau">
<h3><span class="section-number">6.7.2. </span>Aufgaben (Auf Klausurniveau)<a class="headerlink" href="#aufgaben-auf-klausurniveau" title="Permalink to this headline">¶</a></h3>
<ol class="simple">
<li><p>Welche Pol-Nullstellenlage würde die folgende
Betragsübertragungsfunktion mit dazugehöriger Phase bei einem
reellwertigen, stabilen System zur Folge haben (fs = 8000 Hz)?
(Genauere qualitative Skizze (Grosser Kreis bitte!) und kurze
stichpunktartige Begründung für die relevanten Punkte)(8)</p></li>
<li><p>Berechnen Sie die Übertragungsfunktion zur Impulsantwort
<span class="math notranslate nohighlight">\(h(k) = [1\;\; 0\;\; 1]\)</span></p></li>
<li><p>Berechnen Sie die Übertragungsfunktion zu den folgenden Filtern.
Skizzieren Sie die Funktion für <span class="math notranslate nohighlight">\(\alpha = 0.9\)</span> und <span class="math notranslate nohighlight">\(\alpha = -0.9\)</span></p>
<ol class="simple">
<li><p><span class="math notranslate nohighlight">\(y(k) = x(k) - \alpha y(k-1)\)</span></p></li>
</ol>
</li>
<li><p>Ordnen Sie die folgenden Pol-Nullstellenpläne (a-d) den
verschiedenen Übertragungsfunktionen (1-8) zu (2 Punkte für jede
richtige Zuordnung, -1 Punkt für jede falsche).</p></li>
<li></li>
</ol>
</div>
<div class="section" id="matlab-aufgaben">
<h3><span class="section-number">6.7.3. </span>Matlab-Aufgaben<a class="headerlink" href="#matlab-aufgaben" title="Permalink to this headline">¶</a></h3>
<ol class="simple">
<li><p>Bestimmen Sie die Übertragungsfunktion der folgenden Systeme.</p>
<ol class="simple">
<li><p><span class="math notranslate nohighlight">\(y(k) = x(k) - \alpha y(k-1)\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(y(k) =  0.3 x(k) + 07 x(k-1) + 1.9812 y(k-1)   - 1.0201 y(k-2)\)</span></p></li>
</ol>
</li>
<li></li>
<li></li>
</ol>
</div>
<div class="section" id="transfer-leistung">
<h3><span class="section-number">6.7.4. </span>Transfer-Leistung<a class="headerlink" href="#transfer-leistung" title="Permalink to this headline">¶</a></h3>
<ol class="simple">
<li><p>Bei der Berechnung des Faltungsprodukts muss bei der DFT/FFT auf die
Zirkularität geachtet werden. Welche Probleme können auftreten, wenn
das Ausgansspektrum nicht durch Multiplikation <span class="math notranslate nohighlight">\(Y(n) = X(n)H(n)\)</span>,
sondern durch eine Division <span class="math notranslate nohighlight">\(Y(n) = X(n)/H(n)\)</span> entsteht (sog.
Deconvolutionproblem)</p></li>
<li><p>Welche Folge hat das Decimation in Time Prinzip der FFT für den
Zusammenhang der Eingangsfolge zum berechneten Spektrum. Anders
ausgedrückt, was ist notwendig, damit das Prinzip funktioniert.</p></li>
<li></li>
</ol>
</div>
</div>
<div class="section" id="zusammenfassung">
<h2><span class="section-number">6.8. </span>Zusammenfassung<a class="headerlink" href="#zusammenfassung" title="Permalink to this headline">¶</a></h2>
<p>Die wichtigen Erkenntnisse aus diesem Kapitel sind:</p>
<ul class="simple">
<li><p>LTI-Systeme erzeugen keine neuen Frequenzen.</p></li>
<li><p>LTI-Systeme verändern nur den Betrag und Phase eines Signals. Die
Betragsänderung über der Frequenz aufgetragen bezeichnet den
Betragsfrequenzgang. Die Darstellung der Phase den Phasengang.</p></li>
<li><p>Der Einfluss der Pole und Nullstellen lässt sich direkt am
Einheitskreis ablesen.</p></li>
<li><p>Stabile, kausale Systeme haben alle Pole innerhalb des
Einheitskreises.</p></li>
<li><p>Minimalphasige Systeme haben alle Nullstellen innerhalb des
Einheitskreises.</p></li>
<li><p>Die DTFT ist die z-Transformation für <span class="math notranslate nohighlight">\(z= e^{j\Omega}\)</span>.</p></li>
<li><p>Die DFT ist eine zeitlich begrenzte DTFT, bei der das
kontinuierliche Spektrum abgetastet wird. Sie ist deshalb maschinell
berechenbar.</p></li>
<li><p>Durch die Nutzung der DFT wird das Spektrum verändert.</p>
<ul>
<li><p>Das Zeitsignal wird als periodisch wiederholt angenommen</p></li>
<li><p>Das Spektrum wird mit der Übertragungsfunktion des Fensters
gefaltet. Es kommt zum sogenannten Leakage-Effekt.</p></li>
</ul>
</li>
<li><p>Die Faltung lässt sich mit der DFT nur durch Zero-Padding
realisieren.</p></li>
<li><p>Reelle Signale haben ein konjugiert gerades Spektrum. Die Symmetrie
ermöglicht eine Reduktion der Rechenleistung.</p></li>
<li><p>Die Nutzung und Wahl der Fensterfunktionen zur Signalanalyse hängt
im hohen Maße vom betrachteten Problem ab.</p></li>
</ul>
<hr class="footnotes docutils" />
<dl class="footnote brackets">
<dt class="label" id="id11"><span class="brackets"><a class="fn-backref" href="#id2">2</a></span></dt>
<dd><div class="math notranslate nohighlight">
\[1+x + x^2 + \cdots + x^{N-1} = \frac{1-x^N}{1-x}\]</div>
</dd>
<dt class="label" id="id12"><span class="brackets"><a class="fn-backref" href="#id3">3</a></span></dt>
<dd><p>Es enstehen keine genaueren Spektralwerte gegenüber der kurzen
Folge. Die Werte bei der höheren Frequenzauflösung könnten auch aus
einer Interpolation des Spektrums mit geringrer Auflösung gewonnen
werden.</p>
</dd>
<dt class="label" id="id13"><span class="brackets"><a class="fn-backref" href="#id5">5</a></span></dt>
<dd><p>In Matlab wird die DFT durch den Befehl FFT aufgerufen.</p>
</dd>
<dt class="label" id="id14"><span class="brackets"><a class="fn-backref" href="#id6">6</a></span></dt>
<dd><p>Bei der Darstellung wurden die jeweiligen Übertragungsfunktionen
auf ihr Maximum normiert, so dass sich immer ein Hauptmaxima mit 0dB
ergibt.</p>
</dd>
</dl>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
        <div class='prev-next-bottom'>
            
    <a class='left-prev' id="prev-link" href="ztrafo.html" title="previous page"><span class="section-number">5. </span>z-Transformation</a>
    <a class='right-next' id="next-link" href="filter.html" title="next page"><span class="section-number">7. </span>Filter</a>

        </div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Joerg Bitzer<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="_static/js/index.d3f166471bb80abb5163.js"></script>


    
  </body>
</html>